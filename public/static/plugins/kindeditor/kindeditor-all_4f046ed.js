!function(window,undefined){function _isArray(a){return a?"[object Array]"===Object.prototype.toString.call(a):!1}function _isFunction(a){return a?"[object Function]"===Object.prototype.toString.call(a):!1}function _inArray(a,c){for(var i=0,h=c.length;h>i;i++)if(a===c[i])return i;return-1}function _each(a,c){if(_isArray(a))for(var i=0,h=a.length;h>i&&c.call(a[i],i,a[i])!==!1;i++);else for(var g in a)if(a.hasOwnProperty(g)&&c.call(a[g],g,a[g])===!1)break}function _trim(a){return a.replace(/(?:^[ \t\n\r]+)|(?:[ \t\n\r]+$)/g,"")}function _inString(a,c,h){return h=h===undefined?",":h,(h+c+h).indexOf(h+a+h)>=0}function _addUnit(a,c){return c=c||"px",a&&/^\d+$/.test(a)?a+c:a}function _removeUnit(a){var c;return a&&(c=/(\d+)/.exec(a))?parseInt(c[1],10):0}function _escape(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function _unescape(a){return a.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&amp;/g,"&")}function _toCamel(a){var c=a.split("-");return a="",_each(c,function(c,h){a+=c>0?h.charAt(0).toUpperCase()+h.substr(1):h}),a}function _toHex(a){function c(d){var s=parseInt(d,10).toString(16).toUpperCase();return s.length>1?s:"0"+s}return a.replace(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/gi,function(a,h,g,v){return"#"+c(h)+c(g)+c(v)})}function _toMap(a,c){c=c===undefined?",":c;var h,g={},v=_isArray(a)?a:a.split(c);return _each(v,function(a,c){if(h=/^(\d+)\.\.(\d+)$/.exec(c))for(var i=parseInt(h[1],10);i<=parseInt(h[2],10);i++)g[i.toString()]=!0;else g[c]=!0}),g}function _toArray(a,c){return Array.prototype.slice.call(a,c||0)}function _undef(a,c){return a===undefined?c:a}function _invalidUrl(a){return!a||/[<>"]/.test(a)}function _addParam(a,c){return a.indexOf("?")>=0?a+"&"+c:a+"?"+c}function _extend(a,c,h){h||(h=c,c=null);var g;if(c){var v=function(){};v.prototype=c.prototype,g=new v,_each(h,function(a,c){g[a]=c})}else g=h;g.constructor=a,a.prototype=g,a.parent=c?c.prototype:null}function _json(text){var match;(match=/\{[\s\S]*\}|\[[\s\S]*\]/.exec(text))&&(text=match[0]);var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;if(cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return eval("("+text+")");throw"JSON parse error"}function _getBasePath(){for(var a,c=document.getElementsByTagName("script"),i=0,h=c.length;h>i;i++)if(a=c[i].src||"",/kindeditor[\w\-\.]*\.js/.test(a))return a.substring(0,a.lastIndexOf("/")+1);return""}function _bindEvent(a,c,h){a.addEventListener?a.addEventListener(c,h,_useCapture):a.attachEvent&&a.attachEvent("on"+c,h)}function _unbindEvent(a,c,h){a.removeEventListener?a.removeEventListener(c,h,_useCapture):a.detachEvent&&a.detachEvent("on"+c,h)}function KEvent(a,c){this.init(a,c)}function _getId(a){return a[_eventExpendo]||null}function _setId(a){return a[_eventExpendo]=++_eventId,_eventId}function _removeId(a){try{delete a[_eventExpendo]}catch(e){a.removeAttribute&&a.removeAttribute(_eventExpendo)}}function _bind(a,c,h){if(c.indexOf(",")>=0)return void _each(c.split(","),function(){_bind(a,this,h)});var g=_getId(a);g||(g=_setId(a)),_eventData[g]===undefined&&(_eventData[g]={});var v=_eventData[g][c];v&&v.length>0?_unbindEvent(a,c,v[0]):(_eventData[g][c]=[],_eventData[g].el=a),v=_eventData[g][c],0===v.length&&(v[0]=function(e){var c=e?new KEvent(a,e):undefined;_each(v,function(i,h){i>0&&h&&h.call(a,c)})}),_inArray(h,v)<0&&v.push(h),_bindEvent(a,c,v[0])}function _unbind(a,c,h){if(c&&c.indexOf(",")>=0)return void _each(c.split(","),function(){_unbind(a,this,h)});var g=_getId(a);if(g){if(c===undefined)return void(g in _eventData&&(_each(_eventData[g],function(c,h){"el"!=c&&h.length>0&&_unbindEvent(a,c,h[0])}),delete _eventData[g],_removeId(a)));if(_eventData[g]){var v=_eventData[g][c];if(v&&v.length>0){h===undefined?(_unbindEvent(a,c,v[0]),delete _eventData[g][c]):(_each(v,function(i,a){i>0&&a===h&&v.splice(i,1)}),1==v.length&&(_unbindEvent(a,c,v[0]),delete _eventData[g][c]));var _=0;_each(_eventData[g],function(){_++}),2>_&&(delete _eventData[g],_removeId(a))}}}}function _fire(a,c){if(c.indexOf(",")>=0)return void _each(c.split(","),function(){_fire(a,this)});var h=_getId(a);if(h){var g=_eventData[h][c];_eventData[h]&&g&&g.length>0&&g[0]()}}function _ctrl(a,c,h){c=/^\d{2,}$/.test(c)?c:c.toUpperCase().charCodeAt(0),_bind(a,"keydown",function(e){!e.ctrlKey||e.which!=c||e.shiftKey||e.altKey||(h.call(a),e.stop())})}function _ready(a){function c(){v||(v=!0,a(KindEditor),_readyFinished=!0)}function h(){if(!v){try{document.documentElement.doScroll("left")}catch(e){return void setTimeout(h,100)}c()}}function g(){"complete"===document.readyState&&c()}if(_readyFinished)return void a(KindEditor);var v=!1;if(document.addEventListener)_bind(document,"DOMContentLoaded",c);else if(document.attachEvent){_bind(document,"readystatechange",g);var _=!1;try{_=null==window.frameElement}catch(e){}document.documentElement.doScroll&&_&&h()}_bind(window,"load",c)}function _getCssList(a){for(var c,h={},g=/\s*([\w\-]+)\s*:([^;]*)(;|$)/g;c=g.exec(a);){var v=_trim(c[1].toLowerCase()),_=_trim(_toHex(c[2]));h[v]=_}return h}function _getAttrList(a){for(var c,h={},g=/\s+(?:([\w\-:]+)|(?:([\w\-:]+)=([^\s"'<>]+))|(?:([\w\-:"]+)="([^"]*)")|(?:([\w\-:"]+)='([^']*)'))(?=(?:\s|\/|>)+)/g;c=g.exec(a);){var v=(c[1]||c[2]||c[4]||c[6]).toLowerCase(),_=(c[2]?c[3]:c[4]?c[5]:c[7])||"";h[v]=_}return h}function _addClassToTag(a,c){return a=/\s+class\s*=/.test(a)?a.replace(/(\s+class=["']?)([^"']*)(["']?[\s>])/,function(a,h,g,v){return(" "+g+" ").indexOf(" "+c+" ")<0?""===g?h+c+v:h+g+" "+c+v:a}):a.substr(0,a.length-1)+' class="'+c+'">'}function _formatCss(a){var c="";return _each(_getCssList(a),function(a,h){c+=a+":"+h+";"}),c}function _formatUrl(a,c,h,g){function v(a){for(var c=a.split("/"),h=[],i=0,g=c.length;g>i;i++){var v=c[i];".."==v?h.length>0&&h.pop():""!==v&&"."!=v&&h.push(v)}return"/"+h.join("/")}function _(c,h){if(a.substr(0,c.length)===c){for(var v=[],i=0;h>i;i++)v.push("..");var y=".";return v.length>0&&(y+="/"+v.join("/")),"/"==g&&(y+="/"),y+a.substr(c.length)}return(b=/^(.*)\//.exec(c))?_(b[1],++h):void 0}if(c=_undef(c,"").toLowerCase(),"data:"!=a.substr(0,5)&&(a=a.replace(/([^:])\/\//g,"$1/")),_inArray(c,["absolute","relative","domain"])<0)return a;if(h=h||location.protocol+"//"+location.host,g===undefined){var m=location.pathname.match(/^(\/.*)\//);g=m?m[1]:""}var b;if(b=/^(\w+:\/\/[^\/]*)/.exec(a)){if(b[1]!==h)return a}else if(/^\w+:/.test(a))return a;return/^\//.test(a)?a=h+v(a.substr(1)):/^\w+:\/\//.test(a)||(a=h+v(g+"/"+a)),"relative"===c?a=_(h+g,0).substr(2):"absolute"===c&&a.substr(0,h.length)===h&&(a=a.substr(h.length)),a}function _formatHtml(a,c,h,g,v){null==a&&(a=""),h=h||"",g=_undef(g,!1),v=_undef(v,"	");var _="xx-small,x-small,small,medium,large,x-large,xx-large".split(",");a=a.replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/gi,function(a,c,h,g){return c+h.replace(/<(?:br|br\s[^>]*)>/gi,"\n")+g}),a=a.replace(/<(?:br|br\s[^>]*)\s*\/?>\s*<\/p>/gi,"</p>"),a=a.replace(/(<(?:p|p\s[^>]*)>)\s*(<\/p>)/gi,"$1<br />$2"),a=a.replace(/\u200B/g,""),a=a.replace(/\u00A9/g,"&copy;"),a=a.replace(/\u00AE/g,"&reg;"),a=a.replace(/<[^>]+/g,function(a){return a.replace(/\s+/g," ")});var b={};c&&(_each(c,function(a,c){for(var h=a.split(","),i=0,g=h.length;g>i;i++)b[h[i]]=_toMap(c)}),b.script||(a=a.replace(/(<(?:script|script\s[^>]*)>)([\s\S]*?)(<\/script>)/gi,"")),b.style||(a=a.replace(/(<(?:style|style\s[^>]*)>)([\s\S]*?)(<\/style>)/gi,"")));var re=/(\s*)<(\/)?([\w\-:]+)((?:\s+|(?:\s+[\w\-:]+)|(?:\s+[\w\-:]+=[^\s"'<>]+)|(?:\s+[\w\-:"]+="[^"]*")|(?:\s+[\w\-:"]+='[^']*'))*)(\/)?>(\s*)/g,y=[];return a=a.replace(re,function(a,k,w,S,E,C,T){var K=a,U=k||"",A=w||"",N=S.toLowerCase(),I=E||"",F=C?" "+C:"",D=T||"";if(c&&!b[N])return"";if(""===F&&_SINGLE_TAG_MAP[N]&&(F=" /"),_INLINE_TAG_MAP[N]&&(U&&(U=" "),D&&(D=" ")),_PRE_TAG_MAP[N]&&(A?D="\n":U="\n"),g&&"br"==N&&(D="\n"),_BLOCK_TAG_MAP[N]&&!_PRE_TAG_MAP[N])if(g){A&&y.length>0&&y[y.length-1]===N?y.pop():y.push(N),U="\n",D="\n";for(var i=0,R=A?y.length:y.length-1;R>i;i++)U+=v,A||(D+=v);F?y.pop():A||(D+=v)}else U=D="";if(""!==I){var M=_getAttrList(K);if("font"===N){var P={},B="";_each(M,function(a,c){"color"===a&&(P.color=c,delete M[a]),"size"===a&&(P["font-size"]=_[parseInt(c,10)-1]||"",delete M[a]),"face"===a&&(P["font-family"]=c,delete M[a]),"style"===a&&(B=c)}),B&&!/;$/.test(B)&&(B+=";"),_each(P,function(a,c){""!==c&&(/\s/.test(c)&&(c="'"+c+"'"),B+=a+":"+c+";")}),M.style=B}_each(M,function(a,g){if(_FILL_ATTR_MAP[a]&&(M[a]=a),_inArray(a,["src","href"])>=0&&(M[a]=_formatUrl(g,h)),(c&&"style"!==a&&!b[N]["*"]&&!b[N][a]||"body"===N&&"contenteditable"===a||/^kindeditor_\d+$/.test(a))&&delete M[a],"style"===a&&""!==g){var v=_getCssList(g);_each(v,function(a){!c||b[N].style||b[N]["."+a]||delete v[a]});var _="";_each(v,function(a,c){_+=a+":"+c+";"}),M.style=_}}),I="",_each(M,function(a,c){("style"!==a||""!==c)&&(c=c.replace(/"/g,"&quot;"),I+=" "+a+'="'+c+'"')})}return"font"===N&&(N="span"),U+"<"+A+N+I+F+">"+D}),a=a.replace(/(<(?:pre|pre\s[^>]*)>)([\s\S]*?)(<\/pre>)/gi,function(a,c,h,g){return c+h.replace(/\n/g,'<span id="__kindeditor_pre_newline__">\n')+g}),a=a.replace(/\n\s*\n/g,"\n"),a=a.replace(/<span id="__kindeditor_pre_newline__">\n/g,"\n"),_trim(a)}function _clearMsWord(a,c){return a=a.replace(/<meta[\s\S]*?>/gi,"").replace(/<![\s\S]*?>/gi,"").replace(/<style[^>]*>[\s\S]*?<\/style>/gi,"").replace(/<script[^>]*>[\s\S]*?<\/script>/gi,"").replace(/<w:[^>]+>[\s\S]*?<\/w:[^>]+>/gi,"").replace(/<o:[^>]+>[\s\S]*?<\/o:[^>]+>/gi,"").replace(/<xml>[\s\S]*?<\/xml>/gi,"").replace(/<(?:table|td)[^>]*>/gi,function(a){return a.replace(/border-bottom:([#\w\s]+)/gi,"border:$1")}),_formatHtml(a,c)}function _mediaType(a){return/\.(rm|rmvb)(\?|$)/i.test(a)?"audio/x-pn-realaudio-plugin":/\.(swf|flv)(\?|$)/i.test(a)?"application/x-shockwave-flash":"video/x-ms-asf-plugin"}function _mediaClass(a){return/realaudio/i.test(a)?"ke-rm":/flash/i.test(a)?"ke-flash":"ke-media"}function _mediaAttrs(a){return _getAttrList(unescape(a))}function _mediaEmbed(a){var c="<embed ";return _each(a,function(a,h){c+=a+'="'+h+'" '}),c+="/>"}function _mediaImg(a,c){var h=c.width,g=c.height,v=c.type||_mediaType(c.src),_=_mediaEmbed(c),b="";/\D/.test(h)?b+="width:"+h+";":h>0&&(b+="width:"+h+"px;"),/\D/.test(g)?b+="height:"+g+";":g>0&&(b+="height:"+g+"px;");var y='<img class="'+_mediaClass(v)+'" src="'+a+'" ';return""!==b&&(y+='style="'+b+'" '),y+='data-ke-tag="'+escape(_)+'" alt="" />'}function _tmpl(a,c){var h=new Function("obj","var p=[],print=function(){p.push.apply(p,arguments);};with(obj){p.push('"+a.replace(/[\r\t\n]/g," ").split("<%").join("	").replace(/((^|%>)[^\t]*)'/g,"$1\r").replace(/\t=(.*?)%>/g,"',$1,'").split("	").join("');").split("%>").join("p.push('").split("\r").join("\\'")+"');}return p.join('');");return c?h(c):h}function _contains(a,c){if(9==a.nodeType&&9!=c.nodeType)return!0;for(;c=c.parentNode;)if(c==a)return!0;return!1}function _getAttr(a,c){c=c.toLowerCase();var h=null;if(_GET_SET_ATTRIBUTE||"script"==a.nodeName.toLowerCase())try{h=a.getAttribute(c,2)}catch(e){h=a.getAttribute(c,1)}else{var g=a.ownerDocument.createElement("div");g.appendChild(a.cloneNode(!1));var v=_getAttrList(_unescape(g.innerHTML));c in v&&(h=v[c])}return"style"===c&&null!==h&&(h=_formatCss(h)),h}function _queryAll(a,c){function h(a){return"string"!=typeof a?a:a.replace(/([^\w\-])/g,"\\$1")}function g(a){return a.replace(/\\/g,"")}function v(a,c){return"*"===a||a.toLowerCase()===h(c.toLowerCase())}function _(a,c,h){var _=[],b=h.ownerDocument||h,y=b.getElementById(g(a));return y&&v(c,y.nodeName)&&_contains(h,y)&&_.push(y),_}function b(a,c,h){var _,i,b,y,k=h.ownerDocument||h,w=[];if(h.getElementsByClassName)for(_=h.getElementsByClassName(g(a)),i=0,b=_.length;b>i;i++)y=_[i],v(c,y.nodeName)&&w.push(y);else if(k.querySelectorAll)for(_=k.querySelectorAll(("#document"!==h.nodeName?h.nodeName+" ":"")+c+"."+a),i=0,b=_.length;b>i;i++)y=_[i],_contains(h,y)&&w.push(y);else for(_=h.getElementsByTagName(c),a=" "+a+" ",i=0,b=_.length;b>i;i++)if(y=_[i],1==y.nodeType){var S=y.className;S&&(" "+S+" ").indexOf(a)>-1&&w.push(y)}return w}function y(a,c,h){for(var _,b=[],y=h.ownerDocument||h,k=y.getElementsByName(g(a)),i=0,w=k.length;w>i;i++)_=k[i],v(c,_.nodeName)&&_contains(h,_)&&null!==_.getAttribute("name")&&b.push(_);return b}function k(a,c,g,v){for(var _,b=[],y=v.getElementsByTagName(g),i=0,k=y.length;k>i;i++)_=y[i],1==_.nodeType&&(null===c?null!==_getAttr(_,a)&&b.push(_):c===h(_getAttr(_,a))&&b.push(_));return b}function w(a,c){var h,g=[];h=/^((?:\\.|[^.#\s\[<>])+)/.exec(a);var v=h?h[1]:"*";if(h=/#((?:[\w\-]|\\.)+)$/.exec(a))g=_(h[1],v,c);else if(h=/\.((?:[\w\-]|\\.)+)$/.exec(a))g=b(h[1],v,c);else if(h=/\[((?:[\w\-]|\\.)+)\]/.exec(a))g=k(h[1].toLowerCase(),null,v,c);else if(h=/\[((?:[\w\-]|\\.)+)\s*=\s*['"]?((?:\\.|[^'"]+)+)['"]?\]/.exec(a)){var w=h[1].toLowerCase(),S=h[2];g="id"===w?_(S,v,c):"class"===w?b(S,v,c):"name"===w?y(S,v,c):k(w,S,v,c)}else for(var E,C=c.getElementsByTagName(v),i=0,T=C.length;T>i;i++)E=C[i],1==E.nodeType&&g.push(E);return g}var S=a.split(",");if(S.length>1){var E=[];return _each(S,function(){_each(_queryAll(this,c),function(){_inArray(this,E)<0&&E.push(this)})}),E}c=c||document;for(var C,T=[],re=/((?:\\.|[^\s>])+|[\s>])/g;C=re.exec(a);)" "!==C[1]&&T.push(C[1]);var K=[];if(1==T.length)return w(T[0],c);var U,A,N,I,F,i,D,R,M,l,P=!1;for(i=0,lenth=T.length;lenth>i;i++)if(U=T[i],">"!==U){if(i>0){for(A=[],D=0,M=K.length;M>D;D++)for(I=K[D],N=w(U,I),R=0,l=N.length;l>R;R++)F=N[R],P?I===F.parentNode&&A.push(F):A.push(F);K=A}else K=w(U,c);if(0===K.length)return[]}else P=!0;return K}function _query(a,c){var h=_queryAll(a,c);return h.length>0?h[0]:null}function _get(a){return K(a)[0]}function _getDoc(a){return a?a.ownerDocument||a.document||a:document}function _getWin(a){if(!a)return window;var c=_getDoc(a);return c.parentWindow||c.defaultView}function _setHtml(a,c){if(1==a.nodeType){var h=_getDoc(a);try{a.innerHTML='<img id="__kindeditor_temp_tag__" width="0" height="0" style="display:none;" />'+c;var g=h.getElementById("__kindeditor_temp_tag__");g.parentNode.removeChild(g)}catch(e){K(a).empty(),K("@"+c,h).each(function(){a.appendChild(this)})}}}function _hasClass(a,c){return _inString(c,a.className," ")}function _setAttr(a,c,h){_IE&&8>_V&&"class"==c.toLowerCase()&&(c="className"),a.setAttribute(c,""+h)}function _removeAttr(a,c){_IE&&8>_V&&"class"==c.toLowerCase()&&(c="className"),_setAttr(a,c,""),a.removeAttribute(c)}function _getNodeName(a){return a&&a.nodeName?a.nodeName.toLowerCase():""}function _computedCss(a,c){var h=_getWin(a),g=_toCamel(c),v="";if(h.getComputedStyle){var _=h.getComputedStyle(a,null);v=_[g]||_.getPropertyValue(c)||a.style[g]}else a.currentStyle&&(v=a.currentStyle[g]||a.style[g]);return v}function _hasVal(a){return!!_VALUE_TAG_MAP[_getNodeName(a)]}function _docElement(a){return a=a||document,_QUIRKS?a.body:a.documentElement}function _docHeight(a){var c=_docElement(a);return Math.max(c.scrollHeight,c.clientHeight)}function _docWidth(a){var c=_docElement(a);return Math.max(c.scrollWidth,c.clientWidth)}function _getScrollPos(a){a=a||document;var x,c;return _IE||_NEWIE||_OPERA?(x=_docElement(a).scrollLeft,c=_docElement(a).scrollTop):(x=_getWin(a).scrollX,c=_getWin(a).scrollY),{x:x,y:c}}function KNode(a){this.init(a)}function _updateCollapsed(a){return a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset,a}function _copyAndDelete(a,c,h){function g(g,v,_){var b,k=g.nodeValue.length;if(c){var w=g.cloneNode(!0);b=v>0?w.splitText(v):w,k>_&&b.splitText(_-v)}if(h){var S=g;if(v>0&&(S=g.splitText(v),a.setStart(g,v)),k>_){var E=S.splitText(_-v);a.setEnd(E,0)}y.push(S)}return b}function v(){h&&a.up().collapse(!0);for(var i=0,c=y.length;c>i;i++){var g=y[i];g.parentNode&&g.parentNode.removeChild(g)}}function _(v,T){for(var K,U=v.firstChild;U;){var A=new KRange(b).selectNode(U);if(w=A.compareBoundaryPoints(_START_TO_END,a),w>=0&&0>=S&&(S=A.compareBoundaryPoints(_START_TO_START,a)),S>=0&&0>=E&&(E=A.compareBoundaryPoints(_END_TO_END,a)),E>=0&&0>=C&&(C=A.compareBoundaryPoints(_END_TO_START,a)),C>=0)return!1;if(K=U.nextSibling,w>0)if(1==U.nodeType)if(S>=0&&0>=E)c&&T.appendChild(U.cloneNode(!0)),h&&y.push(U);else{var N;if(c&&(N=U.cloneNode(!1),T.appendChild(N)),_(U,N)===!1)return!1}else if(3==U.nodeType){var I;if(I=U==k.startContainer?g(U,k.startOffset,U.nodeValue.length):U==k.endContainer?g(U,0,k.endOffset):g(U,0,U.nodeValue.length),c)try{T.appendChild(I)}catch(e){}}U=K}}var b=a.doc,y=[],k=a.cloneRange().down(),w=-1,S=-1,E=-1,C=-1,T=a.commonAncestor(),K=b.createDocumentFragment();if(3==T.nodeType){var U=g(T,a.startOffset,a.endOffset);return c&&K.appendChild(U),v(),c?K:a}_(T,K),h&&a.up().collapse(!0);for(var i=0,A=y.length;A>i;i++){var N=y[i];N.parentNode&&N.parentNode.removeChild(N)}return c?K:a}function _moveToElementText(a,c){for(var h=c;h;){var g=K(h);if("marquee"==g.name||"select"==g.name)return;h=h.parentNode}try{a.moveToElementText(c)}catch(e){}}function _getStartEnd(a,c){var h=a.parentElement().ownerDocument,g=a.duplicate();g.collapse(c);var v=g.parentElement(),_=v.childNodes;if(0===_.length)return{node:v.parentNode,offset:K(v).index()};var b=h,y=0,k=-1,w=a.duplicate();_moveToElementText(w,v);for(var i=0,S=_.length;S>i;i++){var E=_[i];if(k=w.compareEndPoints("StartToStart",g),0===k)return{node:E.parentNode,offset:i};if(1==E.nodeType){var C,T=a.duplicate(),U=K(E),A=E;U.isControl()&&(C=h.createElement("span"),U.after(C),A=C,y+=U.text().replace(/\r\n|\n|\r/g,"").length),_moveToElementText(T,A),w.setEndPoint("StartToEnd",T),k>0?y+=T.text.replace(/\r\n|\n|\r/g,"").length:y=0,C&&K(C).remove()}else 3==E.nodeType&&(w.moveStart("character",E.nodeValue.length),y+=E.nodeValue.length);0>k&&(b=E)}if(0>k&&1==b.nodeType)return{node:v,offset:K(v.lastChild).index()+1};if(k>0)for(;b.nextSibling&&1==b.nodeType;)b=b.nextSibling;if(w=a.duplicate(),_moveToElementText(w,v),w.setEndPoint("StartToEnd",g),y-=w.text.replace(/\r\n|\n|\r/g,"").length,k>0&&3==b.nodeType)for(var N=b.previousSibling;N&&3==N.nodeType;)y-=N.nodeValue.length,N=N.previousSibling;return{node:b,offset:y}}function _getEndRange(a,c){var h=a.ownerDocument||a,g=h.body.createTextRange();if(h==a)return g.collapse(!0),g;if(1==a.nodeType&&a.childNodes.length>0){var v,_,b=a.childNodes;if(0===c?(_=b[0],v=!0):(_=b[c-1],v=!1),!_)return g;if("head"===K(_).name)return 1===c&&(v=!0),2===c&&(v=!1),g.collapse(v),g;if(1==_.nodeType){var y,k=K(_);return k.isControl()&&(y=h.createElement("span"),v?k.before(y):k.after(y),_=y),_moveToElementText(g,_),g.collapse(v),y&&K(y).remove(),g}a=_,c=v?0:_.nodeValue.length}var w=h.createElement("span");return K(a).before(w),_moveToElementText(g,w),g.moveStart("character",c),K(w).remove(),g}function _toRange(a){function c(a){"tr"==K(a.node).name&&(a.node=a.node.cells[a.offset],a.offset=0)}var h,g;if(_IERANGE){if(a.item)return h=_getDoc(a.item(0)),g=new KRange(h),g.selectNode(a.item(0)),g;h=a.parentElement().ownerDocument;var v=_getStartEnd(a,!0),_=_getStartEnd(a,!1);return c(v),c(_),g=new KRange(h),g.setStart(v.node,v.offset),g.setEnd(_.node,_.offset),g}var b=a.startContainer;return h=b.ownerDocument||b,g=new KRange(h),g.setStart(b,a.startOffset),g.setEnd(a.endContainer,a.endOffset),g}function KRange(a){this.init(a)}function _range(a){return a.nodeName?new KRange(a):a.constructor===KRange?a:_toRange(a)}function _nativeCommand(a,c,h){try{a.execCommand(c,!1,h)}catch(e){}}function _nativeCommandValue(a,c){var h="";try{h=a.queryCommandValue(c)}catch(e){}return"string"!=typeof h&&(h=""),h}function _getSel(a){var c=_getWin(a);return _IERANGE?a.selection:c.getSelection()}function _getRng(a){var c,h=_getSel(a);try{c=h.rangeCount>0?h.getRangeAt(0):h.createRange()}catch(e){}return!_IERANGE||c&&(c.item||c.parentElement().ownerDocument===a)?c:null}function _singleKeyMap(a){var c,h,g={};return _each(a,function(a,v){c=a.split(",");for(var i=0,_=c.length;_>i;i++)h=c[i],g[h]=v}),g}function _hasAttrOrCss(a,c){return _hasAttrOrCssByKey(a,c,"*")||_hasAttrOrCssByKey(a,c)}function _hasAttrOrCssByKey(a,c,h){if(h=h||a.name,1!==a.type)return!1;var g=_singleKeyMap(c);if(!g[h])return!1;for(var v=g[h].split(","),i=0,_=v.length;_>i;i++){var b=v[i];if("*"===b)return!0;var y=/^(\.?)([^=]+)(?:=([^=]*))?$/.exec(b),k=y[1]?"css":"attr";b=y[2];var w=y[3]||"";if(""===w&&""!==a[k](b))return!0;if(""!==w&&a[k](b)===w)return!0}return!1}function _removeAttrOrCss(a,c){1==a.type&&(_removeAttrOrCssByKey(a,c,"*"),_removeAttrOrCssByKey(a,c))}function _removeAttrOrCssByKey(a,c,h){if(h=h||a.name,1===a.type){var g=_singleKeyMap(c);if(g[h]){for(var v=g[h].split(","),_=!1,i=0,b=v.length;b>i;i++){var y=v[i];if("*"===y){_=!0;break}var k=/^(\.?)([^=]+)(?:=([^=]*))?$/.exec(y);y=k[2],k[1]?(y=_toCamel(y),a[0].style[y]&&(a[0].style[y]="")):a.removeAttr(y)}_&&a.remove(!0)}}}function _getInnerNode(a){for(var c=a;c.first();)c=c.first();return c}function _isEmptyNode(a){return 1!=a.type||a.isSingle()?!1:""===a.html().replace(/<[^>]+>/g,"")}function _mergeWrapper(a,c){a=a.clone(!0);for(var h=_getInnerNode(a),g=a,v=!1;c;){for(;g;)g.name===c.name&&(_mergeAttrs(g,c.attr(),c.css()),v=!0),g=g.first();v||h.append(c.clone(!1)),v=!1,c=c.first()}return a}function _wrapNode(a,c){if(c=c.clone(!0),3==a.type)return _getInnerNode(c).append(a.clone(!1)),a.replaceWith(c),c;for(var h,g=a;(h=a.first())&&1==h.children().length;)a=h;h=a.first();for(var v=a.doc.createDocumentFragment();h;)v.appendChild(h[0]),h=h.next();return c=_mergeWrapper(g,c),v.firstChild&&_getInnerNode(c).append(v),g.replaceWith(c),c}function _mergeAttrs(a,c,h){_each(c,function(c,h){"style"!==c&&a.attr(c,h)}),_each(h,function(c,h){a.css(c,h)})}function _inPreElement(a){for(;a&&"body"!=a.name;){if(_PRE_TAG_MAP[a.name]||"div"==a.name&&a.hasClass("ke-script"))return!0;a=a.parent()}return!1}function KCmd(a){this.init(a)}function _cmd(a){if(a.nodeName){var c=_getDoc(a);a=_range(c).selectNodeContents(c.body).collapse(!1)}return new KCmd(a)}function _drag(a){var c=a.moveEl,h=a.moveFn,g=a.clickEl||c,v=a.beforeDrag,_=a.iframeFix===undefined?!0:a.iframeFix,b=[document];_&&K("iframe").each(function(){var a=_formatUrl(this.src||"","absolute");if(!/^https?:\/\//.test(a)){var c;try{c=_iframeDoc(this)}catch(e){}if(c){var h=K(this).pos();K(c).data("pos-x",h.x),K(c).data("pos-y",h.y),b.push(c)}}}),g.mousedown(function(e){function a(e){e.preventDefault();var a=K(_getDoc(e.target)),c=_round((a.data("pos-x")||0)+e.pageX-C),v=_round((a.data("pos-y")||0)+e.pageY-T);h.call(g,x,w,S,E,c,v)}function _(e){e.preventDefault()}function y(e){e.preventDefault(),K(b).unbind("mousemove",a).unbind("mouseup",y).unbind("selectstart",_),k.releaseCapture&&k.releaseCapture()}e.stopPropagation();var k=g.get(),x=_removeUnit(c.css("left")),w=_removeUnit(c.css("top")),S=c.width(),E=c.height(),C=e.pageX,T=e.pageY;v&&v(),K(b).mousemove(a).mouseup(y).bind("selectstart",_),k.setCapture&&k.setCapture()})}function KWidget(a){this.init(a)}function _widget(a){return new KWidget(a)}function _iframeDoc(a){return a=_get(a),a.contentDocument||a.contentWindow.document}function _getInitHtml(a,c,h,g){var v=[""===_direction?"<html>":'<html dir="'+_direction+'">','<head><meta charset="utf-8" /><title></title>',"<style>","html {margin:0;padding:0;}","body {margin:0;padding:5px;}",'body, td {font:12px/1.5 "sans serif",tahoma,verdana,helvetica;}',"body, p, div {word-wrap: break-word;}","p {margin:5px 0;}","table {border-collapse:collapse;}","img {border:0;}","noscript {display:none;}","table.ke-zeroborder td {border:1px dotted #AAA;}","img.ke-flash {","	border:1px solid #AAA;","	background-image:url("+a+"common/flash.gif);","	background-position:center center;","	background-repeat:no-repeat;","	width:100px;","	height:100px;","}","img.ke-rm {","	border:1px solid #AAA;","	background-image:url("+a+"common/rm.gif);","	background-position:center center;","	background-repeat:no-repeat;","	width:100px;","	height:100px;","}","img.ke-media {","	border:1px solid #AAA;","	background-image:url("+a+"common/media.gif);","	background-position:center center;","	background-repeat:no-repeat;","	width:100px;","	height:100px;","}","img.ke-anchor {","	border:1px dashed #666;","	width:16px;","	height:16px;","}",".ke-script, .ke-noscript, .ke-display-none {","	display:none;","	font-size:0;","	width:0;","	height:0;","}",".ke-pagebreak {","	border:1px dotted #AAA;","	font-size:0;","	height:2px;","}","</style>"];return _isArray(h)||(h=[h]),_each(h,function(i,a){a&&v.push('<link href="'+a+'" rel="stylesheet" />')}),g&&v.push("<style>"+g+"</style>"),v.push("</head><body "+(c?'class="'+c+'"':"")+"></body></html>"),v.join("\n")}function _elementVal(a,c){if(a.hasVal()){if(c===undefined){var h=a.val();return h=h.replace(/(<(?:p|p\s[^>]*)>) *(<\/p>)/gi,"")}return a.val(c)}return a.html(c)}function KEdit(a){this.init(a)}function _edit(a){return new KEdit(a)}function _selectToolbar(a,c){var h=this,g=h.get(a);if(g){if(g.hasClass("ke-disabled"))return;c(g)}}function KToolbar(a){this.init(a)}function _toolbar(a){return new KToolbar(a)}function KMenu(a){this.init(a)}function _menu(a){return new KMenu(a)}function KColorPicker(a){this.init(a)}function _colorpicker(a){return new KColorPicker(a)}function KUploadButton(a){this.init(a)}function _uploadbutton(a){return new KUploadButton(a)}function _createButton(a){a=a||{};var c=a.name||"",h=K('<span class="ke-button-common ke-button-outer" title="'+c+'"></span>'),g=K('<input class="ke-button-common ke-button" type="button" value="'+c+'" />');return a.click&&g.click(a.click),h.append(g),h}function KDialog(a){this.init(a)}function _dialog(a){return new KDialog(a)}function _tabs(a){var c=_widget(a),h=c.remove,g=a.afterSelect,v=c.div,_=[];v.addClass("ke-tabs").bind("contextmenu,mousedown,mousemove",function(e){e.preventDefault()});var ul=K('<ul class="ke-tabs-ul ke-clearfix"></ul>');return v.append(ul),c.add=function(a){var c=K('<li class="ke-tabs-li">'+a.title+"</li>");c.data("tab",a),_.push(c),ul.append(c)},c.selectedIndex=0,c.select=function(a){c.selectedIndex=a,_each(_,function(i,h){h.unbind(),i===a?(h.addClass("ke-tabs-li-selected"),K(h.data("tab").panel).show("")):(h.removeClass("ke-tabs-li-selected").removeClass("ke-tabs-li-on").mouseover(function(){K(this).addClass("ke-tabs-li-on")}).mouseout(function(){K(this).removeClass("ke-tabs-li-on")}).click(function(){c.select(i)}),K(h.data("tab").panel).hide())}),g&&g.call(c,a)},c.remove=function(){_each(_,function(){this.remove()}),ul.remove(),h.call(c)},c}function _loadScript(a,c){var h=document.getElementsByTagName("head")[0]||(_QUIRKS?document.body:document.documentElement),g=document.createElement("script");h.appendChild(g),g.src=a,g.charset="utf-8",g.onload=g.onreadystatechange=function(){this.readyState&&"loaded"!==this.readyState||(c&&c(),g.onload=g.onreadystatechange=null,h.removeChild(g))}}function _chopQuery(a){var c=a.indexOf("?");return c>0?a.substr(0,c):a}function _loadStyle(a){for(var c=document.getElementsByTagName("head")[0]||(_QUIRKS?document.body:document.documentElement),h=document.createElement("link"),g=_chopQuery(_formatUrl(a,"absolute")),v=K('link[rel="stylesheet"]',c),i=0,_=v.length;_>i;i++)if(_chopQuery(_formatUrl(v[i].href,"absolute"))===g)return;c.appendChild(h),h.href=a,h.rel="stylesheet"}function _ajax(a,c,h,g,v){h=h||"GET",v=v||"json";var _=window.XMLHttpRequest?new window.XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");if(_.open(h,a,!0),_.onreadystatechange=function(){if(4==_.readyState&&200==_.status&&c){var a=_trim(_.responseText);"json"==v&&(a=_json(a)),c(a)}},"POST"==h){var b=[];_each(g,function(a,c){b.push(encodeURIComponent(a)+"="+encodeURIComponent(c))});try{_.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(e){}_.send(b.join("&"))}else _.send(null)}function _plugin(a,c){return a===undefined?_plugins:c?void(_plugins[a]=c):_plugins[a]}function _parseLangKey(a){var c,h="core";return(c=/^(\w+)\.(\w+)$/.exec(a))&&(h=c[1],a=c[2]),{ns:h,key:a}}function _lang(a,c){if(c=c===undefined?K.options.langType:c,"string"==typeof a){if(!_language[c])return"no language";var h=a.length-1;if("."===a.substr(h))return _language[c][a.substr(0,h)];var g=_parseLangKey(a);return _language[c][g.ns][g.key]}_each(a,function(a,h){var g=_parseLangKey(a);_language[c]||(_language[c]={}),_language[c][g.ns]||(_language[c][g.ns]={}),_language[c][g.ns][g.key]=h})}function _getImageFromRange(a,c){if(!a.collapsed){a=a.cloneRange().up();var h=a.startContainer,g=a.startOffset;if(_WEBKIT||a.isControl()){var v=K(h.childNodes[g]);if(v&&"img"==v.name)return c(v)?v:void 0}}}function _bindContextmenuEvent(){var a=this,c=a.edit.doc;K(c).contextmenu(function(e){if(a.menu&&a.hideMenu(),!a.useContextmenu)return void e.preventDefault();if(0!==a._contextmenus.length){var c=0,h=[];for(_each(a._contextmenus,function(){return"-"==this.title?void h.push(this):void(this.cond&&this.cond()&&(h.push(this),this.width&&this.width>c&&(c=this.width)))});h.length>0&&"-"==h[0].title;)h.shift();for(;h.length>0&&"-"==h[h.length-1].title;)h.pop();var g=null;if(_each(h,function(i){"-"==this.title&&"-"==g.title&&delete h[i],g=this}),h.length>0){e.preventDefault();var v=K(a.edit.iframe).pos(),_=_menu({x:v.x+e.clientX,y:v.y+e.clientY,width:c,css:{visibility:"hidden"},shadowMode:a.shadowMode});_each(h,function(){this.title&&_.addItem(this)});var b=_docElement(_.doc),y=_.div.height();e.clientY+y>=b.clientHeight-100&&_.pos(_.x,_removeUnit(_.y)-y),_.div.css("visibility","visible"),a.menu=_}}})}function _bindNewlineEvent(){function a(a){for(var c=K(a.commonAncestor());c&&(1!=c.type||c.isStyle());)c=c.parent();return c.name}var c=this,h=c.edit.doc,g=c.newlineTag;if(!(_IE&&"br"!==g||_GECKO&&3>_V&&"p"!==g||_OPERA&&9>_V)){var v=_toMap("h1,h2,h3,h4,h5,h6,pre,li"),_=_toMap("p,h1,h2,h3,h4,h5,h6,pre,li,blockquote");K(h).keydown(function(e){if(!(13!=e.which||e.shiftKey||e.ctrlKey||e.altKey)){c.cmd.selection();var b=a(c.cmd.range);if("marquee"!=b&&"select"!=b)return"br"!==g||v[b]?void(_[b]||_nativeCommand(h,"formatblock","<p>")):(e.preventDefault(),void c.insertHtml("<br />"+(_IE&&9>_V?"":"â€‹")))}}),K(h).keyup(function(e){if(!(13!=e.which||e.shiftKey||e.ctrlKey||e.altKey)&&"br"!=g){if(_GECKO){var v=c.cmd.commonAncestor("p"),b=c.cmd.commonAncestor("a");return void(b&&""==b.text()&&(b.remove(!0),c.cmd.range.selectNodeContents(v[0]).collapse(!0),c.cmd.select()))}c.cmd.selection();var y=a(c.cmd.range);if("marquee"!=y&&"select"!=y){_[y]||_nativeCommand(h,"formatblock","<p>");var k=c.cmd.commonAncestor("div");if(k){for(var p=K("<p></p>"),w=k[0].firstChild;w;){var S=w.nextSibling;p.append(w),w=S}k.before(p),k.remove(),c.cmd.range.selectNodeContents(p[0]),c.cmd.select()}}}})}}function _bindTabEvent(){var a=this,c=a.edit.doc;K(c).keydown(function(e){if(9==e.which){if(e.preventDefault(),a.afterTab)return void a.afterTab.call(a,e);var h=a.cmd,g=h.range;g.shrink(),g.collapsed&&1==g.startContainer.nodeType&&(g.insertNode(K("@&nbsp;",c)[0]),h.select()),a.insertHtml("&nbsp;&nbsp;&nbsp;&nbsp;")}})}function _bindFocusEvent(){var a=this;K(a.edit.textarea[0],a.edit.win).focus(function(e){a.afterFocus&&a.afterFocus.call(a,e)}).blur(function(e){a.afterBlur&&a.afterBlur.call(a,e)})}function _removeBookmarkTag(a){return _trim(a.replace(/<span [^>]*id="?__kindeditor_bookmark_\w+_\d+__"?[^>]*><\/span>/gi,""))}function _removeTempTag(a){return a.replace(/<div[^>]+class="?__kindeditor_paste__"?[^>]*>[\s\S]*?<\/div>/gi,"")}function _addBookmarkToStack(a,c){if(0===a.length)return void a.push(c);var h=a[a.length-1];_removeBookmarkTag(c.html)!==_removeBookmarkTag(h.html)&&a.push(c)}function _undoToRedo(a,c){var h,g,v=this,_=v.edit,b=_.doc.body;if(0===a.length)return v;_.designMode?(h=v.cmd.range,g=h.createBookmark(!0),g.html=b.innerHTML):g={html:b.innerHTML},_addBookmarkToStack(c,g);var y=a.pop();
return _removeBookmarkTag(g.html)===_removeBookmarkTag(y.html)&&a.length>0&&(y=a.pop()),_.designMode?(_.html(y.html),y.start&&(h.moveToBookmark(y),v.select())):K(b).html(_removeBookmarkTag(y.html)),v}function KEditor(a){function c(a,c){KEditor.prototype[a]===undefined&&(h[a]=c),h.options[a]=c}var h=this;h.options={},_each(a,function(h){c(h,a[h])}),_each(K.options,function(a,g){h[a]===undefined&&c(a,g)});var g=K(h.srcElement||"<textarea/>");h.width||(h.width=g[0].style.width||g.width()),h.height||(h.height=g[0].style.height||g.height()),c("width",_undef(h.width,h.minWidth)),c("height",_undef(h.height,h.minHeight)),c("width",_addUnit(h.width)),c("height",_addUnit(h.height)),_MOBILE&&(!_IOS||534>_V)&&(h.designMode=!1),h.srcElement=g,h.initContent="",h.plugin={},h.isCreated=!1,h._handlers={},h._contextmenus=[],h._undoStack=[],h._redoStack=[],h._firstAddBookmark=!0,h.menu=h.contextmenu=null,h.dialogs=[]}function _editor(a){return new KEditor(a)}function _create(a,c){function h(a){return _each(_plugins,function(c,h){_isFunction(h)&&h.call(a,KindEditor)}),a.create()}if(c=c||{},c.basePath=_undef(c.basePath,K.basePath),c.themesPath=_undef(c.themesPath,c.basePath+"themes/"),c.langPath=_undef(c.langPath,c.basePath+"lang/"),c.pluginsPath=_undef(c.pluginsPath,c.basePath+"plugins/"),_undef(c.loadStyleMode,K.options.loadStyleMode)){var g=_undef(c.themeType,K.options.themeType);_loadStyle(c.themesPath+"default/default.css"),_loadStyle(c.themesPath+g+"/"+g+".css")}var v=K(a);if(v&&0!==v.length){if(v.length>1)return v.each(function(){_create(this,c)}),_instances[0];c.srcElement=v[0];var _=new KEditor(c);return _instances.push(_),_language[_.langType]?h(_):(_loadScript(_.langPath+_.langType+".js?ver="+encodeURIComponent(K.DEBUG?_TIME:_VERSION),function(){h(_)}),_)}}function _eachEditor(a,c){K(a).each(function(i,a){K.each(_instances,function(h,g){return g&&g.srcElement[0]==a?(c.call(g,h),!1):void 0})})}if(!window.KindEditor){window.console||(window.console={}),console.log||(console.log=function(){});var _VERSION="4.1.10 (2013-11-23)",_ua=navigator.userAgent.toLowerCase(),_IE=_ua.indexOf("msie")>-1&&-1==_ua.indexOf("opera"),_NEWIE=-1==_ua.indexOf("msie")&&_ua.indexOf("trident")>-1,_GECKO=_ua.indexOf("gecko")>-1&&-1==_ua.indexOf("khtml"),_WEBKIT=_ua.indexOf("applewebkit")>-1,_OPERA=_ua.indexOf("opera")>-1,_MOBILE=_ua.indexOf("mobile")>-1,_IOS=/ipad|iphone|ipod/.test(_ua),_QUIRKS="CSS1Compat"!=document.compatMode,_IERANGE=!window.getSelection,_matches=/(?:msie|firefox|webkit|opera)[\/:\s](\d+)/.exec(_ua),_V=_matches?_matches[1]:"0",_TIME=(new Date).getTime(),_round=Math.round,K={DEBUG:!1,VERSION:_VERSION,IE:_IE,GECKO:_GECKO,WEBKIT:_WEBKIT,OPERA:_OPERA,V:_V,TIME:_TIME,each:_each,isArray:_isArray,isFunction:_isFunction,inArray:_inArray,inString:_inString,trim:_trim,addUnit:_addUnit,removeUnit:_removeUnit,escape:_escape,unescape:_unescape,toCamel:_toCamel,toHex:_toHex,toMap:_toMap,toArray:_toArray,undef:_undef,invalidUrl:_invalidUrl,addParam:_addParam,extend:_extend,json:_json},_INLINE_TAG_MAP=_toMap("a,abbr,acronym,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,img,input,ins,kbd,label,map,q,s,samp,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),_BLOCK_TAG_MAP=_toMap("address,applet,blockquote,body,center,dd,dir,div,dl,dt,fieldset,form,frameset,h1,h2,h3,h4,h5,h6,head,hr,html,iframe,ins,isindex,li,map,menu,meta,noframes,noscript,object,ol,p,pre,script,style,table,tbody,td,tfoot,th,thead,title,tr,ul"),_SINGLE_TAG_MAP=_toMap("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed"),_STYLE_TAG_MAP=_toMap("b,basefont,big,del,em,font,i,s,small,span,strike,strong,sub,sup,u"),_CONTROL_TAG_MAP=_toMap("img,table,input,textarea,button"),_PRE_TAG_MAP=_toMap("pre,style,script"),_NOSPLIT_TAG_MAP=_toMap("html,head,body,td,tr,table,ol,ul,li"),_AUTOCLOSE_TAG_MAP=_toMap("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),_FILL_ATTR_MAP=_toMap("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),_VALUE_TAG_MAP=_toMap("input,button,textarea,select");K.basePath=_getBasePath(),K.options={designMode:!0,fullscreenMode:!1,filterMode:!0,wellFormatMode:!0,shadowMode:!0,loadStyleMode:!0,basePath:K.basePath,themesPath:K.basePath+"themes/",langPath:K.basePath+"lang/",pluginsPath:K.basePath+"plugins/",themeType:"default",langType:"zh_CN",urlType:"",newlineTag:"p",resizeType:2,syncType:"form",pasteType:2,dialogAlignType:"page",useContextmenu:!0,fullscreenShortcut:!1,bodyClass:"ke-content",indentChar:"	",cssPath:"",cssData:"",minWidth:650,minHeight:100,minChangeSize:50,zIndex:811213,items:["source","|","undo","redo","|","preview","print","template","code","cut","copy","paste","plainpaste","wordpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","clearhtml","quickformat","selectall","|","fullscreen","/","formatblock","fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","strikethrough","lineheight","removeformat","|","image","multiimage","flash","media","insertfile","table","hr","emoticons","baidumap","pagebreak","anchor","link","unlink","|","about"],noDisableItems:["source","fullscreen"],colorTable:[["#E53333","#E56600","#FF9900","#64451D","#DFC5A4","#FFE500"],["#009900","#006600","#99BB00","#B8D100","#60D978","#00D5FF"],["#337FE5","#003399","#4C33E5","#9933E5","#CC33E5","#EE33EE"],["#FFFFFF","#CCCCCC","#999999","#666666","#333333","#000000"]],fontSizeTable:["9px","10px","12px","14px","16px","18px","24px","32px"],htmlTags:{font:["id","class","color","size","face",".background-color"],span:["id","class",".color",".background-color",".font-size",".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align",".line-height"],div:["id","class","align",".border",".margin",".padding",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".background",".font-style",".text-decoration",".vertical-align",".margin-left"],table:["id","class","border","cellspacing","cellpadding","width","height","align","bordercolor",".padding",".margin",".border","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".font-style",".text-decoration",".background",".width",".height",".border-collapse"],"td,th":["id","class","align","valign","width","height","colspan","rowspan","bgcolor",".text-align",".color",".background-color",".font-size",".font-family",".font-weight",".font-style",".text-decoration",".vertical-align",".background",".border"],a:["id","class","href","target","name"],embed:["id","class","src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["id","class","src","width","height","border","alt","title","align",".width",".height",".border"],"p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":["id","class","align",".text-align",".color",".background-color",".font-size",".font-family",".background",".font-weight",".font-style",".text-decoration",".vertical-align",".text-indent",".margin-left"],pre:["id","class"],hr:["id","class",".page-break-after"],"br,tbody,tr,strong,b,sub,sup,em,i,u,strike,s,del":["id","class"],iframe:["id","class","src","frameborder","width","height",".width",".height"]},layout:'<div class="container"><div class="toolbar"></div><div class="edit"></div><div class="statusbar"></div></div>'};var _useCapture=!1,_INPUT_KEY_MAP=_toMap("8,9,13,32,46,48..57,59,61,65..90,106,109..111,188,190..192,219..222"),_CURSORMOVE_KEY_MAP=_toMap("33..40"),_CHANGE_KEY_MAP={};_each(_INPUT_KEY_MAP,function(a,c){_CHANGE_KEY_MAP[a]=c}),_each(_CURSORMOVE_KEY_MAP,function(a,c){_CHANGE_KEY_MAP[a]=c});var _EVENT_PROPS="altKey,attrChange,attrName,bubbles,button,cancelable,charCode,clientX,clientY,ctrlKey,currentTarget,data,detail,eventPhase,fromElement,handler,keyCode,metaKey,newValue,offsetX,offsetY,originalTarget,pageX,pageY,prevValue,relatedNode,relatedTarget,screenX,screenY,shiftKey,srcElement,target,toElement,view,wheelDelta,which".split(",");_extend(KEvent,{init:function(a,c){var h=this,g=a.ownerDocument||a.document||a;if(h.event=c,_each(_EVENT_PROPS,function(a,g){h[g]=c[g]}),h.target||(h.target=h.srcElement||g),3===h.target.nodeType&&(h.target=h.target.parentNode),!h.relatedTarget&&h.fromElement&&(h.relatedTarget=h.fromElement===h.target?h.toElement:h.fromElement),null==h.pageX&&null!=h.clientX){var d=g.documentElement,v=g.body;h.pageX=h.clientX+(d&&d.scrollLeft||v&&v.scrollLeft||0)-(d&&d.clientLeft||v&&v.clientLeft||0),h.pageY=h.clientY+(d&&d.scrollTop||v&&v.scrollTop||0)-(d&&d.clientTop||v&&v.clientTop||0)}switch(!h.which&&(h.charCode||0===h.charCode?h.charCode:h.keyCode)&&(h.which=h.charCode||h.keyCode),!h.metaKey&&h.ctrlKey&&(h.metaKey=h.ctrlKey),h.which||h.button===undefined||(h.which=1&h.button?1:2&h.button?3:4&h.button?2:0),h.which){case 186:h.which=59;break;case 187:case 107:case 43:h.which=61;break;case 189:case 45:h.which=109;break;case 42:h.which=106;break;case 47:h.which=111;break;case 78:h.which=110}h.which>=96&&h.which<=105&&(h.which-=48)},preventDefault:function(){var a=this.event;a.preventDefault?a.preventDefault():a.returnValue=!1},stopPropagation:function(){var a=this.event;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},stop:function(){this.preventDefault(),this.stopPropagation()}});var _eventExpendo="kindeditor_"+_TIME,_eventId=0,_eventData={},_readyFinished=!1;_IE&&window.attachEvent("onunload",function(){_each(_eventData,function(a,c){c.el&&_unbind(c.el)})}),K.ctrl=_ctrl,K.ready=_ready,K.formatUrl=_formatUrl,K.formatHtml=_formatHtml,K.getCssList=_getCssList,K.getAttrList=_getAttrList,K.mediaType=_mediaType,K.mediaAttrs=_mediaAttrs,K.mediaEmbed=_mediaEmbed,K.mediaImg=_mediaImg,K.clearMsWord=_clearMsWord,K.tmpl=_tmpl;var _getSetAttrDiv=document.createElement("div");_getSetAttrDiv.setAttribute("className","t");var _GET_SET_ATTRIBUTE="t"!==_getSetAttrDiv.className;K.query=_query,K.queryAll=_queryAll,_extend(KNode,{init:function(a){var c=this;a=_isArray(a)?a:[a];for(var h=0,i=0,g=a.length;g>i;i++)a[i]&&(c[i]=a[i].constructor===KNode?a[i][0]:a[i],h++);c.length=h,c.doc=_getDoc(c[0]),c.name=_getNodeName(c[0]),c.type=c.length>0?c[0].nodeType:null,c.win=_getWin(c[0])},each:function(a){for(var c=this,i=0;i<c.length;i++)if(a.call(c[i],i,c[i])===!1)return c;return c},bind:function(a,c){return this.each(function(){_bind(this,a,c)}),this},unbind:function(a,c){return this.each(function(){_unbind(this,a,c)}),this},fire:function(a){return this.length<1?this:(_fire(this[0],a),this)},hasAttr:function(a){return this.length<1?!1:!!_getAttr(this[0],a)},attr:function(a,c){var h=this;return a===undefined?_getAttrList(h.outer()):"object"==typeof a?(_each(a,function(a,c){h.attr(a,c)}),h):c===undefined?(c=h.length<1?null:_getAttr(h[0],a),null===c?"":c):(h.each(function(){_setAttr(this,a,c)}),h)},removeAttr:function(a){return this.each(function(){_removeAttr(this,a)}),this},get:function(i){return this.length<1?null:this[i||0]},eq:function(i){return this.length<1?null:this[i]?new KNode(this[i]):null},hasClass:function(a){return this.length<1?!1:_hasClass(this[0],a)},addClass:function(a){return this.each(function(){_hasClass(this,a)||(this.className=_trim(this.className+" "+a))}),this},removeClass:function(a){return this.each(function(){_hasClass(this,a)&&(this.className=_trim(this.className.replace(new RegExp("(^|\\s)"+a+"(\\s|$)")," ")))}),this},html:function(a){var c=this;return a===undefined?c.length<1||1!=c.type?"":_formatHtml(c[0].innerHTML):(c.each(function(){_setHtml(this,a)}),c)},text:function(){var a=this;return a.length<1?"":_IE?a[0].innerText:a[0].textContent},hasVal:function(){return this.length<1?!1:_hasVal(this[0])},val:function(a){var c=this;return a===undefined?c.length<1?"":c.hasVal()?c[0].value:c.attr("value"):(c.each(function(){_hasVal(this)?this.value=a:_setAttr(this,"value",a)}),c)},css:function(a,c){var h=this;return a===undefined?_getCssList(h.attr("style")):"object"==typeof a?(_each(a,function(a,c){h.css(a,c)}),h):c===undefined?h.length<1?"":h[0].style[_toCamel(a)]||_computedCss(h[0],a)||"":(h.each(function(){this.style[_toCamel(a)]=c}),h)},width:function(a){var c=this;return a===undefined?c.length<1?0:c[0].offsetWidth:c.css("width",_addUnit(a))},height:function(a){var c=this;return a===undefined?c.length<1?0:c[0].offsetHeight:c.css("height",_addUnit(a))},opacity:function(a){return this.each(function(){this.style.opacity===undefined?this.style.filter=1==a?"":"alpha(opacity="+100*a+")":this.style.opacity=1==a?"":a}),this},data:function(a,c){var h=this;return a="kindeditor_data_"+a,c===undefined?h.length<1?null:h[0][a]:(this.each(function(){this[a]=c}),h)},pos:function(){var a=this,c=a[0],x=0,h=0;if(c)if(c.getBoundingClientRect){var g=c.getBoundingClientRect(),v=_getScrollPos(a.doc);x=g.left+v.x,h=g.top+v.y}else for(;c;)x+=c.offsetLeft,h+=c.offsetTop,c=c.offsetParent;return{x:_round(x),y:_round(h)}},clone:function(a){return new KNode(this.length<1?[]:this[0].cloneNode(a))},append:function(a){return this.each(function(){this.appendChild&&this.appendChild(_get(a))}),this},appendTo:function(a){return this.each(function(){_get(a).appendChild(this)}),this},before:function(a){return this.each(function(){this.parentNode.insertBefore(_get(a),this)}),this},after:function(a){return this.each(function(){this.nextSibling?this.parentNode.insertBefore(_get(a),this.nextSibling):this.parentNode.appendChild(_get(a))}),this},replaceWith:function(a){var c=[];return this.each(function(i,h){_unbind(h);var g=_get(a);h.parentNode.replaceChild(g,h),c.push(g)}),K(c)},empty:function(){var a=this;return a.each(function(i,a){for(var c=a.firstChild;c;){if(!a.parentNode)return;var h=c.nextSibling;c.parentNode.removeChild(c),c=h}}),a},remove:function(a){var c=this;return c.each(function(i,h){if(h.parentNode){if(_unbind(h),a)for(var g=h.firstChild;g;){var v=g.nextSibling;h.parentNode.insertBefore(g,h),g=v}h.parentNode.removeChild(h),delete c[i]}}),c.length=0,c},show:function(a){var c=this;return a===undefined&&(a=c._originDisplay||""),"none"!=c.css("display")?c:c.css("display",a)},hide:function(){var a=this;return a.length<1?a:(a._originDisplay=a[0].style.display,a.css("display","none"))},outer:function(){var a=this;if(a.length<1)return"";var c,h=a.doc.createElement("div");return h.appendChild(a[0].cloneNode(!0)),c=_formatHtml(h.innerHTML),h=null,c},isSingle:function(){return!!_SINGLE_TAG_MAP[this.name]},isInline:function(){return!!_INLINE_TAG_MAP[this.name]},isBlock:function(){return!!_BLOCK_TAG_MAP[this.name]},isStyle:function(){return!!_STYLE_TAG_MAP[this.name]},isControl:function(){return!!_CONTROL_TAG_MAP[this.name]},contains:function(a){return this.length<1?!1:_contains(this[0],_get(a))},parent:function(){if(this.length<1)return null;var a=this[0].parentNode;return a?new KNode(a):null},children:function(){if(this.length<1)return new KNode([]);for(var a=[],c=this[0].firstChild;c;)(3!=c.nodeType||""!==_trim(c.nodeValue))&&a.push(c),c=c.nextSibling;return new KNode(a)},first:function(){var a=this.children();return a.length>0?a.eq(0):null},last:function(){var a=this.children();return a.length>0?a.eq(a.length-1):null},index:function(){if(this.length<1)return-1;for(var i=-1,a=this[0];a;)i++,a=a.previousSibling;return i},prev:function(){if(this.length<1)return null;var a=this[0].previousSibling;return a?new KNode(a):null},next:function(){if(this.length<1)return null;var a=this[0].nextSibling;return a?new KNode(a):null},scan:function(a,c){function h(g){for(var n=c?g.firstChild:g.lastChild;n;){var v=c?n.nextSibling:n.previousSibling;if(a(n)===!1)return!1;if(h(n)===!1)return!1;n=v}}if(!(this.length<1))return c=c===undefined?!0:c,h(this[0]),this}}),_each("blur,focus,focusin,focusout,load,resize,scroll,unload,click,dblclick,mousedown,mouseup,mousemove,mouseover,mouseout,mouseenter,mouseleave,change,select,submit,keydown,keypress,keyup,error,contextmenu".split(","),function(i,a){KNode.prototype[a]=function(c){return c?this.bind(a,c):this.fire(a)}});var _K=K;K=function(a,c){function h(a){return a[0]||(a=[]),new KNode(a)}if(a!==undefined&&null!==a){if("string"==typeof a){c&&(c=_get(c));var g=a.length;if("@"===a.charAt(0)&&(a=a.substr(1)),a.length!==g||/<.+>/.test(a)){var v=c?c.ownerDocument||c:document,_=v.createElement("div"),b=[];_.innerHTML='<img id="__kindeditor_temp_tag__" width="0" height="0" style="display:none;" />'+a;for(var i=0,y=_.childNodes.length;y>i;i++){var k=_.childNodes[i];"__kindeditor_temp_tag__"!=k.id&&b.push(k)}return h(b)}return h(_queryAll(a,c))}return a&&a.constructor===KNode?a:(a.toArray&&(a=a.toArray()),h(_isArray(a)?a:_toArray(arguments)))}},_each(_K,function(a,c){K[a]=c}),K.NodeClass=KNode,window.KindEditor=K;var _START_TO_START=0,_START_TO_END=1,_END_TO_END=2,_END_TO_START=3,_BOOKMARK_ID=0;_extend(KRange,{init:function(a){var c=this;c.startContainer=a,c.startOffset=0,c.endContainer=a,c.endOffset=0,c.collapsed=!0,c.doc=a},commonAncestor:function(){function a(a){for(var c=[];a;)c.push(a),a=a.parentNode;return c}for(var c,h,g=a(this.startContainer),v=a(this.endContainer),i=0,_=g.length,b=v.length;++i&&(c=g[_-i],h=v[b-i],c&&h&&c===h););return g[_-i+1]},setStart:function(a,c){var h=this,g=h.doc;return h.startContainer=a,h.startOffset=c,h.endContainer===g&&(h.endContainer=a,h.endOffset=c),_updateCollapsed(this)},setEnd:function(a,c){var h=this,g=h.doc;return h.endContainer=a,h.endOffset=c,h.startContainer===g&&(h.startContainer=a,h.startOffset=c),_updateCollapsed(this)},setStartBefore:function(a){return this.setStart(a.parentNode||this.doc,K(a).index())},setStartAfter:function(a){return this.setStart(a.parentNode||this.doc,K(a).index()+1)},setEndBefore:function(a){return this.setEnd(a.parentNode||this.doc,K(a).index())},setEndAfter:function(a){return this.setEnd(a.parentNode||this.doc,K(a).index()+1)},selectNode:function(a){return this.setStartBefore(a).setEndAfter(a)},selectNodeContents:function(a){var c=K(a);if(3==c.type||c.isSingle())return this.selectNode(a);var h=c.children();return h.length>0?this.setStartBefore(h[0]).setEndAfter(h[h.length-1]):this.setStart(a,0).setEnd(a,0)},collapse:function(a){return a?this.setEnd(this.startContainer,this.startOffset):this.setStart(this.endContainer,this.endOffset)},compareBoundaryPoints:function(a,c){var h=this.get(),g=c.get();if(!_IERANGE)return h.compareBoundaryPoints(a,g);var v={};v[_START_TO_START]="StartToStart",v[_START_TO_END]="EndToStart",v[_END_TO_END]="EndToEnd",v[_END_TO_START]="StartToEnd";var _=h.compareEndPoints(v[a],g);if(0!==_)return _;var b,y,k,w,S;if((a===_START_TO_START||a===_END_TO_START)&&(b=this.startContainer,w=this.startOffset),(a===_START_TO_END||a===_END_TO_END)&&(b=this.endContainer,w=this.endOffset),(a===_START_TO_START||a===_START_TO_END)&&(y=c.startContainer,S=c.startOffset),(a===_END_TO_END||a===_END_TO_START)&&(y=c.endContainer,S=c.endOffset),b===y){var E=w-S;return E>0?1:0>E?-1:0}for(k=y;k&&k.parentNode!==b;)k=k.parentNode;if(k)return K(k).index()>=w?-1:1;for(k=b;k&&k.parentNode!==y;)k=k.parentNode;return k?K(k).index()>=S?1:-1:(k=K(y).next(),k&&k.contains(b)?1:(k=K(b).next(),k&&k.contains(y)?-1:void 0))},cloneRange:function(){return new KRange(this.doc).setStart(this.startContainer,this.startOffset).setEnd(this.endContainer,this.endOffset)},toString:function(){var a=this.get(),c=_IERANGE?a.text:a.toString();return c.replace(/\r\n|\n|\r/g,"")},cloneContents:function(){return _copyAndDelete(this,!0,!1)},deleteContents:function(){return _copyAndDelete(this,!1,!0)},extractContents:function(){return _copyAndDelete(this,!0,!0)},insertNode:function(a){var c,h,g,v=this,_=v.startContainer,b=v.startOffset,y=v.endContainer,k=v.endOffset,w=1;return"#document-fragment"===a.nodeName.toLowerCase()&&(c=a.firstChild,h=a.lastChild,w=a.childNodes.length),1==_.nodeType?(g=_.childNodes[b],g?(_.insertBefore(a,g),_===y&&(k+=w)):_.appendChild(a)):3==_.nodeType&&(0===b?(_.parentNode.insertBefore(a,_),_.parentNode===y&&(k+=w)):b>=_.nodeValue.length?_.nextSibling?_.parentNode.insertBefore(a,_.nextSibling):_.parentNode.appendChild(a):(g=b>0?_.splitText(b):_,_.parentNode.insertBefore(a,g),_===y&&(y=g,k-=b))),c?v.setStartBefore(c).setEndAfter(h):v.selectNode(a),v.compareBoundaryPoints(_END_TO_END,v.cloneRange().setEnd(y,k))>=1?v:v.setEnd(y,k)},surroundContents:function(a){return a.appendChild(this.extractContents()),this.insertNode(a).selectNode(a)},isControl:function(){var a=this,c=a.startContainer,h=a.startOffset,g=a.endContainer,v=a.endOffset;return 1==c.nodeType&&c===g&&h+1===v&&K(c.childNodes[h]).isControl()},get:function(a){var c,h=this,g=h.doc;if(!_IERANGE){c=g.createRange();try{c.setStart(h.startContainer,h.startOffset),c.setEnd(h.endContainer,h.endOffset)}catch(e){}return c}if(a&&h.isControl())return c=g.body.createControlRange(),c.addElement(h.startContainer.childNodes[h.startOffset]),c;var v=h.cloneRange().down();return c=g.body.createTextRange(),c.setEndPoint("StartToStart",_getEndRange(v.startContainer,v.startOffset)),c.setEndPoint("EndToStart",_getEndRange(v.endContainer,v.endOffset)),c},html:function(){return K(this.cloneContents()).outer()},down:function(){function a(a,h,g){if(1==a.nodeType){var v=K(a).children();if(0!==v.length){var _,b,y,k;h>0&&(_=v.eq(h-1)),h<v.length&&(b=v.eq(h)),_&&3==_.type&&(y=_[0],k=y.nodeValue.length),b&&3==b.type&&(y=b[0],k=0),y&&(g?c.setStart(y,k):c.setEnd(y,k))}}}var c=this;return a(c.startContainer,c.startOffset,!0),a(c.endContainer,c.endOffset,!1),c},up:function(){function a(a,h,g){3==a.nodeType&&(0===h?g?c.setStartBefore(a):c.setEndBefore(a):h==a.nodeValue.length&&(g?c.setStartAfter(a):c.setEndAfter(a)))}var c=this;return a(c.startContainer,c.startOffset,!0),a(c.endContainer,c.endOffset,!1),c},enlarge:function(a){function c(c,g,v){var _,b=K(c);if(!(3==b.type||_NOSPLIT_TAG_MAP[b.name]||!a&&b.isBlock()))if(0===g){for(;!b.prev()&&(_=b.parent(),_&&!_NOSPLIT_TAG_MAP[_.name]&&(a||!_.isBlock()));)b=_;v?h.setStartBefore(b[0]):h.setEndBefore(b[0])}else if(g==b.children().length){for(;!b.next()&&(_=b.parent(),_&&!_NOSPLIT_TAG_MAP[_.name]&&(a||!_.isBlock()));)b=_;v?h.setStartAfter(b[0]):h.setEndAfter(b[0])}}var h=this;return h.up(),c(h.startContainer,h.startOffset,!0),c(h.endContainer,h.endOffset,!1),h},shrink:function(){for(var a,c=this,h=c.collapsed;1==c.startContainer.nodeType&&(a=c.startContainer.childNodes[c.startOffset])&&1==a.nodeType&&!K(a).isSingle();)c.setStart(a,0);if(h)return c.collapse(h);for(;1==c.endContainer.nodeType&&c.endOffset>0&&(a=c.endContainer.childNodes[c.endOffset-1])&&1==a.nodeType&&!K(a).isSingle();)c.setEnd(a,a.childNodes.length);return c},createBookmark:function(a){var c,h=this,g=h.doc,v=K('<span style="display:none;"></span>',g)[0];return v.id="__kindeditor_bookmark_start_"+_BOOKMARK_ID++ +"__",h.collapsed||(c=v.cloneNode(!0),c.id="__kindeditor_bookmark_end_"+_BOOKMARK_ID++ +"__"),c&&h.cloneRange().collapse(!1).insertNode(c).setEndBefore(c),h.insertNode(v).setStartAfter(v),{start:a?"#"+v.id:v,end:c?a?"#"+c.id:c:null}},moveToBookmark:function(a){var c=this,h=c.doc,g=K(a.start,h),v=a.end?K(a.end,h):null;return!g||g.length<1?c:(c.setStartBefore(g[0]),g.remove(),v&&v.length>0?(c.setEndBefore(v[0]),v.remove()):c.collapse(!0),c)},dump:function(){}}),K.RangeClass=KRange,K.range=_range,K.START_TO_START=_START_TO_START,K.START_TO_END=_START_TO_END,K.END_TO_END=_END_TO_END,K.END_TO_START=_END_TO_START,_extend(KCmd,{init:function(a){var c=this,h=a.doc;c.doc=h,c.win=_getWin(h),c.sel=_getSel(h),c.range=a},selection:function(a){var c=this,h=c.doc,g=_getRng(h);return c.sel=_getSel(h),g?(c.range=_range(g),"html"==K(c.range.startContainer).name&&c.range.selectNodeContents(h.body).collapse(!1),c):(a&&c.range.selectNodeContents(h.body).collapse(!1),c)},select:function(a){a=_undef(a,!0);var c,h=this,g=h.sel,v=h.range.cloneRange().shrink(),_=v.startContainer,b=v.startOffset,y=(v.endContainer,v.endOffset,_getDoc(_)),k=h.win,w=!1;if(a&&1==_.nodeType&&v.collapsed){if(_IERANGE){var S=K("<span>&nbsp;</span>",y);v.insertNode(S[0]),c=y.body.createTextRange();try{c.moveToElementText(S[0])}catch(ex){}return c.collapse(!1),c.select(),S.remove(),k.focus(),h}if(_WEBKIT){var E=_.childNodes;(K(_).isInline()||b>0&&K(E[b-1]).isInline()||E[b]&&K(E[b]).isInline())&&(v.insertNode(y.createTextNode("â€‹")),w=!0)}}if(_IERANGE)try{c=v.get(!0),c.select()}catch(e){}else if(w&&v.collapse(!1),c=v.get(!0),g.removeAllRanges(),g.addRange(c),y!==document){var C=K(c.endContainer).pos();k.scrollTo(C.x,C.y)}return k.focus(),h},wrap:function(a){var c,h=this,g=h.doc,v=h.range;if(c=K(a,g),v.collapsed)return v.shrink(),v.insertNode(c[0]).selectNodeContents(c[0]),h;if(c.isBlock()){for(var _=c.clone(!0),b=_;b.first();)b=b.first();return b.append(v.extractContents()),v.insertNode(_[0]).selectNode(_[0]),h}v.enlarge();var y=v.createBookmark(),k=v.commonAncestor(),w=!1;return K(k).scan(function(a){if(!w&&a==y.start)return void(w=!0);if(w){if(a==y.end)return!1;var h=K(a);if(_inPreElement(h))return;if(3==h.type&&_trim(a.nodeValue).length>0){for(var g;(g=h.parent())&&g.isStyle()&&1==g.children().length;)h=g;_wrapNode(h,c)}}}),v.moveToBookmark(y),h},split:function(a,c){for(var h,g=this.range,v=g.doc,_=g.cloneRange().collapse(a),b=_.startContainer,y=_.startOffset,k=3==b.nodeType?b.parentNode:b,w=!1;k&&k.parentNode;){if(h=K(k),c){if(!h.isStyle())break;if(!_hasAttrOrCss(h,c))break}else if(_NOSPLIT_TAG_MAP[h.name])break;w=!0,k=k.parentNode}if(w){var S=v.createElement("span");g.cloneRange().collapse(!a).insertNode(S),a?_.setStartBefore(k.firstChild).setEnd(b,y):_.setStart(b,y).setEndAfter(k.lastChild);var E=_.extractContents(),C=E.firstChild,T=E.lastChild;a?(_.insertNode(E),g.setStartAfter(T).setEndBefore(S)):(k.appendChild(E),g.setStartBefore(S).setEndBefore(C));var U=S.parentNode;if(U==g.endContainer){var A=K(S).prev(),N=K(S).next();A&&N&&3==A.type&&3==N.type?g.setEnd(A[0],A[0].nodeValue.length):a||g.setEnd(g.endContainer,g.endOffset-1)}U.removeChild(S)}return this},remove:function(a){var c=this,h=c.doc,g=c.range;if(g.enlarge(),0===g.startOffset){for(var v,_=K(g.startContainer);(v=_.parent())&&v.isStyle()&&1==v.children().length;)_=v;g.setStart(_[0],0),_=K(g.startContainer),_.isBlock()&&_removeAttrOrCss(_,a);var b=_.parent();b&&b.isBlock()&&_removeAttrOrCss(b,a)}var y,k;if(g.collapsed){if(c.split(!0,a),y=g.startContainer,k=g.startOffset,k>0){var w=K(y.childNodes[k-1]);w&&_isEmptyNode(w)&&(w.remove(),g.setStart(y,k-1))}var S=K(y.childNodes[k]);return S&&_isEmptyNode(S)&&S.remove(),_isEmptyNode(y)&&(g.startBefore(y),y.remove()),g.collapse(!0),c}c.split(!0,a),c.split(!1,a);var E=h.createElement("span"),C=h.createElement("span");g.cloneRange().collapse(!1).insertNode(C),g.cloneRange().collapse(!0).insertNode(E);var T=[],U=!1;K(g.commonAncestor()).scan(function(a){return U||a!=E?a==C?!1:void(U&&T.push(a)):void(U=!0)}),K(E).remove(),K(C).remove(),y=g.startContainer,k=g.startOffset;var A=g.endContainer,N=g.endOffset;if(k>0){var I=K(y.childNodes[k-1]);I&&_isEmptyNode(I)&&(I.remove(),g.setStart(y,k-1),y==A&&g.setEnd(A,N-1));var F=K(y.childNodes[k]);F&&_isEmptyNode(F)&&(F.remove(),y==A&&g.setEnd(A,N-1))}var D=K(A.childNodes[g.endOffset]);D&&_isEmptyNode(D)&&D.remove();var R=g.createBookmark(!0);return _each(T,function(i,c){_removeAttrOrCss(K(c),a)}),g.moveToBookmark(R),c},commonNode:function(a){function c(c){for(var h=c,g=c;g;){if(_hasAttrOrCss(K(g),a))return K(g);g=g.parentNode}for(;h&&(h=h.lastChild);)if(_hasAttrOrCss(K(h),a))return K(h);return null}var h=this.range,g=h.endContainer,v=h.endOffset,_=3==g.nodeType||0===v?g:g.childNodes[v-1],b=c(_);if(b)return b;if(1==_.nodeType||3==g.nodeType&&0===v){var y=K(_).prev();if(y)return c(y)}return null},commonAncestor:function(a){function c(c){for(;c;){if(1==c.nodeType&&c.tagName.toLowerCase()===a)return c;c=c.parentNode}return null}var h=this.range,g=h.startContainer,v=h.startOffset,_=h.endContainer,b=h.endOffset,y=3==g.nodeType||0===v?g:g.childNodes[v-1],k=3==_.nodeType||0===b?_:_.childNodes[b-1],w=c(y),S=c(k);return w&&S&&w===S?K(w):null},state:function(a){var c=this,h=c.doc,g=!1;try{g=h.queryCommandState(a)}catch(e){}return g},val:function(a){function c(a){return a.toLowerCase()}{var h=this,g=h.doc;h.range}a=c(a);var v,_="";return"fontfamily"===a||"fontname"===a?(_=_nativeCommandValue(g,"fontname"),_=_.replace(/['"]/g,""),c(_)):"formatblock"===a?(_=_nativeCommandValue(g,a),""===_&&(v=h.commonNode({"h1,h2,h3,h4,h5,h6,p,div,pre,address":"*"}),v&&(_=v.name)),"Normal"===_&&(_="p"),c(_)):"fontsize"===a?(v=h.commonNode({"*":".font-size"}),v&&(_=v.css("font-size")),c(_)):"forecolor"===a?(v=h.commonNode({"*":".color"}),v&&(_=v.css("color")),_=_toHex(_),""===_&&(_="default"),c(_)):"hilitecolor"===a?(v=h.commonNode({"*":".background-color"}),v&&(_=v.css("background-color")),_=_toHex(_),""===_&&(_="default"),c(_)):_},toggle:function(a,c){var h=this;return h.commonNode(c)?h.remove(c):h.wrap(a),h.select()},bold:function(){return this.toggle("<strong></strong>",{span:".font-weight=bold",strong:"*",b:"*"})},italic:function(){return this.toggle("<em></em>",{span:".font-style=italic",em:"*",i:"*"})},underline:function(){return this.toggle("<u></u>",{span:".text-decoration=underline",u:"*"})},strikethrough:function(){return this.toggle("<s></s>",{span:".text-decoration=line-through",s:"*"})},forecolor:function(a){return this.wrap('<span style="color:'+a+';"></span>').select()},hilitecolor:function(a){return this.wrap('<span style="background-color:'+a+';"></span>').select()},fontsize:function(a){return this.wrap('<span style="font-size:'+a+';"></span>').select()},fontname:function(a){return this.fontfamily(a)},fontfamily:function(a){return this.wrap('<span style="font-family:'+a+';"></span>').select()},removeformat:function(){var a={"*":".font-weight,.font-style,.text-decoration,.color,.background-color,.font-size,.font-family,.text-indent"},c=_STYLE_TAG_MAP;return _each(c,function(c){a[c]="*"}),this.remove(a),this.select()},inserthtml:function(a,c){function h(a,c){c='<img id="__kindeditor_temp_tag__" width="0" height="0" style="display:none;" />'+c;var h=a.get();h.item?h.item(0).outerHTML=c:h.pasteHTML(c);var g=a.doc.getElementById("__kindeditor_temp_tag__");g.parentNode.removeChild(g);var _=_toRange(h);a.setEnd(_.endContainer,_.endOffset),a.collapse(!1),v.select(!1)}function g(a,c){var h=a.doc,g=h.createDocumentFragment();K("@"+c,h).each(function(){g.appendChild(this)}),a.deleteContents(),a.insertNode(g),a.collapse(!1),v.select(!1)}var v=this,_=v.range;if(""===a)return v;if(_IERANGE&&c){try{h(_,a)}catch(e){g(_,a)}return v}return g(_,a),v},hr:function(){return this.inserthtml("<hr />")},print:function(){return this.win.print(),this},insertimage:function(a,c,h,g,v,_){c=_undef(c,""),v=_undef(v,0);var b='<img src="'+_escape(a)+'" data-ke-src="'+_escape(a)+'" ';return h&&(b+='width="'+_escape(h)+'" '),g&&(b+='height="'+_escape(g)+'" '),c&&(b+='title="'+_escape(c)+'" '),_&&(b+='align="'+_escape(_)+'" '),b+='alt="'+_escape(c)+'" ',b+="/>",this.inserthtml(b)},createlink:function(a,c){function h(a,c,h){K(a).attr("href",c).attr("data-ke-src",c),h?K(a).attr("target",h):K(a).removeAttr("target")}var g=this,v=g.doc,_=g.range;g.select();var b=g.commonNode({a:"*"});b&&!_.isControl()&&(_.selectNode(b.get()),g.select());var y='<a href="'+_escape(a)+'" data-ke-src="'+_escape(a)+'" ';if(c&&(y+=' target="'+_escape(c)+'"'),_.collapsed)return y+=">"+_escape(a)+"</a>",g.inserthtml(y);if(_.isControl()){var k=K(_.startContainer.childNodes[_.startOffset]);return y+="></a>",k.after(K(y,v)),k.next().append(k),_.selectNode(k[0]),g.select()}var w=_.startContainer,S=_.startOffset,E=_.endContainer,C=_.endOffset;if(1==w.nodeType&&w===E&&S+1===C){var T=w.childNodes[S];if("a"==T.nodeName.toLowerCase())return h(T,a,c),g}return _nativeCommand(v,"createlink","__kindeditor_temp_url__"),K('a[href="__kindeditor_temp_url__"]',v).each(function(){h(this,a,c)}),g},unlink:function(){var a=this,c=a.doc,h=a.range;if(a.select(),h.collapsed){var g=a.commonNode({a:"*"});if(g&&(h.selectNode(g.get()),a.select()),_nativeCommand(c,"unlink",null),_WEBKIT&&"img"===K(h.startContainer).name){var v=K(h.startContainer).parent();
"a"===v.name&&v.remove(!0)}}else _nativeCommand(c,"unlink",null);return a}}),_each("formatblock,selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,indent,outdent,subscript,superscript".split(","),function(i,a){KCmd.prototype[a]=function(c){var h=this;return h.select(),_nativeCommand(h.doc,a,c),_IERANGE&&_inArray(a,"justifyleft,justifycenter,justifyright,justifyfull".split(","))>=0&&h.selection(),(!_IERANGE||_inArray(a,"formatblock,selectall,insertorderedlist,insertunorderedlist".split(","))>=0)&&h.selection(),h}}),_each("cut,copy,paste".split(","),function(i,a){KCmd.prototype[a]=function(){var c=this;if(!c.doc.queryCommandSupported(a))throw"not supported";return c.select(),_nativeCommand(c.doc,a,null),c}}),K.CmdClass=KCmd,K.cmd=_cmd,_extend(KWidget,{init:function(a){var c=this;if(c.name=a.name||"",c.doc=a.doc||document,c.win=_getWin(c.doc),c.x=_addUnit(a.x),c.y=_addUnit(a.y),c.z=a.z,c.width=_addUnit(a.width),c.height=_addUnit(a.height),c.div=K('<div style="display:block;"></div>'),c.options=a,c._alignEl=a.alignEl,c.width&&c.div.css("width",c.width),c.height&&c.div.css("height",c.height),c.z&&c.div.css({position:"absolute",left:c.x,top:c.y,"z-index":c.z}),!c.z||c.x!==undefined&&c.y!==undefined||c.autoPos(c.width,c.height),a.cls&&c.div.addClass(a.cls),a.shadowMode&&c.div.addClass("ke-shadow"),a.css&&c.div.css(a.css),a.src?K(a.src).replaceWith(c.div):K(c.doc.body).append(c.div),a.html&&c.div.html(a.html),a.autoScroll)if(_IE&&7>_V||_QUIRKS){var h=_getScrollPos();K(c.win).bind("scroll",function(){var a=_getScrollPos(),g=a.x-h.x,v=a.y-h.y;c.pos(_removeUnit(c.x)+g,_removeUnit(c.y)+v,!1)})}else c.div.css("position","fixed")},pos:function(x,a,c){var h=this;return c=_undef(c,!0),null!==x&&(x=0>x?0:_addUnit(x),h.div.css("left",x),c&&(h.x=x)),null!==a&&(a=0>a?0:_addUnit(a),h.div.css("top",a),c&&(h.y=a)),h},autoPos:function(a,c){var h=this,g=_removeUnit(a)||0,v=_removeUnit(c)||0,_=_getScrollPos();if(h._alignEl){var b=K(h._alignEl),k=b.pos(),w=_round(b[0].clientWidth/2-g/2),S=_round(b[0].clientHeight/2-v/2);x=0>w?k.x:k.x+w,y=0>S?k.y:k.y+S}else{var E=_docElement(h.doc);x=_round(_.x+(E.clientWidth-g)/2),y=_round(_.y+(E.clientHeight-v)/2)}return _IE&&7>_V||_QUIRKS||(x-=_.x,y-=_.y),h.pos(x,y)},remove:function(){var a=this;return(_IE&&7>_V||_QUIRKS)&&K(a.win).unbind("scroll"),a.div.remove(),_each(a,function(i){a[i]=null}),this},show:function(){return this.div.show(),this},hide:function(){return this.div.hide(),this},draggable:function(a){var c=this;return a=a||{},a.moveEl=c.div,a.moveFn=function(x,a,h,g,v,_){(x+=v)<0&&(x=0),(a+=_)<0&&(a=0),c.pos(x,a)},_drag(a),c}}),K.WidgetClass=KWidget,K.widget=_widget;var html,_direction="";(html=document.getElementsByTagName("html"))&&(_direction=html[0].dir),_extend(KEdit,KWidget,{init:function(a){function c(){var c=_iframeDoc(h.iframe);c.open(),y&&(c.domain=document.domain),c.write(_getInitHtml(g,v,_,b)),c.close(),h.win=h.iframe[0].contentWindow,h.doc=c;var k=_cmd(c);h.afterChange(function(){k.selection()}),_WEBKIT&&K(c).click(function(e){"img"===K(e.target).name&&(k.selection(!0),k.range.selectNode(e.target),k.select())}),_IE&&(h._mousedownHandler=function(){var a=k.range.cloneRange();a.shrink(),a.isControl()&&h.blur()},K(document).mousedown(h._mousedownHandler),K(c).keydown(function(e){if(8==e.which){k.selection();var a=k.range;a.isControl()&&(a.collapse(!0),K(a.startContainer.childNodes[a.startOffset]).remove(),e.preventDefault())}})),h.cmd=k,h.html(_elementVal(h.srcElement)),_IE?(c.body.disabled=!0,c.body.contentEditable=!0,c.body.removeAttribute("disabled")):c.designMode="on",a.afterCreate&&a.afterCreate.call(h)}var h=this;KEdit.parent.init.call(h,a),h.srcElement=K(a.srcElement),h.div.addClass("ke-edit"),h.designMode=_undef(a.designMode,!0),h.beforeGetHtml=a.beforeGetHtml,h.beforeSetHtml=a.beforeSetHtml,h.afterSetHtml=a.afterSetHtml;var g=_undef(a.themesPath,""),v=a.bodyClass,_=a.cssPath,b=a.cssData,y="res:"!=location.protocol&&location.host.replace(/:\d+/,"")!==document.domain,k="document.open();"+(y?'document.domain="'+document.domain+'";':"")+"document.close();",w=_IE?' src="javascript:void(function(){'+encodeURIComponent(k)+'}())"':"";h.iframe=K('<iframe class="ke-edit-iframe" hidefocus="true" frameborder="0"'+w+"></iframe>").css("width","100%"),h.textarea=K('<textarea class="ke-edit-textarea" hidefocus="true"></textarea>').css("width","100%"),h.tabIndex=isNaN(parseInt(a.tabIndex,10))?h.srcElement.attr("tabindex"):parseInt(a.tabIndex,10),h.iframe.attr("tabindex",h.tabIndex),h.textarea.attr("tabindex",h.tabIndex),h.width&&h.setWidth(h.width),h.height&&h.setHeight(h.height),h.designMode?h.textarea.hide():h.iframe.hide(),y&&h.iframe.bind("load",function(){h.iframe.unbind("load"),_IE?c():setTimeout(c,0)}),h.div.append(h.iframe),h.div.append(h.textarea),h.srcElement.hide(),!y&&c()},setWidth:function(a){var c=this;return a=_addUnit(a),c.width=a,c.div.css("width",a),c},setHeight:function(a){var c=this;return a=_addUnit(a),c.height=a,c.div.css("height",a),c.iframe.css("height",a),(_IE&&8>_V||_QUIRKS)&&(a=_addUnit(_removeUnit(a)-2)),c.textarea.css("height",a),c},remove:function(){var a=this,c=a.doc;K(c.body).unbind(),K(c).unbind(),K(a.win).unbind(),a._mousedownHandler&&K(document).unbind("mousedown",a._mousedownHandler),_elementVal(a.srcElement,a.html()),a.srcElement.show(),c.write(""),a.iframe.unbind(),a.textarea.unbind(),KEdit.parent.remove.call(a)},html:function(a,c){var h=this,g=h.doc;if(h.designMode){var v=g.body;return a===undefined?(a=c?"<!doctype html><html>"+v.parentNode.innerHTML+"</html>":v.innerHTML,h.beforeGetHtml&&(a=h.beforeGetHtml(a)),_GECKO&&"<br />"==a&&(a=""),a):(h.beforeSetHtml&&(a=h.beforeSetHtml(a)),_IE&&_V>=9&&(a=a.replace(/(<.*?checked=")checked(".*>)/gi,"$1$2")),K(v).html(a),h.afterSetHtml&&h.afterSetHtml(),h)}return a===undefined?h.textarea.val():(h.textarea.val(a),h)},design:function(a){var c,h=this;return(a===undefined?!h.designMode:a)?h.designMode||(c=h.html(),h.designMode=!0,h.html(c),h.textarea.hide(),h.iframe.show()):h.designMode&&(c=h.html(),h.designMode=!1,h.html(c),h.iframe.hide(),h.textarea.show()),h.focus()},focus:function(){var a=this;return a.designMode?a.win.focus():a.textarea[0].focus(),a},blur:function(){var a=this;if(_IE){var c=K('<input type="text" style="float:left;width:0;height:0;padding:0;margin:0;border:0;" value="" />',a.div);a.div.append(c),c[0].focus(),c.remove()}else a.designMode?a.win.blur():a.textarea[0].blur();return a},afterChange:function(a){function c(e){setTimeout(function(){a(e)},1)}var h=this,g=h.doc,v=g.body;return K(g).keyup(function(e){e.ctrlKey||e.altKey||!_CHANGE_KEY_MAP[e.which]||a(e)}),K(g).mouseup(a).contextmenu(a),K(h.win).blur(a),K(v).bind("paste",c),K(v).bind("cut",c),h}}),K.EditClass=KEdit,K.edit=_edit,K.iframeDoc=_iframeDoc,_extend(KToolbar,KWidget,{init:function(a){function c(a){var c=K(a);return c.hasClass("ke-outline")?c:c.hasClass("ke-toolbar-icon")?c.parent():void 0}function h(e,a){var h=c(e.target);if(h){if(h.hasClass("ke-disabled"))return;if(h.hasClass("ke-selected"))return;h[a]("ke-on")}}var g=this;KToolbar.parent.init.call(g,a),g.disableMode=_undef(a.disableMode,!1),g.noDisableItemMap=_toMap(_undef(a.noDisableItems,[])),g._itemMap={},g.div.addClass("ke-toolbar").bind("contextmenu,mousedown,mousemove",function(e){e.preventDefault()}).attr("unselectable","on"),g.div.mouseover(function(e){h(e,"addClass")}).mouseout(function(e){h(e,"removeClass")}).click(function(e){var a=c(e.target);if(a){if(a.hasClass("ke-disabled"))return;g.options.click.call(this,e,a.attr("data-name"))}})},get:function(a){return this._itemMap[a]?this._itemMap[a]:this._itemMap[a]=K("span.ke-icon-"+a,this.div).parent()},select:function(a){return _selectToolbar.call(this,a,function(a){a.addClass("ke-selected")}),self},unselect:function(a){return _selectToolbar.call(this,a,function(a){a.removeClass("ke-selected").removeClass("ke-on")}),self},enable:function(a){var c=this,h=a.get?a:c.get(a);return h&&(h.removeClass("ke-disabled"),h.opacity(1)),c},disable:function(a){var c=this,h=a.get?a:c.get(a);return h&&(h.removeClass("ke-selected").addClass("ke-disabled"),h.opacity(.5)),c},disableAll:function(a,c){var h=this,g=h.noDisableItemMap;return c&&(g=_toMap(c)),(a===undefined?!h.disableMode:a)?(K("span.ke-outline",h.div).each(function(){var a=K(this),c=a[0].getAttribute("data-name",2);g[c]||h.disable(a)}),h.disableMode=!0):(K("span.ke-outline",h.div).each(function(){var a=K(this),c=a[0].getAttribute("data-name",2);g[c]||h.enable(a)}),h.disableMode=!1),h}}),K.ToolbarClass=KToolbar,K.toolbar=_toolbar,_extend(KMenu,KWidget,{init:function(a){var c=this;a.z=a.z||811213,KMenu.parent.init.call(c,a),c.centerLineMode=_undef(a.centerLineMode,!0),c.div.addClass("ke-menu").bind("click,mousedown",function(e){e.stopPropagation()}).attr("unselectable","on")},addItem:function(a){var c=this;if("-"===a.title)return void c.div.append(K('<div class="ke-menu-separator"></div>'));var h=K('<div class="ke-menu-item" unselectable="on"></div>'),g=K('<div class="ke-inline-block ke-menu-item-left"></div>'),v=K('<div class="ke-inline-block ke-menu-item-right"></div>'),_=_addUnit(a.height),b=_undef(a.iconClass,"");c.div.append(h),_&&(h.css("height",_),v.css("line-height",_));var y;return c.centerLineMode&&(y=K('<div class="ke-inline-block ke-menu-item-center"></div>'),_&&y.css("height",_)),h.mouseover(function(){K(this).addClass("ke-menu-item-on"),y&&y.addClass("ke-menu-item-center-on")}).mouseout(function(){K(this).removeClass("ke-menu-item-on"),y&&y.removeClass("ke-menu-item-center-on")}).click(function(e){a.click.call(K(this)),e.stopPropagation()}).append(g),y&&h.append(y),h.append(v),a.checked&&(b="ke-icon-checked"),""!==b&&g.html('<span class="ke-inline-block ke-toolbar-icon ke-toolbar-icon-url '+b+'"></span>'),v.html(a.title),c},remove:function(){var a=this;return a.options.beforeRemove&&a.options.beforeRemove.call(a),K(".ke-menu-item",a.div[0]).unbind(),KMenu.parent.remove.call(a),a}}),K.MenuClass=KMenu,K.menu=_menu,_extend(KColorPicker,KWidget,{init:function(a){var c=this;a.z=a.z||811213,KColorPicker.parent.init.call(c,a);var h=a.colors||[["#E53333","#E56600","#FF9900","#64451D","#DFC5A4","#FFE500"],["#009900","#006600","#99BB00","#B8D100","#60D978","#00D5FF"],["#337FE5","#003399","#4C33E5","#9933E5","#CC33E5","#EE33EE"],["#FFFFFF","#CCCCCC","#999999","#666666","#333333","#000000"]];c.selectedColor=(a.selectedColor||"").toLowerCase(),c._cells=[],c.div.addClass("ke-colorpicker").bind("click,mousedown",function(e){e.stopPropagation()}).attr("unselectable","on");var g=c.doc.createElement("table");c.div.append(g),g.className="ke-colorpicker-table",g.cellPadding=0,g.cellSpacing=0,g.border=0;var v=g.insertRow(0),_=v.insertCell(0);_.colSpan=h[0].length,c._addAttr(_,"","ke-colorpicker-cell-top");for(var i=0;i<h.length;i++){v=g.insertRow(i+1);for(var b=0;b<h[i].length;b++)_=v.insertCell(b),c._addAttr(_,h[i][b],"ke-colorpicker-cell")}},_addAttr:function(a,c,h){var g=this;a=K(a).addClass(h),g.selectedColor===c.toLowerCase()&&a.addClass("ke-colorpicker-cell-selected"),a.attr("title",c||g.options.noColor),a.mouseover(function(){K(this).addClass("ke-colorpicker-cell-on")}),a.mouseout(function(){K(this).removeClass("ke-colorpicker-cell-on")}),a.click(function(e){e.stop(),g.options.click.call(K(this),c)}),c?a.append(K('<div class="ke-colorpicker-cell-color" unselectable="on"></div>').css("background-color",c)):a.html(g.options.noColor),K(a).attr("unselectable","on"),g._cells.push(a)},remove:function(){var a=this;return _each(a._cells,function(){this.unbind()}),KColorPicker.parent.remove.call(a),a}}),K.ColorPickerClass=KColorPicker,K.colorpicker=_colorpicker,_extend(KUploadButton,{init:function(a){var c=this,h=K(a.button),g=a.fieldName||"file",v=a.url||"",_=h.val(),b=a.extraParams||{},y=h[0].className||"",k=a.target||"kindeditor_upload_iframe_"+(new Date).getTime();a.afterError=a.afterError||function(a){alert(a)};var w=[];for(var S in b)w.push('<input type="hidden" name="'+S+'" value="'+b[S]+'" />');var E=['<div class="ke-inline-block '+y+'">',a.target?"":'<iframe name="'+k+'" style="display:none;"></iframe>',a.form?'<div class="ke-upload-area">':'<form class="ke-upload-area ke-form" method="post" enctype="multipart/form-data" target="'+k+'" action="'+v+'">','<span class="ke-button-common">',w.join(""),'<input type="button" class="ke-button-common ke-button" value="'+_+'" />',"</span>",'<input type="file" class="ke-upload-file" name="'+g+'" tabindex="-1" />',a.form?"</div>":"</form>","</div>"].join(""),C=K(E,h.doc);h.hide(),h.before(C),c.div=C,c.button=h,c.iframe=a.target?K('iframe[name="'+k+'"]'):K("iframe",C),c.form=a.form?K(a.form):K("form",C),c.fileBox=K(".ke-upload-file",C);var T=a.width||K(".ke-button-common",C).width();K(".ke-upload-area",C).width(T),c.options=a},submit:function(){var a=this,c=a.iframe;return c.bind("load",function(){c.unbind();var h=document.createElement("form");a.fileBox.before(h),K(h).append(a.fileBox),h.reset(),K(h).remove(!0);var g,v=K.iframeDoc(c),_=v.getElementsByTagName("pre")[0],b="";b=_?_.innerHTML:v.body.innerHTML,b=_unescape(b),c[0].src="javascript:false";try{g=K.json(b)}catch(e){a.options.afterError.call(a,"<!doctype html><html>"+v.body.parentNode.innerHTML+"</html>")}g&&a.options.afterUpload.call(a,g)}),a.form[0].submit(),a},remove:function(){var a=this;return a.fileBox&&a.fileBox.unbind(),a.iframe.remove(),a.div.remove(),a.button.show(),a}}),K.UploadButtonClass=KUploadButton,K.uploadbutton=_uploadbutton,_extend(KDialog,KWidget,{init:function(a){var c=this,h=_undef(a.shadowMode,!0);a.z=a.z||811213,a.shadowMode=!1,a.autoScroll=_undef(a.autoScroll,!0),KDialog.parent.init.call(c,a);var g=a.title,v=K(a.body,c.doc),_=a.previewBtn,b=a.yesBtn,y=a.noBtn,k=a.closeBtn,w=_undef(a.showMask,!0);c.div.addClass("ke-dialog").bind("click,mousedown",function(e){e.stopPropagation()});var S=K('<div class="ke-dialog-content"></div>').appendTo(c.div);_IE&&7>_V?c.iframeMask=K('<iframe src="about:blank" class="ke-dialog-shadow"></iframe>').appendTo(c.div):h&&K('<div class="ke-dialog-shadow"></div>').appendTo(c.div);var E=K('<div class="ke-dialog-header"></div>');S.append(E),E.html(g),c.closeIcon=K('<span class="ke-dialog-icon-close" title="'+k.name+'"></span>').click(k.click),E.append(c.closeIcon),c.draggable({clickEl:E,beforeDrag:a.beforeDrag});var C=K('<div class="ke-dialog-body"></div>');S.append(C),C.append(v);var T=K('<div class="ke-dialog-footer"></div>');if((_||b||y)&&S.append(T),_each([{btn:_,name:"preview"},{btn:b,name:"yes"},{btn:y,name:"no"}],function(){if(this.btn){var a=_createButton(this.btn);a.addClass("ke-dialog-"+this.name),T.append(a)}}),c.height&&C.height(_removeUnit(c.height)-E.height()-T.height()),c.div.width(c.div.width()),c.div.height(c.div.height()),c.mask=null,w){var U=_docElement(c.doc),A=Math.max(U.scrollWidth,U.clientWidth),N=Math.max(U.scrollHeight,U.clientHeight);c.mask=_widget({x:0,y:0,z:c.z-1,cls:"ke-dialog-mask",width:A,height:N})}c.autoPos(c.div.width(),c.div.height()),c.footerDiv=T,c.bodyDiv=C,c.headerDiv=E,c.isLoading=!1},setMaskIndex:function(a){var c=this;c.mask.div.css("z-index",a)},showLoading:function(a){a=_undef(a,"");var c=this,h=c.bodyDiv;return c.loading=K('<div class="ke-dialog-loading"><div class="ke-inline-block ke-dialog-loading-content" style="margin-top:'+Math.round(h.height()/3)+'px;">'+a+"</div></div>").width(h.width()).height(h.height()).css("top",c.headerDiv.height()+"px"),h.css("visibility","hidden").after(c.loading),c.isLoading=!0,c},hideLoading:function(){return this.loading&&this.loading.remove(),this.bodyDiv.css("visibility","visible"),this.isLoading=!1,this},remove:function(){var a=this;return a.options.beforeRemove&&a.options.beforeRemove.call(a),a.mask&&a.mask.remove(),a.iframeMask&&a.iframeMask.remove(),a.closeIcon.unbind(),K("input",a.div).unbind(),K("button",a.div).unbind(),a.footerDiv.unbind(),a.bodyDiv.unbind(),a.headerDiv.unbind(),K("iframe",a.div).each(function(){K(this).remove()}),KDialog.parent.remove.call(a),a}}),K.DialogClass=KDialog,K.dialog=_dialog,K.tabs=_tabs,K.loadScript=_loadScript,K.loadStyle=_loadStyle,K.ajax=_ajax;var _plugins={},_language={};KEditor.prototype={lang:function(a){return _lang(a,this.langType)},loadPlugin:function(a,c){var h=this;return _plugins[a]?_isFunction(_plugins[a])?(_plugins[a].call(h,KindEditor),c&&c.call(h),h):(setTimeout(function(){h.loadPlugin(a,c)},100),h):(_plugins[a]="loading",_loadScript(h.pluginsPath+a+"/"+a+".js?ver="+encodeURIComponent(K.DEBUG?_TIME:_VERSION),function(){setTimeout(function(){_plugins[a]&&h.loadPlugin(a,c)},0)}),h)},handler:function(a,c){var h=this;return h._handlers[a]||(h._handlers[a]=[]),_isFunction(c)?(h._handlers[a].push(c),h):(_each(h._handlers[a],function(){c=this.call(h,c)}),c)},clickToolbar:function(a,c){var h=this,g="clickToolbar"+a;return c===undefined?h._handlers[g]?h.handler(g):(h.loadPlugin(a,function(){h.handler(g)}),h):h.handler(g,c)},updateState:function(){var a=this;return _each("justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,subscript,superscript,bold,italic,underline,strikethrough".split(","),function(i,c){a.cmd.state(c)?a.toolbar.select(c):a.toolbar.unselect(c)}),a},addContextmenu:function(a){return this._contextmenus.push(a),this},afterCreate:function(a){return this.handler("afterCreate",a)},beforeRemove:function(a){return this.handler("beforeRemove",a)},beforeGetHtml:function(a){return this.handler("beforeGetHtml",a)},beforeSetHtml:function(a){return this.handler("beforeSetHtml",a)},afterSetHtml:function(a){return this.handler("afterSetHtml",a)},create:function(){function a(){return 0===k.height()?void setTimeout(a,100):void c.resize(g,v,!1)}var c=this,h=c.fullscreenMode;if(c.isCreated)return c;if(c.srcElement.data("kindeditor"))return c;c.srcElement.data("kindeditor","true"),_docElement().style.overflow=h?"hidden":"";var g=h?_docElement().clientWidth+"px":c.width,v=h?_docElement().clientHeight+"px":c.height;(_IE&&8>_V||_QUIRKS)&&(v=_addUnit(_removeUnit(v)+2));var _=c.container=K(c.layout);h?K(document.body).append(_):c.srcElement.before(_);var b=K(".toolbar",_),y=K(".edit",_),k=c.statusbar=K(".statusbar",_);_.removeClass("container").addClass("ke-container ke-container-"+c.themeType).css("width",g),h?(_.css({position:"absolute",left:0,top:0,"z-index":811211}),_GECKO||(c._scrollPos=_getScrollPos()),window.scrollTo(0,0),K(document.body).css({height:"1px",overflow:"hidden"}),K(document.body.parentNode).css("overflow","hidden"),c._fullscreenExecuted=!0):(c._fullscreenExecuted&&(K(document.body).css({height:"",overflow:""}),K(document.body.parentNode).css("overflow","")),c._scrollPos&&window.scrollTo(c._scrollPos.x,c._scrollPos.y));var w=[];K.each(c.items,function(i,a){"|"==a?w.push('<span class="ke-inline-block ke-separator"></span>'):"/"==a?w.push('<div class="ke-hr"></div>'):(w.push('<span class="ke-outline" data-name="'+a+'" title="'+c.lang(a)+'" unselectable="on">'),w.push('<span class="ke-toolbar-icon ke-toolbar-icon-url ke-icon-'+a+'" unselectable="on"></span></span>'))});var S=c.toolbar=_toolbar({src:b,html:w.join(""),noDisableItems:c.noDisableItems,click:function(e,a){if(e.stop(),c.menu){var h=c.menu.name;if(c.hideMenu(),h===a)return}c.clickToolbar(a)}}),E=_removeUnit(v)-S.div.height(),C=c.edit=_edit({height:E>0&&_removeUnit(v)>c.minHeight?E:c.minHeight,src:y,srcElement:c.srcElement,designMode:c.designMode,themesPath:c.themesPath,bodyClass:c.bodyClass,cssPath:c.cssPath,cssData:c.cssData,beforeGetHtml:function(a){return a=c.beforeGetHtml(a),a=_removeBookmarkTag(_removeTempTag(a)),_formatHtml(a,c.filterMode?c.htmlTags:null,c.urlType,c.wellFormatMode,c.indentChar)},beforeSetHtml:function(a){return a=_formatHtml(a,c.filterMode?c.htmlTags:null,"",!1),c.beforeSetHtml(a)},afterSetHtml:function(){c.edit=C=this,c.afterSetHtml()},afterCreate:function(){if(c.edit=C=this,c.cmd=C.cmd,c._docMousedownFn=function(){c.menu&&c.hideMenu()},K(C.doc,document).mousedown(c._docMousedownFn),_bindContextmenuEvent.call(c),_bindNewlineEvent.call(c),_bindTabEvent.call(c),_bindFocusEvent.call(c),C.afterChange(function(){C.designMode&&(c.updateState(),c.addBookmark(),c.options.afterChange&&c.options.afterChange.call(c))}),C.textarea.keyup(function(e){e.ctrlKey||e.altKey||!_INPUT_KEY_MAP[e.which]||c.options.afterChange&&c.options.afterChange.call(c)}),c.readonlyMode&&c.readonly(),c.isCreated=!0,""===c.initContent&&(c.initContent=c.html()),c._undoStack.length>0){var a=c._undoStack.pop();a.start&&(c.html(a.html),C.cmd.range.moveToBookmark(a),c.select())}c.afterCreate(),c.options.afterCreate&&c.options.afterCreate.call(c)}});return k.removeClass("statusbar").addClass("ke-statusbar").append('<span class="ke-inline-block ke-statusbar-center-icon"></span>').append('<span class="ke-inline-block ke-statusbar-right-icon"></span>'),c._fullscreenResizeHandler&&(K(window).unbind("resize",c._fullscreenResizeHandler),c._fullscreenResizeHandler=null),a(),h?(c._fullscreenResizeHandler=function(){c.isCreated&&c.resize(_docElement().clientWidth,_docElement().clientHeight,!1)},K(window).bind("resize",c._fullscreenResizeHandler),S.select("fullscreen"),k.first().css("visibility","hidden"),k.last().css("visibility","hidden")):(_GECKO&&K(window).bind("scroll",function(){c._scrollPos=_getScrollPos()}),c.resizeType>0?_drag({moveEl:_,clickEl:k,moveFn:function(x,a,h,g,v,_){g+=_,c.resize(null,g)}}):k.first().css("visibility","hidden"),2===c.resizeType?_drag({moveEl:_,clickEl:k.last(),moveFn:function(x,a,h,g,v,_){h+=v,g+=_,c.resize(h,g)}}):k.last().css("visibility","hidden")),c},remove:function(){var a=this;return a.isCreated?(a.beforeRemove(),a.srcElement.data("kindeditor",""),a.menu&&a.hideMenu(),_each(a.dialogs,function(){a.hideDialog()}),K(document).unbind("mousedown",a._docMousedownFn),a.toolbar.remove(),a.edit.remove(),a.statusbar.last().unbind(),a.statusbar.unbind(),a.container.remove(),a.container=a.toolbar=a.edit=a.menu=null,a.dialogs=[],a.isCreated=!1,a):a},resize:function(a,c,h){var g=this;return h=_undef(h,!0),a&&(/%/.test(a)||(a=_removeUnit(a),a=a<g.minWidth?g.minWidth:a),g.container.css("width",_addUnit(a)),h&&(g.width=_addUnit(a))),c&&(c=_removeUnit(c),editHeight=_removeUnit(c)-g.toolbar.div.height()-g.statusbar.height(),editHeight=editHeight<g.minHeight?g.minHeight:editHeight,g.edit.setHeight(editHeight),h&&(g.height=_addUnit(c))),g},select:function(){return this.isCreated&&this.cmd.select(),this},html:function(a){var c=this;return a===undefined?c.isCreated?c.edit.html():_elementVal(c.srcElement):(c.isCreated?c.edit.html(a):_elementVal(c.srcElement,a),c.isCreated&&c.cmd.selection(),c)},fullHtml:function(){return this.isCreated?this.edit.html(undefined,!0):""},text:function(a){var c=this;return a===undefined?_trim(c.html().replace(/<(?!img|embed).*?>/gi,"").replace(/&nbsp;/gi," ")):c.html(_escape(a))},isEmpty:function(){return""===_trim(this.text().replace(/\r\n|\n|\r/,""))},isDirty:function(){return _trim(this.initContent.replace(/\r\n|\n|\r|t/g,""))!==_trim(this.html().replace(/\r\n|\n|\r|t/g,""))},selectedHtml:function(){var a=this.isCreated?this.cmd.range.html():"";return a=_removeBookmarkTag(_removeTempTag(a))},count:function(a){var c=this;return a=(a||"html").toLowerCase(),"html"===a?c.html().length:"text"===a?c.text().replace(/<(?:img|embed).*?>/gi,"K").replace(/\r\n|\n|\r/g,"").length:0},exec:function(a){a=a.toLowerCase();var c=this,h=c.cmd,g=_inArray(a,"selectall,copy,paste,print".split(","))<0;return g&&c.addBookmark(!1),h[a].apply(h,_toArray(arguments,1)),g&&(c.updateState(),c.addBookmark(!1),c.options.afterChange&&c.options.afterChange.call(c)),c},insertHtml:function(a,c){return this.isCreated?(a=this.beforeSetHtml(a),this.exec("inserthtml",a,c),this):this},appendHtml:function(a){if(this.html(this.html()+a),this.isCreated){var c=this.cmd;c.range.selectNodeContents(c.doc.body).collapse(!1),c.select()}return this},sync:function(){return _elementVal(this.srcElement,this.html()),this},focus:function(){return this.isCreated?this.edit.focus():this.srcElement[0].focus(),this},blur:function(){return this.isCreated?this.edit.blur():this.srcElement[0].blur(),this},addBookmark:function(a){a=_undef(a,!0);var c,h=this,g=h.edit,v=g.doc.body,_=_removeTempTag(v.innerHTML);if(a&&h._undoStack.length>0){var b=h._undoStack[h._undoStack.length-1];if(Math.abs(_.length-_removeBookmarkTag(b.html).length)<h.minChangeSize)return h}if(g.designMode&&!h._firstAddBookmark){var y=h.cmd.range;c=y.createBookmark(!0),c.html=_removeTempTag(v.innerHTML),y.moveToBookmark(c)}else c={html:_};return h._firstAddBookmark=!1,_addBookmarkToStack(h._undoStack,c),h},undo:function(){return _undoToRedo.call(this,this._undoStack,this._redoStack)},redo:function(){return _undoToRedo.call(this,this._redoStack,this._undoStack)},fullscreen:function(a){return this.fullscreenMode=a===undefined?!this.fullscreenMode:a,this.addBookmark(!1),this.remove().create()},readonly:function(a){a=_undef(a,!0);var c=this,h=c.edit,g=h.doc;c.designMode?c.toolbar.disableAll(a,[]):_each(c.noDisableItems,function(){c.toolbar[a?"disable":"enable"](this)}),_IE?g.body.contentEditable=!a:g.designMode=a?"off":"on",h.textarea[0].disabled=a},createMenu:function(a){var c=this,h=a.name,g=c.toolbar.get(h),v=g.pos();return a.x=v.x,a.y=v.y+g.height(),a.z=c.options.zIndex,a.shadowMode=_undef(a.shadowMode,c.shadowMode),a.selectedColor!==undefined?(a.cls="ke-colorpicker-"+c.themeType,a.noColor=c.lang("noColor"),c.menu=_colorpicker(a)):(a.cls="ke-menu-"+c.themeType,a.centerLineMode=!1,c.menu=_menu(a)),c.menu},hideMenu:function(){return this.menu.remove(),this.menu=null,this},hideContextmenu:function(){return this.contextmenu.remove(),this.contextmenu=null,this},createDialog:function(a){{var c=this;a.name}if(a.z=c.options.zIndex,a.shadowMode=_undef(a.shadowMode,c.shadowMode),a.closeBtn=_undef(a.closeBtn,{name:c.lang("close"),click:function(){c.hideDialog(),_IE&&c.cmd&&c.cmd.select()}}),a.noBtn=_undef(a.noBtn,{name:c.lang(a.yesBtn?"no":"close"),click:function(){c.hideDialog(),_IE&&c.cmd&&c.cmd.select()}}),"page"!=c.dialogAlignType&&(a.alignEl=c.container),a.cls="ke-dialog-"+c.themeType,c.dialogs.length>0){var h=c.dialogs[0],g=c.dialogs[c.dialogs.length-1];h.setMaskIndex(g.z+2),a.z=g.z+3,a.showMask=!1}var v=_dialog(a);return c.dialogs.push(v),v},hideDialog:function(){var a=this;if(a.dialogs.length>0&&a.dialogs.pop().remove(),a.dialogs.length>0){var c=a.dialogs[0],h=a.dialogs[a.dialogs.length-1];c.setMaskIndex(h.z-1)}return a},errorDialog:function(a){var c=this,h=c.createDialog({width:750,title:c.lang("uploadError"),body:'<div style="padding:10px 20px;"><iframe frameborder="0" style="width:708px;height:400px;"></iframe></div>'}),g=K("iframe",h.div),v=K.iframeDoc(g);return v.open(),v.write(a),v.close(),K(v.body).css("background-color","#FFF"),g[0].contentWindow.focus(),c}},_instances=[],K.remove=function(a){_eachEditor(a,function(i){this.remove(),_instances.splice(i,1)})},K.sync=function(a){_eachEditor(a,function(){this.sync()})},K.html=function(a,c){_eachEditor(a,function(){this.html(c)})},K.insertHtml=function(a,c){_eachEditor(a,function(){this.insertHtml(c)})},K.appendHtml=function(a,c){_eachEditor(a,function(){this.appendHtml(c)})},_IE&&7>_V&&_nativeCommand(document,"BackgroundImageCache",!0),K.EditorClass=KEditor,K.editor=_editor,K.create=_create,K.instances=_instances,K.plugin=_plugin,K.lang=_lang,_plugin("core",function(a){var c=this,h={undo:"Z",redo:"Y",bold:"B",italic:"I",underline:"U",print:"P",selectall:"A"};if(c.afterSetHtml(function(){c.options.afterChange&&c.options.afterChange.call(c)}),c.afterCreate(function(){if("form"==c.syncType){for(var h=a(c.srcElement),g=!1;h=h.parent();)if("form"==h.name){g=!0;break}if(g){h.bind("submit",function(){c.sync(),a(window).bind("unload",function(){c.edit.textarea.remove()})});var v=a('[type="reset"]',h);v.click(function(){c.html(c.initContent),c.cmd.selection()}),c.beforeRemove(function(){h.unbind(),v.unbind()})}}}),c.clickToolbar("source",function(){c.edit.designMode?(c.toolbar.disableAll(!0),c.edit.design(!1),c.toolbar.select("source")):(c.toolbar.disableAll(!1),c.edit.design(!0),c.toolbar.unselect("source"),_GECKO?setTimeout(function(){c.cmd.selection()},0):c.cmd.selection()),c.designMode=c.edit.designMode}),c.afterCreate(function(){c.designMode||c.toolbar.disableAll(!0).select("source")}),c.clickToolbar("fullscreen",function(){c.fullscreen()}),c.fullscreenShortcut){var g=!1;c.afterCreate(function(){if(a(c.edit.doc,c.edit.textarea).keyup(function(e){27==e.which&&setTimeout(function(){c.fullscreen()},0)}),g){if(_IE&&!c.designMode)return;c.focus()}g||(g=!0)})}_each("undo,redo".split(","),function(i,a){h[a]&&c.afterCreate(function(){_ctrl(this.edit.doc,h[a],function(){c.clickToolbar(a)})}),c.clickToolbar(a,function(){c[a]()})}),c.clickToolbar("formatblock",function(){var a=c.lang("formatblock.formatBlock"),h={h1:28,h2:24,h3:18,H4:14,p:12},g=c.cmd.val("formatblock"),v=c.createMenu({name:"formatblock",width:"en"==c.langType?200:150});_each(a,function(a,_){var b="font-size:"+h[a]+"px;";"h"===a.charAt(0)&&(b+="font-weight:bold;"),v.addItem({title:'<span style="'+b+'" unselectable="on">'+_+"</span>",height:h[a]+12,checked:g===a||g===_,click:function(){c.select().exec("formatblock","<"+a+">").hideMenu()}})})}),c.clickToolbar("fontname",function(){var a=c.cmd.val("fontname"),h=c.createMenu({name:"fontname",width:150});_each(c.lang("fontname.fontName"),function(g,v){h.addItem({title:'<span style="font-family: '+g+';" unselectable="on">'+v+"</span>",checked:a===g.toLowerCase()||a===v.toLowerCase(),click:function(){c.exec("fontname",g).hideMenu()}})})}),c.clickToolbar("fontsize",function(){var a=c.cmd.val("fontsize"),h=c.createMenu({name:"fontsize",width:150});_each(c.fontSizeTable,function(i,g){h.addItem({title:'<span style="font-size:'+g+';" unselectable="on">'+g+"</span>",height:_removeUnit(g)+12,checked:a===g,click:function(){c.exec("fontsize",g).hideMenu()}})})}),_each("forecolor,hilitecolor".split(","),function(i,a){c.clickToolbar(a,function(){c.createMenu({name:a,selectedColor:c.cmd.val(a)||"default",colors:c.colorTable,click:function(h){c.exec(a,h).hideMenu()}})})}),_each("cut,copy,paste".split(","),function(i,a){c.clickToolbar(a,function(){c.focus();try{c.exec(a,null)}catch(e){alert(c.lang(a+"Error"))}})}),c.clickToolbar("about",function(){var a='<div style="margin:20px;"><div>KindEditor '+_VERSION+'</div><div>Copyright &copy; <a href="http://www.kindsoft.net/" target="_blank">kindsoft.net</a> All rights reserved.</div></div>';c.createDialog({name:"about",width:350,title:c.lang("about"),body:a})}),c.plugin.getSelectedLink=function(){return c.cmd.commonAncestor("a")},c.plugin.getSelectedImage=function(){return _getImageFromRange(c.edit.cmd.range,function(a){return!/^ke-\w+$/i.test(a[0].className)})},c.plugin.getSelectedFlash=function(){return _getImageFromRange(c.edit.cmd.range,function(a){return"ke-flash"==a[0].className})},c.plugin.getSelectedMedia=function(){return _getImageFromRange(c.edit.cmd.range,function(a){return"ke-media"==a[0].className||"ke-rm"==a[0].className})},c.plugin.getSelectedAnchor=function(){return _getImageFromRange(c.edit.cmd.range,function(a){return"ke-anchor"==a[0].className})},_each("link,image,flash,media,anchor".split(","),function(i,a){var h=a.charAt(0).toUpperCase()+a.substr(1);_each("edit,delete".split(","),function(g,v){c.addContextmenu({title:c.lang(v+h),click:function(){c.loadPlugin(a,function(){c.plugin[a][v](),c.hideMenu()})},cond:c.plugin["getSelected"+h],width:150,iconClass:"edit"==v?"ke-icon-"+a:undefined})}),c.addContextmenu({title:"-"})}),c.plugin.getSelectedTable=function(){return c.cmd.commonAncestor("table")},c.plugin.getSelectedRow=function(){return c.cmd.commonAncestor("tr")},c.plugin.getSelectedCell=function(){return c.cmd.commonAncestor("td")},_each("prop,cellprop,colinsertleft,colinsertright,rowinsertabove,rowinsertbelow,rowmerge,colmerge,rowsplit,colsplit,coldelete,rowdelete,insert,delete".split(","),function(i,a){var h=_inArray(a,["prop","delete"])<0?c.plugin.getSelectedCell:c.plugin.getSelectedTable;c.addContextmenu({title:c.lang("table"+a),click:function(){c.loadPlugin("table",function(){c.plugin.table[a](),c.hideMenu()
})},cond:h,width:170,iconClass:"ke-icon-table"+a})}),c.addContextmenu({title:"-"}),_each("selectall,justifyleft,justifycenter,justifyright,justifyfull,insertorderedlist,insertunorderedlist,indent,outdent,subscript,superscript,hr,print,bold,italic,underline,strikethrough,removeformat,unlink".split(","),function(i,a){h[a]&&c.afterCreate(function(){_ctrl(this.edit.doc,h[a],function(){c.cmd.selection(),c.clickToolbar(a)})}),c.clickToolbar(a,function(){c.focus().exec(a,null)})}),c.afterCreate(function(){function h(){g.range.moveToBookmark(v),g.select(),_WEBKIT&&(a("div."+y,_).each(function(){a(this).after("<br />").remove(!0)}),a("span.Apple-style-span",_).remove(!0),a("span.Apple-tab-span",_).remove(!0),a("span[style]",_).each(function(){"nowrap"==a(this).css("white-space")&&a(this).remove(!0)}),a("meta",_).remove());var h=_[0].innerHTML;_.remove(),""!==h&&(_WEBKIT&&(h=h.replace(/(<br>)\1/gi,"$1")),2===c.pasteType&&(h=h.replace(/(<(?:p|p\s[^>]*)>) *(<\/p>)/gi,""),/schemas-microsoft-com|worddocument|mso-\w+/i.test(h)?h=_clearMsWord(h,c.filterMode?c.htmlTags:a.options.htmlTags):(h=_formatHtml(h,c.filterMode?c.htmlTags:null),h=c.beforeSetHtml(h))),1===c.pasteType&&(h=h.replace(/&nbsp;/gi," "),h=h.replace(/\n\s*\n/g,"\n"),h=h.replace(/<br[^>]*>/gi,"\n"),h=h.replace(/<\/p><p[^>]*>/gi,"\n"),h=h.replace(/<[^>]+>/g,""),h=h.replace(/ {2}/g," &nbsp;"),"p"==c.newlineTag?/\n/.test(h)&&(h=h.replace(/^/,"<p>").replace(/$/,"<br /></p>").replace(/\n/g,"<br /></p><p>")):h=h.replace(/\n/g,"<br />$&")),c.insertHtml(h,!0))}var g,v,_,b=c.edit.doc,y="__kindeditor_paste__",k=!1;a(b.body).bind("paste",function(e){if(0===c.pasteType)return void e.stop();if(!k){if(k=!0,a("div."+y,b).remove(),g=c.cmd.selection(),v=g.range.createBookmark(),_=a('<div class="'+y+'"></div>',b).css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",left:"-1981px",top:a(v.start).pos().y+"px","white-space":"nowrap"}),a(b.body).append(_),_IE){var w=g.range.get(!0);w.moveToElementText(_[0]),w.select(),w.execCommand("paste"),e.preventDefault()}else g.range.selectNodeContents(_[0]),g.select();setTimeout(function(){h(),k=!1},0)}})}),c.beforeGetHtml(function(a){return _IE&&8>=_V&&(a=a.replace(/<div\s+[^>]*data-ke-input-tag="([^"]*)"[^>]*>([\s\S]*?)<\/div>/gi,function(a,c){return unescape(c)}),a=a.replace(/(<input)((?:\s+[^>]*)?>)/gi,function(a,c,h){return/\s+type="[^"]+"/i.test(a)?a:c+' type="text"'+h})),a.replace(/(<(?:noscript|noscript\s[^>]*)>)([\s\S]*?)(<\/noscript>)/gi,function(a,c,h,g){return c+_unescape(h).replace(/\s+/g," ")+g}).replace(/<img[^>]*class="?ke-(flash|rm|media)"?[^>]*>/gi,function(a){var c=_getAttrList(a),h=_getCssList(c.style||""),g=_mediaAttrs(c["data-ke-tag"]),v=_undef(h.width,""),_=_undef(h.height,"");return/px/i.test(v)&&(v=_removeUnit(v)),/px/i.test(_)&&(_=_removeUnit(_)),g.width=_undef(c.width,v),g.height=_undef(c.height,_),_mediaEmbed(g)}).replace(/<img[^>]*class="?ke-anchor"?[^>]*>/gi,function(a){var c=_getAttrList(a);return'<a name="'+unescape(c["data-ke-name"])+'"></a>'}).replace(/<div\s+[^>]*data-ke-script-attr="([^"]*)"[^>]*>([\s\S]*?)<\/div>/gi,function(a,c,h){return"<script"+unescape(c)+">"+unescape(h)+"</script>"}).replace(/<div\s+[^>]*data-ke-noscript-attr="([^"]*)"[^>]*>([\s\S]*?)<\/div>/gi,function(a,c,h){return"<noscript"+unescape(c)+">"+unescape(h)+"</noscript>"}).replace(/(<[^>]*)data-ke-src="([^"]*)"([^>]*>)/gi,function(a,c,h){return a=a.replace(/(\s+(?:href|src)=")[^"]*(")/i,function(a,c,g){return c+_unescape(h)+g}),a=a.replace(/\s+data-ke-src="[^"]*"/i,"")}).replace(/(<[^>]+\s)data-ke-(on\w+="[^"]*"[^>]*>)/gi,function(a,c,h){return c+h})}),c.beforeSetHtml(function(a){return _IE&&8>=_V&&(a=a.replace(/<input[^>]*>|<(select|button)[^>]*>[\s\S]*?<\/\1>/gi,function(a){var c=_getAttrList(a),h=_getCssList(c.style||"");return"none"==h.display?'<div class="ke-display-none" data-ke-input-tag="'+escape(a)+'"></div>':a})),a.replace(/<embed[^>]*type="([^"]+)"[^>]*>(?:<\/embed>)?/gi,function(a){var h=_getAttrList(a);return h.src=_undef(h.src,""),h.width=_undef(h.width,0),h.height=_undef(h.height,0),_mediaImg(c.themesPath+"common/blank.gif",h)}).replace(/<a[^>]*name="([^"]+)"[^>]*>(?:<\/a>)?/gi,function(a){var h=_getAttrList(a);return h.href!==undefined?a:'<img class="ke-anchor" src="'+c.themesPath+'common/anchor.gif" data-ke-name="'+escape(h.name)+'" />'}).replace(/<script([^>]*)>([\s\S]*?)<\/script>/gi,function(a,c,h){return'<div class="ke-script" data-ke-script-attr="'+escape(c)+'">'+escape(h)+"</div>"}).replace(/<noscript([^>]*)>([\s\S]*?)<\/noscript>/gi,function(a,c,h){return'<div class="ke-noscript" data-ke-noscript-attr="'+escape(c)+'">'+escape(h)+"</div>"}).replace(/(<[^>]*)(href|src)="([^"]*)"([^>]*>)/gi,function(a,c,h,g,v){return a.match(/\sdata-ke-src="[^"]*"/i)?a:a=c+h+'="'+g+'" data-ke-src="'+_escape(g)+'"'+v}).replace(/(<[^>]+\s)(on\w+="[^"]*"[^>]*>)/gi,function(a,c,h){return c+"data-ke-"+h}).replace(/<table[^>]*\s+border="0"[^>]*>/gi,function(a){return a.indexOf("ke-zeroborder")>=0?a:_addClassToTag(a,"ke-zeroborder")})})})}}(window),KindEditor.lang({source:"HTMLä»£ç ",preview:"é¢„è§ˆ",undo:"åŽé€€(Ctrl+Z)",redo:"å‰è¿›(Ctrl+Y)",cut:"å‰ªåˆ‡(Ctrl+X)",copy:"å¤åˆ¶(Ctrl+C)",paste:"ç²˜è´´(Ctrl+V)",plainpaste:"ç²˜è´´ä¸ºæ— æ ¼å¼æ–‡æœ¬",wordpaste:"ä»ŽWordç²˜è´´",selectall:"å…¨é€‰(Ctrl+A)",justifyleft:"å·¦å¯¹é½",justifycenter:"å±…ä¸­",justifyright:"å³å¯¹é½",justifyfull:"ä¸¤ç«¯å¯¹é½",insertorderedlist:"ç¼–å·",insertunorderedlist:"é¡¹ç›®ç¬¦å·",indent:"å¢žåŠ ç¼©è¿›",outdent:"å‡å°‘ç¼©è¿›",subscript:"ä¸‹æ ‡",superscript:"ä¸Šæ ‡",formatblock:"æ®µè½",fontname:"å­—ä½“",fontsize:"æ–‡å­—å¤§å°",forecolor:"æ–‡å­—é¢œè‰²",hilitecolor:"æ–‡å­—èƒŒæ™¯",bold:"ç²—ä½“(Ctrl+B)",italic:"æ–œä½“(Ctrl+I)",underline:"ä¸‹åˆ’çº¿(Ctrl+U)",strikethrough:"åˆ é™¤çº¿",removeformat:"åˆ é™¤æ ¼å¼",image:"å›¾ç‰‡",multiimage:"æ‰¹é‡å›¾ç‰‡ä¸Šä¼ ",flash:"Flash",media:"è§†éŸ³é¢‘",table:"è¡¨æ ¼",tablecell:"å•å…ƒæ ¼",hr:"æ’å…¥æ¨ªçº¿",emoticons:"æ’å…¥è¡¨æƒ…",link:"è¶…çº§é“¾æŽ¥",unlink:"å–æ¶ˆè¶…çº§é“¾æŽ¥",fullscreen:"å…¨å±æ˜¾ç¤º",about:"å…³äºŽ",print:"æ‰“å°(Ctrl+P)",filemanager:"æ–‡ä»¶ç©ºé—´",code:"æ’å…¥ç¨‹åºä»£ç ",map:"Googleåœ°å›¾",baidumap:"ç™¾åº¦åœ°å›¾",lineheight:"è¡Œè·",clearhtml:"æ¸…ç†HTMLä»£ç ",pagebreak:"æ’å…¥åˆ†é¡µç¬¦",quickformat:"ä¸€é”®æŽ’ç‰ˆ",insertfile:"æ’å…¥æ–‡ä»¶",template:"æ’å…¥æ¨¡æ¿",anchor:"é”šç‚¹",yes:"ç¡®å®š",no:"å–æ¶ˆ",close:"å…³é—­",editImage:"å›¾ç‰‡å±žæ€§",deleteImage:"åˆ é™¤å›¾ç‰‡",editFlash:"Flashå±žæ€§",deleteFlash:"åˆ é™¤Flash",editMedia:"è§†éŸ³é¢‘å±žæ€§",deleteMedia:"åˆ é™¤è§†éŸ³é¢‘",editLink:"è¶…çº§é“¾æŽ¥å±žæ€§",deleteLink:"å–æ¶ˆè¶…çº§é“¾æŽ¥",editAnchor:"é”šç‚¹å±žæ€§",deleteAnchor:"åˆ é™¤é”šç‚¹",tableprop:"è¡¨æ ¼å±žæ€§",tablecellprop:"å•å…ƒæ ¼å±žæ€§",tableinsert:"æ’å…¥è¡¨æ ¼",tabledelete:"åˆ é™¤è¡¨æ ¼",tablecolinsertleft:"å·¦ä¾§æ’å…¥åˆ—",tablecolinsertright:"å³ä¾§æ’å…¥åˆ—",tablerowinsertabove:"ä¸Šæ–¹æ’å…¥è¡Œ",tablerowinsertbelow:"ä¸‹æ–¹æ’å…¥è¡Œ",tablerowmerge:"å‘ä¸‹åˆå¹¶å•å…ƒæ ¼",tablecolmerge:"å‘å³åˆå¹¶å•å…ƒæ ¼",tablerowsplit:"æ‹†åˆ†è¡Œ",tablecolsplit:"æ‹†åˆ†åˆ—",tablecoldelete:"åˆ é™¤åˆ—",tablerowdelete:"åˆ é™¤è¡Œ",noColor:"æ— é¢œè‰²",pleaseSelectFile:"è¯·é€‰æ‹©æ–‡ä»¶ã€‚",invalidImg:"è¯·è¾“å…¥æœ‰æ•ˆçš„URLåœ°å€ã€‚\nåªå…è®¸jpg,gif,bmp,pngæ ¼å¼ã€‚",invalidMedia:"è¯·è¾“å…¥æœ‰æ•ˆçš„URLåœ°å€ã€‚\nåªå…è®¸swf,flv,mp3,wav,wma,wmv,mid,avi,mpg,asf,rm,rmvbæ ¼å¼ã€‚",invalidWidth:"å®½åº¦å¿…é¡»ä¸ºæ•°å­—ã€‚",invalidHeight:"é«˜åº¦å¿…é¡»ä¸ºæ•°å­—ã€‚",invalidBorder:"è¾¹æ¡†å¿…é¡»ä¸ºæ•°å­—ã€‚",invalidUrl:"è¯·è¾“å…¥æœ‰æ•ˆçš„URLåœ°å€ã€‚",invalidRows:"è¡Œæ•°ä¸ºå¿…é€‰é¡¹ï¼Œåªå…è®¸è¾“å…¥å¤§äºŽ0çš„æ•°å­—ã€‚",invalidCols:"åˆ—æ•°ä¸ºå¿…é€‰é¡¹ï¼Œåªå…è®¸è¾“å…¥å¤§äºŽ0çš„æ•°å­—ã€‚",invalidPadding:"è¾¹è·å¿…é¡»ä¸ºæ•°å­—ã€‚",invalidSpacing:"é—´è·å¿…é¡»ä¸ºæ•°å­—ã€‚",invalidJson:"æœåŠ¡å™¨å‘ç”Ÿæ•…éšœã€‚",uploadSuccess:"ä¸Šä¼ æˆåŠŸã€‚",cutError:"æ‚¨çš„æµè§ˆå™¨å®‰å…¨è®¾ç½®ä¸å…è®¸ä½¿ç”¨å‰ªåˆ‡æ“ä½œï¼Œè¯·ä½¿ç”¨å¿«æ·é”®(Ctrl+X)æ¥å®Œæˆã€‚",copyError:"æ‚¨çš„æµè§ˆå™¨å®‰å…¨è®¾ç½®ä¸å…è®¸ä½¿ç”¨å¤åˆ¶æ“ä½œï¼Œè¯·ä½¿ç”¨å¿«æ·é”®(Ctrl+C)æ¥å®Œæˆã€‚",pasteError:"æ‚¨çš„æµè§ˆå™¨å®‰å…¨è®¾ç½®ä¸å…è®¸ä½¿ç”¨ç²˜è´´æ“ä½œï¼Œè¯·ä½¿ç”¨å¿«æ·é”®(Ctrl+V)æ¥å®Œæˆã€‚",ajaxLoading:"åŠ è½½ä¸­ï¼Œè¯·ç¨å€™ ...",uploadLoading:"ä¸Šä¼ ä¸­ï¼Œè¯·ç¨å€™ ...",uploadError:"ä¸Šä¼ é”™è¯¯","plainpaste.comment":"è¯·ä½¿ç”¨å¿«æ·é”®(Ctrl+V)æŠŠå†…å®¹ç²˜è´´åˆ°ä¸‹é¢çš„æ–¹æ¡†é‡Œã€‚","wordpaste.comment":"è¯·ä½¿ç”¨å¿«æ·é”®(Ctrl+V)æŠŠå†…å®¹ç²˜è´´åˆ°ä¸‹é¢çš„æ–¹æ¡†é‡Œã€‚","code.pleaseInput":"è¯·è¾“å…¥ç¨‹åºä»£ç ã€‚","link.url":"URL","link.linkType":"æ‰“å¼€ç±»åž‹","link.newWindow":"æ–°çª—å£","link.selfWindow":"å½“å‰çª—å£","flash.url":"URL","flash.width":"å®½åº¦","flash.height":"é«˜åº¦","flash.upload":"ä¸Šä¼ ","flash.viewServer":"æ–‡ä»¶ç©ºé—´","media.url":"URL","media.width":"å®½åº¦","media.height":"é«˜åº¦","media.autostart":"è‡ªåŠ¨æ’­æ”¾","media.upload":"ä¸Šä¼ ","media.viewServer":"æ–‡ä»¶ç©ºé—´","image.remoteImage":"ç½‘ç»œå›¾ç‰‡","image.localImage":"æœ¬åœ°ä¸Šä¼ ","image.remoteUrl":"å›¾ç‰‡åœ°å€","image.localUrl":"ä¸Šä¼ æ–‡ä»¶","image.size":"å›¾ç‰‡å¤§å°","image.width":"å®½","image.height":"é«˜","image.resetSize":"é‡ç½®å¤§å°","image.align":"å¯¹é½æ–¹å¼","image.defaultAlign":"é»˜è®¤æ–¹å¼","image.leftAlign":"å·¦å¯¹é½","image.rightAlign":"å³å¯¹é½","image.imgTitle":"å›¾ç‰‡è¯´æ˜Ž","image.upload":"æµè§ˆ...","image.viewServer":"å›¾ç‰‡ç©ºé—´","multiimage.uploadDesc":"å…è®¸ç”¨æˆ·åŒæ—¶ä¸Šä¼ <%=uploadLimit%>å¼ å›¾ç‰‡ï¼Œå•å¼ å›¾ç‰‡å®¹é‡ä¸è¶…è¿‡<%=sizeLimit%>","multiimage.startUpload":"å¼€å§‹ä¸Šä¼ ","multiimage.clearAll":"å…¨éƒ¨æ¸…ç©º","multiimage.insertAll":"å…¨éƒ¨æ’å…¥","multiimage.queueLimitExceeded":"æ–‡ä»¶æ•°é‡è¶…è¿‡é™åˆ¶ã€‚","multiimage.fileExceedsSizeLimit":"æ–‡ä»¶å¤§å°è¶…è¿‡é™åˆ¶ã€‚","multiimage.zeroByteFile":"æ— æ³•ä¸Šä¼ ç©ºæ–‡ä»¶ã€‚","multiimage.invalidFiletype":"æ–‡ä»¶ç±»åž‹ä¸æ­£ç¡®ã€‚","multiimage.unknownError":"å‘ç”Ÿå¼‚å¸¸ï¼Œæ— æ³•ä¸Šä¼ ã€‚","multiimage.pending":"ç­‰å¾…ä¸Šä¼ ","multiimage.uploadError":"ä¸Šä¼ å¤±è´¥","filemanager.emptyFolder":"ç©ºæ–‡ä»¶å¤¹","filemanager.moveup":"ç§»åˆ°ä¸Šä¸€çº§æ–‡ä»¶å¤¹","filemanager.viewType":"æ˜¾ç¤ºæ–¹å¼ï¼š","filemanager.viewImage":"ç¼©ç•¥å›¾","filemanager.listImage":"è¯¦ç»†ä¿¡æ¯","filemanager.orderType":"æŽ’åºæ–¹å¼ï¼š","filemanager.fileName":"åç§°","filemanager.fileSize":"å¤§å°","filemanager.fileType":"ç±»åž‹","insertfile.url":"URL","insertfile.title":"æ–‡ä»¶è¯´æ˜Ž","insertfile.upload":"ä¸Šä¼ ","insertfile.viewServer":"æ–‡ä»¶ç©ºé—´","table.cells":"å•å…ƒæ ¼æ•°","table.rows":"è¡Œæ•°","table.cols":"åˆ—æ•°","table.size":"å¤§å°","table.width":"å®½åº¦","table.height":"é«˜åº¦","table.percent":"%","table.px":"px","table.space":"è¾¹è·é—´è·","table.padding":"è¾¹è·","table.spacing":"é—´è·","table.align":"å¯¹é½æ–¹å¼","table.textAlign":"æ°´å¹³å¯¹é½","table.verticalAlign":"åž‚ç›´å¯¹é½","table.alignDefault":"é»˜è®¤","table.alignLeft":"å·¦å¯¹é½","table.alignCenter":"å±…ä¸­","table.alignRight":"å³å¯¹é½","table.alignTop":"é¡¶éƒ¨","table.alignMiddle":"ä¸­éƒ¨","table.alignBottom":"åº•éƒ¨","table.alignBaseline":"åŸºçº¿","table.border":"è¾¹æ¡†","table.borderWidth":"è¾¹æ¡†","table.borderColor":"é¢œè‰²","table.backgroundColor":"èƒŒæ™¯é¢œè‰²","map.address":"åœ°å€: ","map.search":"æœç´¢","baidumap.address":"åœ°å€: ","baidumap.search":"æœç´¢","baidumap.insertDynamicMap":"æ’å…¥åŠ¨æ€åœ°å›¾","anchor.name":"é”šç‚¹åç§°","formatblock.formatBlock":{h1:"æ ‡é¢˜ 1",h2:"æ ‡é¢˜ 2",h3:"æ ‡é¢˜ 3",h4:"æ ‡é¢˜ 4",p:"æ­£ æ–‡"},"fontname.fontName":{SimSun:"å®‹ä½“",NSimSun:"æ–°å®‹ä½“",FangSong_GB2312:"ä»¿å®‹_GB2312",KaiTi_GB2312:"æ¥·ä½“_GB2312",SimHei:"é»‘ä½“","Microsoft YaHei":"å¾®è½¯é›…é»‘",Arial:"Arial","Arial Black":"Arial Black","Times New Roman":"Times New Roman","Courier New":"Courier New",Tahoma:"Tahoma",Verdana:"Verdana"},"lineheight.lineHeight":[{1:"å•å€è¡Œè·"},{1.5:"1.5å€è¡Œè·"},{2:"2å€è¡Œè·"},{2.5:"2.5å€è¡Œè·"},{3:"3å€è¡Œè·"}],"template.selectTemplate":"å¯é€‰æ¨¡æ¿","template.replaceContent":"æ›¿æ¢å½“å‰å†…å®¹","template.fileList":{"1.html":"å›¾ç‰‡å’Œæ–‡å­—","2.html":"è¡¨æ ¼","3.html":"é¡¹ç›®ç¼–å·"}},"zh_CN"),KindEditor.plugin("anchor",function(a){var c=this,h="anchor",g=c.lang(h+".");c.plugin.anchor={edit:function(){var v=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keName">'+g.name+"</label>",'<input class="ke-input-text" type="text" id="keName" name="name" value="" style="width:100px;" />',"</div>","</div>"].join(""),_=c.createDialog({name:h,width:300,title:c.lang(h),body:v,yesBtn:{name:c.lang("yes"),click:function(){c.insertHtml('<a name="'+y.val()+'">').hideDialog().focus()}}}),b=_.div,y=a('input[name="name"]',b),k=c.plugin.getSelectedAnchor();k&&y.val(unescape(k.attr("data-ke-name"))),y[0].focus(),y[0].select()},"delete":function(){c.plugin.getSelectedAnchor().remove()}},c.clickToolbar(h,c.plugin.anchor.edit)}),KindEditor.plugin("autoheight",function(a){function c(){var a=v.edit,c=a.doc.body;a.iframe[0].scroll="no",c.style.overflowY="hidden"}function h(){var c=v.edit,h=c.doc.body;c.iframe.height(_),v.resize(null,Math.max((a.IE?h.scrollHeight:h.offsetHeight)+76,_))}function g(){_=a.removeUnit(v.height),v.edit.afterChange(h),c(),h()}var v=this;if(v.autoHeightMode){var _;v.isCreated?g():v.afterCreate(g)}}),KindEditor.plugin("baidumap",function(a){var c=this,h="baidumap",g=c.lang(h+"."),v=a.undef(c.mapWidth,558),_=a.undef(c.mapHeight,360);c.clickToolbar(h,function(){function b(){y=U[0].contentWindow,k=a.iframeDoc(U)}var y,k,w=['<div style="padding:10px 20px;">','<div class="ke-header">','<div class="ke-left">',g.address+' <input id="kindeditor_plugin_map_address" name="address" class="ke-input-text" value="" style="width:200px;" /> ','<span class="ke-button-common ke-button-outer">','<input type="button" name="searchBtn" class="ke-button-common ke-button" value="'+g.search+'" />',"</span>","</div>",'<div class="ke-right">','<input type="checkbox" id="keInsertDynamicMap" name="insertDynamicMap" value="1" /> <label for="keInsertDynamicMap">'+g.insertDynamicMap+"</label>","</div>",'<div class="ke-clearfix"></div>',"</div>",'<div class="ke-map" style="width:'+v+"px;height:"+_+'px;"></div>',"</div>"].join(""),S=c.createDialog({name:h,width:v+42,title:c.lang(h),body:w,yesBtn:{name:c.lang("yes"),click:function(){var a=y.map,h=a.getCenter(),g=h.lng+","+h.lat,b=a.getZoom(),k=[K[0].checked?c.pluginsPath+"baidumap/index.html":"http://api.map.baidu.com/staticimage","?center="+encodeURIComponent(g),"&zoom="+encodeURIComponent(b),"&width="+v,"&height="+_,"&markers="+encodeURIComponent(g),"&markerStyles="+encodeURIComponent("l,A")].join("");K[0].checked?c.insertHtml('<iframe src="'+k+'" frameborder="0" style="width:'+(v+2)+"px;height:"+(_+2)+'px;"></iframe>'):c.exec("insertimage",k),c.hideDialog().focus()}},beforeRemove:function(){T.remove(),k&&k.write(""),U.remove()}}),E=S.div,C=a('[name="address"]',E),T=a('[name="searchBtn"]',E),K=a('[name="insertDynamicMap"]',S.div),U=a('<iframe class="ke-textarea" frameborder="0" src="'+c.pluginsPath+'baidumap/map.html" style="width:'+v+"px;height:"+_+'px;"></iframe>');U.bind("load",function(){U.unbind("load"),a.IE?b():setTimeout(b,0)}),a(".ke-map",E).replaceWith(U),T.click(function(){y.search(C.val())})})}),KindEditor.plugin("clearhtml",function(a){var c=this,h="clearhtml";c.clickToolbar(h,function(){c.focus();var h=c.html();h=h.replace(/(<script[^>]*>)([\s\S]*?)(<\/script>)/gi,""),h=h.replace(/(<style[^>]*>)([\s\S]*?)(<\/style>)/gi,""),h=a.formatHtml(h,{a:["href","target"],embed:["src","width","height","type","loop","autostart","quality",".width",".height","align","allowscriptaccess"],img:["src","width","height","border","alt","title",".width",".height"],table:["border"],"td,th":["rowspan","colspan"],"div,hr,br,tbody,tr,p,ol,ul,li,blockquote,h1,h2,h3,h4,h5,h6":[]}),c.html(h),c.cmd.selection(!0),c.addBookmark()})}),KindEditor.plugin("code",function(a){var c=this,h="code";c.clickToolbar(h,function(){var g=c.lang(h+"."),v=['<div style="padding:10px 20px;">','<div class="ke-dialog-row">','<select class="ke-code-type">','<option value="js">JavaScript</option>','<option value="html">HTML</option>','<option value="css">CSS</option>','<option value="php">PHP</option>','<option value="pl">Perl</option>','<option value="py">Python</option>','<option value="rb">Ruby</option>','<option value="java">Java</option>','<option value="vb">ASP/VB</option>','<option value="cpp">C/C++</option>','<option value="cs">C#</option>','<option value="xml">XML</option>','<option value="bsh">Shell</option>','<option value="">Other</option>',"</select>","</div>",'<textarea class="ke-textarea" style="width:408px;height:260px;"></textarea>',"</div>"].join(""),_=c.createDialog({name:h,width:450,title:c.lang(h),body:v,yesBtn:{name:c.lang("yes"),click:function(){var h=a(".ke-code-type",_.div).val(),v=b.val(),y=""===h?"":" lang-"+h,k='<pre class="prettyprint'+y+'">\n'+a.escape(v)+"</pre> ";return""===a.trim(v)?(alert(g.pleaseInput),void b[0].focus()):void c.insertHtml(k).hideDialog().focus()}}}),b=a("textarea",_.div);b[0].focus()})}),KindEditor.plugin("emoticons",function(a){var c=this,h="emoticons",g=c.emoticonsPath||c.pluginsPath+"emoticons/images/",v=void 0===c.allowPreviewEmoticons?!0:c.allowPreviewEmoticons,_=1;c.clickToolbar(h,function(){function b(h,v,_){h.mouseover(R?function(){v>N?(R.css("left",0),R.css("right","")):(R.css("left",""),R.css("right",0)),M.attr("src",g+_+".gif"),a(this).addClass("ke-on")}:function(){a(this).addClass("ke-on")}),h.mouseout(function(){a(this).removeClass("ke-on")}),h.click(function(e){c.insertHtml('<img src="'+g+_+'.gif" border="0" alt="" />').hideMenu().focus(),e.stop()})}function y(c,h){var v=document.createElement("table");h.append(v),R&&(a(v).mouseover(function(){R.show("block")}),a(v).mouseout(function(){R.hide()}),F.push(a(v))),v.className="ke-table",v.cellPadding=0,v.cellSpacing=0,v.border=0;for(var _=(c-1)*U+K,i=0;E>i;i++)for(var y=v.insertRow(i),k=0;C>k;k++){var w=a(y.insertCell(k));w.addClass("ke-cell"),b(w,k,_);var S=a('<span class="ke-img"></span>').css("background-position","-"+24*_+"px 0px").css("background-image","url("+g+"static.gif)");w.append(S),F.push(w),_++}return v}function k(){a.each(F,function(){this.unbind()})}function w(a,c){a.click(function(e){k(),B.parentNode.removeChild(B),P.remove(),B=y(c,I),S(c),_=c,e.stop()})}function S(c){P=a('<div class="ke-page"></div>'),I.append(P);for(var h=1;A>=h;h++){if(c!==h){var g=a('<a href="javascript:;">['+h+"]</a>");w(g,h),P.append(g),F.push(g)}else P.append(a("@["+h+"]"));P.append(a("@&nbsp;"))}}var E=5,C=9,T=135,K=0,U=E*C,A=Math.ceil(T/U),N=Math.floor(C/2),I=a('<div class="ke-plugin-emoticons"></div>'),F=[],D=c.createMenu({name:h,beforeRemove:function(){k()}});D.div.append(I);var R,M;v&&(R=a('<div class="ke-preview"></div>').css("right",0),M=a('<img class="ke-preview-img" src="'+g+K+'.gif" />'),I.append(R),R.append(M));var P,B=y(_,I);S(_)})}),KindEditor.plugin("filemanager",function(a){function c(a,c,h){return a+" ("+Math.ceil(c/1024)+"KB, "+h+")"}function h(a,h){h.is_dir?a.attr("title",h.filename):a.attr("title",c(h.filename,h.filesize,h.datetime))}var g=this,v="filemanager",_=a.undef(g.fileManagerJson,g.basePath+"php/file_manager_json.php"),b=g.pluginsPath+v+"/images/",y=g.lang(v+".");g.plugin.filemanagerDialog=function(c){function k(c,h,v){var b="path="+c+"&order="+h+"&dir="+U;F.showLoading(g.lang("ajaxLoading")),a.ajax(a.addParam(_,b+"&"+(new Date).getTime()),function(a){F.hideLoading(),v(a)})}function w(c,h,g,v){var _=a.formatUrl(h.current_url+g.filename,"absolute"),b=encodeURIComponent(h.current_dir_path+g.filename+"/");c.click(g.is_dir?function(){k(b,B.val(),v)}:g.is_photo?function(){N.call(this,_,g.filename)}:function(){N.call(this,_,g.filename)}),L.push(c)}function S(c,h){function g(){"VIEW"==P.val()?k(c.current_dir_path,B.val(),C):k(c.current_dir_path,B.val(),E)}a.each(L,function(){this.unbind()}),M.unbind(),P.unbind(),B.unbind(),c.current_dir_path&&M.click(function(){k(c.moveup_dir_path,B.val(),h)}),P.change(g),B.change(g),R.html("")}function E(c){S(c,E);var h=document.createElement("table");h.className="ke-table",h.cellPadding=0,h.cellSpacing=0,h.border=0,R.append(h);for(var g=c.file_list,i=0,v=g.length;v>i;i++){var _=g[i],k=a(h.insertRow(i));k.mouseover(function(){a(this).addClass("ke-on")}).mouseout(function(){a(this).removeClass("ke-on")});var C=b+(_.is_dir?"folder-16.gif":"file-16.gif"),T=a('<img src="'+C+'" width="16" height="16" alt="'+_.filename+'" align="absmiddle" />'),K=a(k[0].insertCell(0)).addClass("ke-cell ke-name").append(T).append(document.createTextNode(" "+_.filename));!_.is_dir||_.has_file?(k.css("cursor","pointer"),K.attr("title",_.filename),w(K,c,_,E)):K.attr("title",y.emptyFolder),a(k[0].insertCell(1)).addClass("ke-cell ke-size").html(_.is_dir?"-":Math.ceil(_.filesize/1024)+"KB"),a(k[0].insertCell(2)).addClass("ke-cell ke-datetime").html(_.datetime)}}function C(c){S(c,C);for(var g=c.file_list,i=0,v=g.length;v>i;i++){var _=g[i],k=a('<div class="ke-inline-block ke-item"></div>');R.append(k);var E=a('<div class="ke-inline-block ke-photo"></div>').mouseover(function(){a(this).addClass("ke-on")}).mouseout(function(){a(this).removeClass("ke-on")});k.append(E);var T=c.current_url+_.filename,K=_.is_dir?b+"folder-64.gif":_.is_photo?T:b+"file-64.gif",U=a('<img src="'+K+'" width="80" height="80" alt="'+_.filename+'" />');!_.is_dir||_.has_file?(E.css("cursor","pointer"),h(E,_),w(E,c,_,C)):E.attr("title",y.emptyFolder),E.append(U),k.append('<div class="ke-name" title="'+_.filename+'">'+_.filename+"</div>")}}var T=a.undef(c.width,650),K=a.undef(c.height,510),U=a.undef(c.dirName,""),A=a.undef(c.viewType,"VIEW").toUpperCase(),N=c.clickFn,I=['<div style="padding:10px 20px;">','<div class="ke-plugin-filemanager-header">','<div class="ke-left">','<img class="ke-inline-block" name="moveupImg" src="'+b+'go-up.gif" width="16" height="16" border="0" alt="" /> ','<a class="ke-inline-block" name="moveupLink" href="javascript:;">'+y.moveup+"</a>","</div>",'<div class="ke-right">',y.viewType+' <select class="ke-inline-block" name="viewType">','<option value="VIEW">'+y.viewImage+"</option>",'<option value="LIST">'+y.listImage+"</option>","</select> ",y.orderType+' <select class="ke-inline-block" name="orderType">','<option value="NAME">'+y.fileName+"</option>",'<option value="SIZE">'+y.fileSize+"</option>",'<option value="TYPE">'+y.fileType+"</option>","</select>","</div>",'<div class="ke-clearfix"></div>',"</div>",'<div class="ke-plugin-filemanager-body"></div>',"</div>"].join(""),F=g.createDialog({name:v,width:T,height:K,title:g.lang(v),body:I}),D=F.div,R=a(".ke-plugin-filemanager-body",D),M=(a('[name="moveupImg"]',D),a('[name="moveupLink"]',D)),P=(a('[name="viewServer"]',D),a('[name="viewType"]',D)),B=a('[name="orderType"]',D),L=[];return P.val(A),k("",B.val(),"VIEW"==A?C:E),F}}),KindEditor.plugin("flash",function(a){var c=this,h="flash",g=c.lang(h+"."),v=a.undef(c.allowFlashUpload,!0),_=a.undef(c.allowFileManager,!1),b=a.undef(c.formatUploadUrl,!0),y=a.undef(c.extraFileUploadParams,{}),k=a.undef(c.filePostName,"imgFile"),w=a.undef(c.uploadJson,c.basePath+"php/upload_json.php");c.plugin.flash={edit:function(){var S=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keUrl" style="width:60px;">'+g.url+"</label>",'<input class="ke-input-text" type="text" id="keUrl" name="url" value="" style="width:160px;" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+g.upload+'" /> &nbsp;','<span class="ke-button-common ke-button-outer">','<input type="button" class="ke-button-common ke-button" name="viewServer" value="'+g.viewServer+'" />',"</span>","</div>",'<div class="ke-dialog-row">','<label for="keWidth" style="width:60px;">'+g.width+"</label>",'<input type="text" id="keWidth" class="ke-input-text ke-input-number" name="width" value="550" maxlength="4" /> ',"</div>",'<div class="ke-dialog-row">','<label for="keHeight" style="width:60px;">'+g.height+"</label>",'<input type="text" id="keHeight" class="ke-input-text ke-input-number" name="height" value="400" maxlength="4" /> ',"</div>","</div>"].join(""),E=c.createDialog({name:h,width:450,title:c.lang(h),body:S,yesBtn:{name:c.lang("yes"),click:function(){var h=a.trim(T.val()),g=U.val(),v=A.val();if("http://"==h||a.invalidUrl(h))return alert(c.lang("invalidUrl")),void T[0].focus();if(!/^\d*$/.test(g))return alert(c.lang("invalidWidth")),void U[0].focus();if(!/^\d*$/.test(v))return alert(c.lang("invalidHeight")),void A[0].focus();var _=a.mediaImg(c.themesPath+"common/blank.gif",{src:h,type:a.mediaType(".swf"),width:g,height:v,quality:"high"});c.insertHtml(_).hideDialog().focus()}}}),C=E.div,T=a('[name="url"]',C),K=a('[name="viewServer"]',C),U=a('[name="width"]',C),A=a('[name="height"]',C);if(T.val("http://"),v){var N=a.uploadbutton({button:a(".ke-upload-button",C)[0],fieldName:k,extraParams:y,url:a.addParam(w,"dir=flash"),afterUpload:function(g){if(E.hideLoading(),0===g.error){var v=g.url;b&&(v=a.formatUrl(v,"absolute")),T.val(v),c.afterUpload&&c.afterUpload.call(c,v,g,h),alert(c.lang("uploadSuccess"))}else alert(g.message)},afterError:function(a){E.hideLoading(),c.errorDialog(a)}});N.fileBox.change(function(){E.showLoading(c.lang("uploadLoading")),N.submit()})}else a(".ke-upload-button",C).hide();_?K.click(function(){c.loadPlugin("filemanager",function(){c.plugin.filemanagerDialog({viewType:"LIST",dirName:"flash",clickFn:function(h){c.dialogs.length>1&&(a('[name="url"]',C).val(h),c.afterSelectFile&&c.afterSelectFile.call(c,h),c.hideDialog())}})})}):K.hide();var I=c.plugin.getSelectedFlash();if(I){var F=a.mediaAttrs(I.attr("data-ke-tag"));T.val(F.src),U.val(a.removeUnit(I.css("width"))||F.width||0),A.val(a.removeUnit(I.css("height"))||F.height||0)}T[0].focus(),T[0].select()},"delete":function(){c.plugin.getSelectedFlash().remove(),c.addBookmark()}},c.clickToolbar(h,c.plugin.flash.edit)}),KindEditor.plugin("image",function(a){var c=this,h="image",g=a.undef(c.allowImageUpload,!0),v=a.undef(c.allowImageRemote,!0),_=a.undef(c.formatUploadUrl,!0),b=a.undef(c.allowFileManager,!1),y=a.undef(c.uploadJson,c.basePath+"php/upload_json.php"),k=a.undef(c.imageTabIndex,0),w=c.pluginsPath+"image/images/",S=a.undef(c.extraFileUploadParams,{}),E=a.undef(c.filePostName,"imgFile"),C=a.undef(c.fillDescAfterUploadImage,!1),T=c.lang(h+".");c.plugin.imageDialog=function(g){function v(a,c){z.val(a),j.val(c),Y=a,X=c}var k=(g.imageUrl,a.undef(g.imageWidth,""),a.undef(g.imageHeight,""),a.undef(g.imageTitle,""),a.undef(g.imageAlign,""),a.undef(g.showRemote,!0)),K=a.undef(g.showLocal,!0),U=a.undef(g.tabIndex,0),A=g.clickFn,N="kindeditor_upload_iframe_"+(new Date).getTime(),I=[];for(var F in S)I.push('<input type="hidden" name="'+F+'" value="'+S[F]+'" />');var D,R=['<div style="padding:20px;">','<div class="tabs"></div>','<div class="tab1" style="display:none;">','<div class="ke-dialog-row">','<label for="remoteUrl" style="width:60px;">'+T.remoteUrl+"</label>",'<input type="text" id="remoteUrl" class="ke-input-text" name="url" value="" style="width:200px;" /> &nbsp;','<span class="ke-button-common ke-button-outer">','<input type="button" class="ke-button-common ke-button" name="viewServer" value="'+T.viewServer+'" />',"</span>","</div>",'<div class="ke-dialog-row">','<label for="remoteWidth" style="width:60px;">'+T.size+"</label>",T.width+' <input type="text" id="remoteWidth" class="ke-input-text ke-input-number" name="width" value="" maxlength="4" /> ',T.height+' <input type="text" class="ke-input-text ke-input-number" name="height" value="" maxlength="4" /> ','<img class="ke-refresh-btn" src="'+w+'refresh.png" width="16" height="16" alt="" style="cursor:pointer;" title="'+T.resetSize+'" />',"</div>",'<div class="ke-dialog-row">','<label style="width:60px;">'+T.align+"</label>",'<input type="radio" name="align" class="ke-inline-block" value="" checked="checked" /> <img name="defaultImg" src="'+w+'align_top.gif" width="23" height="25" alt="" />',' <input type="radio" name="align" class="ke-inline-block" value="left" /> <img name="leftImg" src="'+w+'align_left.gif" width="23" height="25" alt="" />',' <input type="radio" name="align" class="ke-inline-block" value="right" /> <img name="rightImg" src="'+w+'align_right.gif" width="23" height="25" alt="" />',"</div>",'<div class="ke-dialog-row">','<label for="remoteTitle" style="width:60px;">'+T.imgTitle+"</label>",'<input type="text" id="remoteTitle" class="ke-input-text" name="title" value="" style="width:200px;" />',"</div>","</div>",'<div class="tab2" style="display:none;">','<iframe name="'+N+'" style="display:none;"></iframe>','<form class="ke-upload-area ke-form" method="post" enctype="multipart/form-data" target="'+N+'" action="'+a.addParam(y,"dir=image")+'">','<div class="ke-dialog-row">',I.join(""),'<label style="width:60px;">'+T.localUrl+"</label>",'<input type="text" name="localUrl" class="ke-input-text" tabindex="-1" style="width:200px;" readonly="true" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+T.upload+'" />',"</div>","</form>","</div>","</div>"].join(""),M=K||b?450:400,P=K&&k?300:250,B=c.createDialog({name:h,width:M,height:P,title:c.lang(h),body:R,yesBtn:{name:c.lang("yes"),click:function(){if(!B.isLoading){if(K&&k&&D&&1===D.selectedIndex||!k)return""==Q.fileBox.val()?void alert(c.lang("pleaseSelectFile")):(B.showLoading(c.lang("uploadLoading")),Q.submit(),void W.val(""));var h=a.trim(O.val()),g=z.val(),v=j.val(),_=G.val(),b="";return $.each(function(){return this.checked?(b=this.value,!1):void 0}),"http://"==h||a.invalidUrl(h)?(alert(c.lang("invalidUrl")),void O[0].focus()):/^\d*$/.test(g)?/^\d*$/.test(v)?void A.call(c,h,_,g,v,0,b):(alert(c.lang("invalidHeight")),void j[0].focus()):(alert(c.lang("invalidWidth")),void z[0].focus())}}},beforeRemove:function(){H.unbind(),z.unbind(),j.unbind(),V.unbind()}}),L=B.div,O=a('[name="url"]',L),W=a('[name="localUrl"]',L),H=a('[name="viewServer"]',L),z=a('.tab1 [name="width"]',L),j=a('.tab1 [name="height"]',L),V=a(".ke-refresh-btn",L),G=a('.tab1 [name="title"]',L),$=a('.tab1 [name="align"]',L);k&&K?(D=a.tabs({src:a(".tabs",L),afterSelect:function(){}}),D.add({title:T.remoteImage,panel:a(".tab1",L)}),D.add({title:T.localImage,panel:a(".tab2",L)}),D.select(U)):k?a(".tab1",L).show():K&&a(".tab2",L).show();var Q=a.uploadbutton({button:a(".ke-upload-button",L)[0],fieldName:E,form:a(".ke-form",L),target:N,width:60,afterUpload:function(g){if(B.hideLoading(),0===g.error){var v=g.url;_&&(v=a.formatUrl(v,"absolute")),c.afterUpload&&c.afterUpload.call(c,v,g,h),C?(a(".ke-dialog-row #remoteUrl",L).val(v),a(".ke-tabs-li",L)[0].click(),a(".ke-refresh-btn",L).click()):A.call(c,v,g.title,g.width,g.height,g.border,g.align)}else alert(g.message)},afterError:function(a){B.hideLoading(),c.errorDialog(a)}});Q.fileBox.change(function(){W.val(Q.fileBox.val())}),b?H.click(function(){c.loadPlugin("filemanager",function(){c.plugin.filemanagerDialog({viewType:"VIEW",dirName:"image",clickFn:function(h){c.dialogs.length>1&&(a('[name="url"]',L).val(h),c.afterSelectFile&&c.afterSelectFile.call(c,h),c.hideDialog())}})})}):H.hide();var Y=0,X=0;return V.click(function(){var c=a('<img src="'+O.val()+'" />',document).css({position:"absolute",visibility:"hidden",top:0,left:"-1000px"});c.bind("load",function(){v(c.width(),c.height()),c.remove()}),a(document.body).append(c)}),z.change(function(){Y>0&&j.val(Math.round(X/Y*parseInt(this.value,10)))}),j.change(function(){X>0&&z.val(Math.round(Y/X*parseInt(this.value,10)))}),O.val(g.imageUrl),v(g.imageWidth,g.imageHeight),G.val(g.imageTitle),$.each(function(){return this.value===g.imageAlign?(this.checked=!0,!1):void 0}),k&&0===U&&(O[0].focus(),O[0].select()),B},c.plugin.image={edit:function(){var a=c.plugin.getSelectedImage();c.plugin.imageDialog({imageUrl:a?a.attr("data-ke-src"):"http://",imageWidth:a?a.width():"",imageHeight:a?a.height():"",imageTitle:a?a.attr("title"):"",imageAlign:a?a.attr("align"):"",showRemote:v,showLocal:g,tabIndex:a?0:k,clickFn:function(h,g,v,_,b,y){a?(a.attr("src",h),a.attr("data-ke-src",h),a.attr("width",v),a.attr("height",_),a.attr("title",g),a.attr("align",y),a.attr("alt",g)):c.exec("insertimage",h,g,v,_,b,y),setTimeout(function(){c.hideDialog().focus()},0)}})},"delete":function(){var a=c.plugin.getSelectedImage();"a"==a.parent().name&&(a=a.parent()),a.remove(),c.addBookmark()}},c.clickToolbar(h,c.plugin.image.edit)}),KindEditor.plugin("insertfile",function(a){var c=this,h="insertfile",g=a.undef(c.allowFileUpload,!0),v=a.undef(c.allowFileManager,!1),_=a.undef(c.formatUploadUrl,!0),b=a.undef(c.uploadJson,c.basePath+"php/upload_json.php"),y=a.undef(c.extraFileUploadParams,{}),k=a.undef(c.filePostName,"imgFile"),w=c.lang(h+".");c.plugin.fileDialog=function(S){var E=a.undef(S.fileUrl,"http://"),C=a.undef(S.fileTitle,""),T=S.clickFn,K=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keUrl" style="width:60px;">'+w.url+"</label>",'<input type="text" id="keUrl" name="url" class="ke-input-text" style="width:160px;" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+w.upload+'" /> &nbsp;','<span class="ke-button-common ke-button-outer">','<input type="button" class="ke-button-common ke-button" name="viewServer" value="'+w.viewServer+'" />',"</span>","</div>",'<div class="ke-dialog-row">','<label for="keTitle" style="width:60px;">'+w.title+"</label>",'<input type="text" id="keTitle" class="ke-input-text" name="title" value="" style="width:160px;" /></div>',"</div>","</form>","</div>"].join(""),U=c.createDialog({name:h,width:450,title:c.lang(h),body:K,yesBtn:{name:c.lang("yes"),click:function(){var h=a.trim(N.val()),g=F.val();return"http://"==h||a.invalidUrl(h)?(alert(c.lang("invalidUrl")),void N[0].focus()):(""===a.trim(g)&&(g=h),void T.call(c,h,g))}}}),A=U.div,N=a('[name="url"]',A),I=a('[name="viewServer"]',A),F=a('[name="title"]',A);if(g){var D=a.uploadbutton({button:a(".ke-upload-button",A)[0],fieldName:k,url:a.addParam(b,"dir=file"),extraParams:y,afterUpload:function(g){if(U.hideLoading(),0===g.error){var v=g.url;
_&&(v=a.formatUrl(v,"absolute")),N.val(v),c.afterUpload&&c.afterUpload.call(c,v,g,h),alert(c.lang("uploadSuccess"))}else alert(g.message)},afterError:function(a){U.hideLoading(),c.errorDialog(a)}});D.fileBox.change(function(){U.showLoading(c.lang("uploadLoading")),D.submit()})}else a(".ke-upload-button",A).hide();v?I.click(function(){c.loadPlugin("filemanager",function(){c.plugin.filemanagerDialog({viewType:"LIST",dirName:"file",clickFn:function(h){c.dialogs.length>1&&(a('[name="url"]',A).val(h),c.afterSelectFile&&c.afterSelectFile.call(c,h),c.hideDialog())}})})}):I.hide(),N.val(E),F.val(C),N[0].focus(),N[0].select()},c.clickToolbar(h,function(){c.plugin.fileDialog({clickFn:function(a,h){var g='<a class="ke-insertfile" href="'+a+'" data-ke-src="'+a+'" target="_blank">'+h+"</a>";c.insertHtml(g).hideDialog().focus()}})})}),KindEditor.plugin("lineheight",function(a){var c=this,h="lineheight",g=c.lang(h+".");c.clickToolbar(h,function(){var v="",_=c.cmd.commonNode({"*":".line-height"});_&&(v=_.css("line-height"));var b=c.createMenu({name:h,width:150});a.each(g.lineHeight,function(i,h){a.each(h,function(a,h){b.addItem({title:h,checked:v===a,click:function(){c.cmd.toggle('<span style="line-height:'+a+';"></span>',{span:".line-height="+a}),c.updateState(),c.addBookmark(),c.hideMenu()}})})})})}),KindEditor.plugin("link",function(a){var c=this,h="link";c.plugin.link={edit:function(){var g=c.lang(h+"."),v='<div style="padding:20px;"><div class="ke-dialog-row"><label for="keUrl" style="width:60px;">'+g.url+'</label><input class="ke-input-text" type="text" id="keUrl" name="url" value="" style="width:260px;" /></div><div class="ke-dialog-row""><label for="keType" style="width:60px;">'+g.linkType+'</label><select id="keType" name="type"></select></div></div>',_=c.createDialog({name:h,width:450,title:c.lang(h),body:v,yesBtn:{name:c.lang("yes"),click:function(){var h=a.trim(y.val());return"http://"==h||a.invalidUrl(h)?(alert(c.lang("invalidUrl")),void y[0].focus()):void c.exec("createlink",h,k.val()).hideDialog().focus()}}}),b=_.div,y=a('input[name="url"]',b),k=a('select[name="type"]',b);y.val("http://"),k[0].options[0]=new Option(g.newWindow,"_blank"),k[0].options[1]=new Option(g.selfWindow,""),c.cmd.selection();var w=c.plugin.getSelectedLink();w&&(c.cmd.range.selectNode(w[0]),c.cmd.select(),y.val(w.attr("data-ke-src")),k.val(w.attr("target"))),y[0].focus(),y[0].select()},"delete":function(){c.exec("unlink",null)}},c.clickToolbar(h,c.plugin.link.edit)}),KindEditor.plugin("map",function(a){var c=this,h="map",g=c.lang(h+".");c.clickToolbar(h,function(){function v(){_=C[0].contentWindow,b=a.iframeDoc(C)}var _,b,y=['<div style="padding:10px 20px;">','<div class="ke-dialog-row">',g.address+' <input id="kindeditor_plugin_map_address" name="address" class="ke-input-text" value="" style="width:200px;" /> ','<span class="ke-button-common ke-button-outer">','<input type="button" name="searchBtn" class="ke-button-common ke-button" value="'+g.search+'" />',"</span>","</div>",'<div class="ke-map" style="width:558px;height:360px;"></div>',"</div>"].join(""),k=c.createDialog({name:h,width:600,title:c.lang(h),body:y,yesBtn:{name:c.lang("yes"),click:function(){var a=(_.geocoder,_.map),h=a.getCenter().lat()+","+a.getCenter().lng(),g=a.getZoom(),v=a.getMapTypeId(),b="http://maps.googleapis.com/maps/api/staticmap";b+="?center="+encodeURIComponent(h),b+="&zoom="+encodeURIComponent(g),b+="&size=558x360",b+="&maptype="+encodeURIComponent(v),b+="&markers="+encodeURIComponent(h),b+="&language="+c.langType,b+="&sensor=false",c.exec("insertimage",b).hideDialog().focus()}},beforeRemove:function(){E.remove(),b&&b.write(""),C.remove()}}),w=k.div,S=a('[name="address"]',w),E=a('[name="searchBtn"]',w),C=(["<!doctype html><html><head>",'<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />',"<style>","	html { height: 100% }","	body { height: 100%; margin: 0; padding: 0; background-color: #FFF }","	#map_canvas { height: 100% }","</style>",'<script src="http://maps.googleapis.com/maps/api/js?sensor=false&language='+c.langType+'"></script>',"<script>","var map, geocoder;","function initialize() {","	var latlng = new google.maps.LatLng(31.230393, 121.473704);","	var options = {","		zoom: 11,","		center: latlng,","		disableDefaultUI: true,","		panControl: true,","		zoomControl: true,","		mapTypeControl: true,","		scaleControl: true,","		streetViewControl: false,","		overviewMapControl: true,","		mapTypeId: google.maps.MapTypeId.ROADMAP","	};",'	map = new google.maps.Map(document.getElementById("map_canvas"), options);',"	geocoder = new google.maps.Geocoder();","	geocoder.geocode({latLng: latlng}, function(results, status) {","		if (status == google.maps.GeocoderStatus.OK) {","			if (results[3]) {",'				parent.document.getElementById("kindeditor_plugin_map_address").value = results[3].formatted_address;',"			}","		}","	});","}","function search(address) {","	if (!map) return;","	geocoder.geocode({address : address}, function(results, status) {","		if (status == google.maps.GeocoderStatus.OK) {","			map.setZoom(11);","			map.setCenter(results[0].geometry.location);","			var marker = new google.maps.Marker({","				map: map,","				position: results[0].geometry.location","			});","		} else {",'			alert("Invalid address: " + address);',"		}","	});","}","</script>","</head>",'<body onload="initialize();">','<div id="map_canvas" style="width:100%; height:100%"></div>',"</body></html>"].join("\n"),a('<iframe class="ke-textarea" frameborder="0" src="'+c.pluginsPath+'map/map.html" style="width:558px;height:360px;"></iframe>'));C.bind("load",function(){C.unbind("load"),a.IE?v():setTimeout(v,0)}),a(".ke-map",w).replaceWith(C),E.click(function(){_.search(S.val())})})}),KindEditor.plugin("media",function(a){var c=this,h="media",g=c.lang(h+"."),v=a.undef(c.allowMediaUpload,!0),_=a.undef(c.allowFileManager,!1),b=a.undef(c.formatUploadUrl,!0),y=a.undef(c.extraFileUploadParams,{}),k=a.undef(c.filePostName,"imgFile"),w=a.undef(c.uploadJson,c.basePath+"php/upload_json.php");c.plugin.media={edit:function(){var S=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keUrl" style="width:60px;">'+g.url+"</label>",'<input class="ke-input-text" type="text" id="keUrl" name="url" value="" style="width:160px;" /> &nbsp;','<input type="button" class="ke-upload-button" value="'+g.upload+'" /> &nbsp;','<span class="ke-button-common ke-button-outer">','<input type="button" class="ke-button-common ke-button" name="viewServer" value="'+g.viewServer+'" />',"</span>","</div>",'<div class="ke-dialog-row">','<label for="keWidth" style="width:60px;">'+g.width+"</label>",'<input type="text" id="keWidth" class="ke-input-text ke-input-number" name="width" value="550" maxlength="4" />',"</div>",'<div class="ke-dialog-row">','<label for="keHeight" style="width:60px;">'+g.height+"</label>",'<input type="text" id="keHeight" class="ke-input-text ke-input-number" name="height" value="400" maxlength="4" />',"</div>",'<div class="ke-dialog-row">','<label for="keAutostart">'+g.autostart+"</label>",'<input type="checkbox" id="keAutostart" name="autostart" value="" /> ',"</div>","</div>"].join(""),E=c.createDialog({name:h,width:450,height:230,title:c.lang(h),body:S,yesBtn:{name:c.lang("yes"),click:function(){var h=a.trim(T.val()),g=U.val(),v=A.val();if("http://"==h||a.invalidUrl(h))return alert(c.lang("invalidUrl")),void T[0].focus();if(!/^\d*$/.test(g))return alert(c.lang("invalidWidth")),void U[0].focus();if(!/^\d*$/.test(v))return alert(c.lang("invalidHeight")),void A[0].focus();var _=a.mediaImg(c.themesPath+"common/blank.gif",{src:h,type:a.mediaType(h),width:g,height:v,autostart:N[0].checked?"true":"false",loop:"true"});c.insertHtml(_).hideDialog().focus()}}}),C=E.div,T=a('[name="url"]',C),K=a('[name="viewServer"]',C),U=a('[name="width"]',C),A=a('[name="height"]',C),N=a('[name="autostart"]',C);if(T.val("http://"),v){var I=a.uploadbutton({button:a(".ke-upload-button",C)[0],fieldName:k,extraParams:y,url:a.addParam(w,"dir=media"),afterUpload:function(g){if(E.hideLoading(),0===g.error){var v=g.url;b&&(v=a.formatUrl(v,"absolute")),T.val(v),c.afterUpload&&c.afterUpload.call(c,v,g,h),alert(c.lang("uploadSuccess"))}else alert(g.message)},afterError:function(a){E.hideLoading(),c.errorDialog(a)}});I.fileBox.change(function(){E.showLoading(c.lang("uploadLoading")),I.submit()})}else a(".ke-upload-button",C).hide();_?K.click(function(){c.loadPlugin("filemanager",function(){c.plugin.filemanagerDialog({viewType:"LIST",dirName:"media",clickFn:function(h){c.dialogs.length>1&&(a('[name="url"]',C).val(h),c.afterSelectFile&&c.afterSelectFile.call(c,h),c.hideDialog())}})})}):K.hide();var F=c.plugin.getSelectedMedia();if(F){var D=a.mediaAttrs(F.attr("data-ke-tag"));T.val(D.src),U.val(a.removeUnit(F.css("width"))||D.width||0),A.val(a.removeUnit(F.css("height"))||D.height||0),N[0].checked="true"===D.autostart}T[0].focus(),T[0].select()},"delete":function(){c.plugin.getSelectedMedia().remove(),c.addBookmark()}},c.clickToolbar(h,c.plugin.media.edit)}),function(a){function c(a){this.init(a)}a.extend(c,{init:function(c){function h(c,h){a(".ke-status > div",c).hide(),a(".ke-message",c).addClass("ke-error").show().html(a.escape(h))}var g=this;c.afterError=c.afterError||function(a){alert(a)},g.options=c,g.progressbars={},g.div=a(c.container).html(['<div class="ke-swfupload">','<div class="ke-swfupload-top">','<div class="ke-inline-block ke-swfupload-button">','<input type="button" value="Browse" />',"</div>",'<div class="ke-inline-block ke-swfupload-desc">'+c.uploadDesc+"</div>",'<span class="ke-button-common ke-button-outer ke-swfupload-startupload">','<input type="button" class="ke-button-common ke-button" value="'+c.startButtonValue+'" />',"</span>","</div>",'<div class="ke-swfupload-body"></div>',"</div>"].join("")),g.bodyDiv=a(".ke-swfupload-body",g.div);var v={debug:!1,upload_url:c.uploadUrl,flash_url:c.flashUrl,file_post_name:c.filePostName,button_placeholder:a(".ke-swfupload-button > input",g.div)[0],button_image_url:c.buttonImageUrl,button_width:c.buttonWidth,button_height:c.buttonHeight,button_cursor:SWFUpload.CURSOR.HAND,file_types:c.fileTypes,file_types_description:c.fileTypesDesc,file_upload_limit:c.fileUploadLimit,file_size_limit:c.fileSizeLimit,post_params:c.postParams,file_queued_handler:function(a){a.url=g.options.fileIconUrl,g.appendFile(a)},file_queue_error_handler:function(h,g){var v="";switch(g){case SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED:v=c.queueLimitExceeded;break;case SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT:v=c.fileExceedsSizeLimit;break;case SWFUpload.QUEUE_ERROR.ZERO_BYTE_FILE:v=c.zeroByteFile;break;case SWFUpload.QUEUE_ERROR.INVALID_FILETYPE:v=c.invalidFiletype;break;default:v=c.unknownError}a.DEBUG&&alert(v)},upload_start_handler:function(c){var h=this,g=a('div[data-id="'+c.id+'"]',h.bodyDiv);a(".ke-status > div",g).hide(),a(".ke-progressbar",g).show()},upload_progress_handler:function(a,c,h){var v=Math.round(100*c/h),_=g.progressbars[a.id];_.bar.css("width",Math.round(80*v/100)+"px"),_.percent.html(v+"%")},upload_error_handler:function(c){if(c&&c.filestatus==SWFUpload.FILE_STATUS.ERROR){var v=a('div[data-id="'+c.id+'"]',g.bodyDiv).eq(0);h(v,g.options.errorMessage)}},upload_success_handler:function(c,v){var _=a('div[data-id="'+c.id+'"]',g.bodyDiv).eq(0),b={};try{b=a.json(v)}catch(e){g.options.afterError.call(this,"<!doctype html><html>"+v+"</html>")}return 0!==b.error?void h(_,a.DEBUG?b.message:g.options.errorMessage):(c.url=b.url,a(".ke-img",_).attr("src",c.url).attr("data-status",c.filestatus).data("data",b),void a(".ke-status > div",_).hide())}};g.swfu=new SWFUpload(v),a(".ke-swfupload-startupload input",g.div).click(function(){g.swfu.startUpload()})},getUrlList:function(){var c=[];return a(".ke-img",self.bodyDiv).each(function(){var h=a(this),g=h.attr("data-status");g==SWFUpload.FILE_STATUS.COMPLETE&&c.push(h.data("data"))}),c},removeFile:function(c){var h=this;h.swfu.cancelUpload(c);var g=a('div[data-id="'+c+'"]',h.bodyDiv);a(".ke-photo",g).unbind(),a(".ke-delete",g).unbind(),g.remove()},removeFiles:function(){var c=this;a(".ke-item",c.bodyDiv).each(function(){c.removeFile(a(this).attr("data-id"))})},appendFile:function(c){var h=this,g=a('<div class="ke-inline-block ke-item" data-id="'+c.id+'"></div>');h.bodyDiv.append(g);var v=a('<div class="ke-inline-block ke-photo"></div>').mouseover(function(){a(this).addClass("ke-on")}).mouseout(function(){a(this).removeClass("ke-on")});g.append(v);var _=a('<img src="'+c.url+'" class="ke-img" data-status="'+c.filestatus+'" width="80" height="80" alt="'+c.name+'" />');v.append(_),a('<span class="ke-delete"></span>').appendTo(v).click(function(){h.removeFile(c.id)});var b=a('<div class="ke-status"></div>').appendTo(v);a(['<div class="ke-progressbar">','<div class="ke-progressbar-bar"><div class="ke-progressbar-bar-inner"></div></div>','<div class="ke-progressbar-percent">0%</div></div>'].join("")).hide().appendTo(b),a('<div class="ke-message">'+h.options.pendingMessage+"</div>").appendTo(b),g.append('<div class="ke-name">'+c.name+"</div>"),h.progressbars[c.id]={bar:a(".ke-progressbar-bar-inner",v),percent:a(".ke-progressbar-percent",v)}},remove:function(){this.removeFiles(),this.swfu.destroy(),this.div.html("")}}),a.swfupload=function(a,h){return new c(a,h)}}(KindEditor),KindEditor.plugin("multiimage",function(a){var c=this,h="multiimage",g=(a.undef(c.formatUploadUrl,!0),a.undef(c.uploadJson,c.basePath+"php/upload_json.php")),v=c.pluginsPath+"multiimage/images/",_=a.undef(c.imageSizeLimit,"1MB"),b=(a.undef(c.imageFileTypes,"*.jpg;*.gif;*.png"),a.undef(c.imageUploadLimit,20)),y=a.undef(c.filePostName,"imgFile"),k=c.lang(h+".");c.plugin.multiImageDialog=function(w){var S=w.clickFn,E=a.tmpl(k.uploadDesc,{uploadLimit:b,sizeLimit:_}),C=['<div style="padding:20px;">','<div class="swfupload">',"</div>","</div>"].join(""),T=c.createDialog({name:h,width:650,height:510,title:c.lang(h),body:C,previewBtn:{name:k.insertAll,click:function(){S.call(c,U.getUrlList())}},yesBtn:{name:k.clearAll,click:function(){U.removeFiles()}},beforeRemove:function(){(!a.IE||a.V<=8)&&U.remove()}}),K=T.div,U=a.swfupload({container:a(".swfupload",K),buttonImageUrl:v+("zh_CN"==c.langType?"select-files-zh_CN.png":"select-files-en.png"),buttonWidth:"zh_CN"==c.langType?72:88,buttonHeight:23,fileIconUrl:v+"image.png",uploadDesc:E,startButtonValue:k.startUpload,uploadUrl:a.addParam(g,"dir=image"),flashUrl:v+"swfupload.swf",filePostName:y,fileTypes:"*.jpg;*.jpeg;*.gif;*.png;*.bmp",fileTypesDesc:"Image Files",fileUploadLimit:b,fileSizeLimit:_,postParams:a.undef(c.extraFileUploadParams,{}),queueLimitExceeded:k.queueLimitExceeded,fileExceedsSizeLimit:k.fileExceedsSizeLimit,zeroByteFile:k.zeroByteFile,invalidFiletype:k.invalidFiletype,unknownError:k.unknownError,pendingMessage:k.pending,errorMessage:k.uploadError,afterError:function(a){c.errorDialog(a)}});return T},c.clickToolbar(h,function(){c.plugin.multiImageDialog({clickFn:function(h){0!==h.length&&(a.each(h,function(i,a){c.afterUpload&&c.afterUpload.call(c,a.url,a,"multiimage"),c.exec("insertimage",a.url,a.title,a.width,a.height,a.border,a.align)}),setTimeout(function(){c.hideDialog().focus()},0))}})})}),function(){window.SWFUpload=function(a){this.initSWFUpload(a)},SWFUpload.prototype.initSWFUpload=function(a){try{this.customSettings={},this.settings=a,this.eventQueue=[],this.movieName="KindEditor_SWFUpload_"+SWFUpload.movieCount++,this.movieElement=null,SWFUpload.instances[this.movieName]=this,this.initSettings(),this.loadFlash(),this.displayDebugInfo()}catch(ex){throw delete SWFUpload.instances[this.movieName],ex}},SWFUpload.instances={},SWFUpload.movieCount=0,SWFUpload.version="2.2.0 2009-03-25",SWFUpload.QUEUE_ERROR={QUEUE_LIMIT_EXCEEDED:-100,FILE_EXCEEDS_SIZE_LIMIT:-110,ZERO_BYTE_FILE:-120,INVALID_FILETYPE:-130},SWFUpload.UPLOAD_ERROR={HTTP_ERROR:-200,MISSING_UPLOAD_URL:-210,IO_ERROR:-220,SECURITY_ERROR:-230,UPLOAD_LIMIT_EXCEEDED:-240,UPLOAD_FAILED:-250,SPECIFIED_FILE_ID_NOT_FOUND:-260,FILE_VALIDATION_FAILED:-270,FILE_CANCELLED:-280,UPLOAD_STOPPED:-290},SWFUpload.FILE_STATUS={QUEUED:-1,IN_PROGRESS:-2,ERROR:-3,COMPLETE:-4,CANCELLED:-5},SWFUpload.BUTTON_ACTION={SELECT_FILE:-100,SELECT_FILES:-110,START_UPLOAD:-120},SWFUpload.CURSOR={ARROW:-1,HAND:-2},SWFUpload.WINDOW_MODE={WINDOW:"window",TRANSPARENT:"transparent",OPAQUE:"opaque"},SWFUpload.completeURL=function(a){if("string"!=typeof a||a.match(/^https?:\/\//i)||a.match(/^\//))return a;var c=(window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:""),window.location.pathname.lastIndexOf("/"));return path=0>=c?"/":window.location.pathname.substr(0,c)+"/",path+a},SWFUpload.prototype.initSettings=function(){this.ensureDefault=function(a,c){this.settings[a]=void 0==this.settings[a]?c:this.settings[a]},this.ensureDefault("upload_url",""),this.ensureDefault("preserve_relative_urls",!1),this.ensureDefault("file_post_name","Filedata"),this.ensureDefault("post_params",{}),this.ensureDefault("use_query_string",!1),this.ensureDefault("requeue_on_error",!1),this.ensureDefault("http_success",[]),this.ensureDefault("assume_success_timeout",0),this.ensureDefault("file_types","*.*"),this.ensureDefault("file_types_description","All Files"),this.ensureDefault("file_size_limit",0),this.ensureDefault("file_upload_limit",0),this.ensureDefault("file_queue_limit",0),this.ensureDefault("flash_url","swfupload.swf"),this.ensureDefault("prevent_swf_caching",!0),this.ensureDefault("button_image_url",""),this.ensureDefault("button_width",1),this.ensureDefault("button_height",1),this.ensureDefault("button_text",""),this.ensureDefault("button_text_style","color: #000000; font-size: 16pt;"),this.ensureDefault("button_text_top_padding",0),this.ensureDefault("button_text_left_padding",0),this.ensureDefault("button_action",SWFUpload.BUTTON_ACTION.SELECT_FILES),this.ensureDefault("button_disabled",!1),this.ensureDefault("button_placeholder_id",""),this.ensureDefault("button_placeholder",null),this.ensureDefault("button_cursor",SWFUpload.CURSOR.ARROW),this.ensureDefault("button_window_mode",SWFUpload.WINDOW_MODE.WINDOW),this.ensureDefault("debug",!1),this.settings.debug_enabled=this.settings.debug,this.settings.return_upload_start_handler=this.returnUploadStart,this.ensureDefault("swfupload_loaded_handler",null),this.ensureDefault("file_dialog_start_handler",null),this.ensureDefault("file_queued_handler",null),this.ensureDefault("file_queue_error_handler",null),this.ensureDefault("file_dialog_complete_handler",null),this.ensureDefault("upload_start_handler",null),this.ensureDefault("upload_progress_handler",null),this.ensureDefault("upload_error_handler",null),this.ensureDefault("upload_success_handler",null),this.ensureDefault("upload_complete_handler",null),this.ensureDefault("debug_handler",this.debugMessage),this.ensureDefault("custom_settings",{}),this.customSettings=this.settings.custom_settings,this.settings.prevent_swf_caching&&(this.settings.flash_url=this.settings.flash_url+(this.settings.flash_url.indexOf("?")<0?"?":"&")+"preventswfcaching="+(new Date).getTime()),this.settings.preserve_relative_urls||(this.settings.upload_url=SWFUpload.completeURL(this.settings.upload_url),this.settings.button_image_url=SWFUpload.completeURL(this.settings.button_image_url)),delete this.ensureDefault},SWFUpload.prototype.loadFlash=function(){var a,c;if(null!==document.getElementById(this.movieName))throw"ID "+this.movieName+" is already in use. The Flash Object could not be added";if(a=document.getElementById(this.settings.button_placeholder_id)||this.settings.button_placeholder,void 0==a)throw"Could not find the placeholder element: "+this.settings.button_placeholder_id;c=document.createElement("div"),c.innerHTML=this.getFlashHTML(),a.parentNode.replaceChild(c.firstChild,a),void 0==window[this.movieName]&&(window[this.movieName]=this.getMovieElement())},SWFUpload.prototype.getFlashHTML=function(){var a="";return KindEditor.IE&&KindEditor.V>8&&(a=' classid = "clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"'),['<object id="',this.movieName,'"'+a+' type="application/x-shockwave-flash" data="',this.settings.flash_url,'" width="',this.settings.button_width,'" height="',this.settings.button_height,'" class="swfupload">','<param name="wmode" value="',this.settings.button_window_mode,'" />','<param name="movie" value="',this.settings.flash_url,'" />','<param name="quality" value="high" />','<param name="menu" value="false" />','<param name="allowScriptAccess" value="always" />','<param name="flashvars" value="'+this.getFlashVars()+'" />',"</object>"].join("")},SWFUpload.prototype.getFlashVars=function(){var a=this.buildParamString(),c=this.settings.http_success.join(",");return["movieName=",encodeURIComponent(this.movieName),"&amp;uploadURL=",encodeURIComponent(this.settings.upload_url),"&amp;useQueryString=",encodeURIComponent(this.settings.use_query_string),"&amp;requeueOnError=",encodeURIComponent(this.settings.requeue_on_error),"&amp;httpSuccess=",encodeURIComponent(c),"&amp;assumeSuccessTimeout=",encodeURIComponent(this.settings.assume_success_timeout),"&amp;params=",encodeURIComponent(a),"&amp;filePostName=",encodeURIComponent(this.settings.file_post_name),"&amp;fileTypes=",encodeURIComponent(this.settings.file_types),"&amp;fileTypesDescription=",encodeURIComponent(this.settings.file_types_description),"&amp;fileSizeLimit=",encodeURIComponent(this.settings.file_size_limit),"&amp;fileUploadLimit=",encodeURIComponent(this.settings.file_upload_limit),"&amp;fileQueueLimit=",encodeURIComponent(this.settings.file_queue_limit),"&amp;debugEnabled=",encodeURIComponent(this.settings.debug_enabled),"&amp;buttonImageURL=",encodeURIComponent(this.settings.button_image_url),"&amp;buttonWidth=",encodeURIComponent(this.settings.button_width),"&amp;buttonHeight=",encodeURIComponent(this.settings.button_height),"&amp;buttonText=",encodeURIComponent(this.settings.button_text),"&amp;buttonTextTopPadding=",encodeURIComponent(this.settings.button_text_top_padding),"&amp;buttonTextLeftPadding=",encodeURIComponent(this.settings.button_text_left_padding),"&amp;buttonTextStyle=",encodeURIComponent(this.settings.button_text_style),"&amp;buttonAction=",encodeURIComponent(this.settings.button_action),"&amp;buttonDisabled=",encodeURIComponent(this.settings.button_disabled),"&amp;buttonCursor=",encodeURIComponent(this.settings.button_cursor)].join("")},SWFUpload.prototype.getMovieElement=function(){if(void 0==this.movieElement&&(this.movieElement=document.getElementById(this.movieName)),null===this.movieElement)throw"Could not find Flash element";return this.movieElement},SWFUpload.prototype.buildParamString=function(){var a=this.settings.post_params,c=[];if("object"==typeof a)for(var h in a)a.hasOwnProperty(h)&&c.push(encodeURIComponent(h.toString())+"="+encodeURIComponent(a[h].toString()));return c.join("&amp;")},SWFUpload.prototype.destroy=function(){try{this.cancelUpload(null,!1);var a=null;if(a=this.getMovieElement(),a&&"unknown"==typeof a.CallFunction){for(var i in a)try{"function"==typeof a[i]&&(a[i]=null)}catch(c){}try{a.parentNode.removeChild(a)}catch(ex){}}return window[this.movieName]=null,SWFUpload.instances[this.movieName]=null,delete SWFUpload.instances[this.movieName],this.movieElement=null,this.settings=null,this.customSettings=null,this.eventQueue=null,this.movieName=null,!0}catch(h){return!1}},SWFUpload.prototype.displayDebugInfo=function(){this.debug(["---SWFUpload Instance Info---\n","Version: ",SWFUpload.version,"\n","Movie Name: ",this.movieName,"\n","Settings:\n","	","upload_url:               ",this.settings.upload_url,"\n","	","flash_url:                ",this.settings.flash_url,"\n","	","use_query_string:         ",this.settings.use_query_string.toString(),"\n","	","requeue_on_error:         ",this.settings.requeue_on_error.toString(),"\n","	","http_success:             ",this.settings.http_success.join(", "),"\n","	","assume_success_timeout:   ",this.settings.assume_success_timeout,"\n","	","file_post_name:           ",this.settings.file_post_name,"\n","	","post_params:              ",this.settings.post_params.toString(),"\n","	","file_types:               ",this.settings.file_types,"\n","	","file_types_description:   ",this.settings.file_types_description,"\n","	","file_size_limit:          ",this.settings.file_size_limit,"\n","	","file_upload_limit:        ",this.settings.file_upload_limit,"\n","	","file_queue_limit:         ",this.settings.file_queue_limit,"\n","	","debug:                    ",this.settings.debug.toString(),"\n","	","prevent_swf_caching:      ",this.settings.prevent_swf_caching.toString(),"\n","	","button_placeholder_id:    ",this.settings.button_placeholder_id.toString(),"\n","	","button_placeholder:       ",this.settings.button_placeholder?"Set":"Not Set","\n","	","button_image_url:         ",this.settings.button_image_url.toString(),"\n","	","button_width:             ",this.settings.button_width.toString(),"\n","	","button_height:            ",this.settings.button_height.toString(),"\n","	","button_text:              ",this.settings.button_text.toString(),"\n","	","button_text_style:        ",this.settings.button_text_style.toString(),"\n","	","button_text_top_padding:  ",this.settings.button_text_top_padding.toString(),"\n","	","button_text_left_padding: ",this.settings.button_text_left_padding.toString(),"\n","	","button_action:            ",this.settings.button_action.toString(),"\n","	","button_disabled:          ",this.settings.button_disabled.toString(),"\n","	","custom_settings:          ",this.settings.custom_settings.toString(),"\n","Event Handlers:\n","	","swfupload_loaded_handler assigned:  ",("function"==typeof this.settings.swfupload_loaded_handler).toString(),"\n","	","file_dialog_start_handler assigned: ",("function"==typeof this.settings.file_dialog_start_handler).toString(),"\n","	","file_queued_handler assigned:       ",("function"==typeof this.settings.file_queued_handler).toString(),"\n","	","file_queue_error_handler assigned:  ",("function"==typeof this.settings.file_queue_error_handler).toString(),"\n","	","upload_start_handler assigned:      ",("function"==typeof this.settings.upload_start_handler).toString(),"\n","	","upload_progress_handler assigned:   ",("function"==typeof this.settings.upload_progress_handler).toString(),"\n","	","upload_error_handler assigned:      ",("function"==typeof this.settings.upload_error_handler).toString(),"\n","	","upload_success_handler assigned:    ",("function"==typeof this.settings.upload_success_handler).toString(),"\n","	","upload_complete_handler assigned:   ",("function"==typeof this.settings.upload_complete_handler).toString(),"\n","	","debug_handler assigned:             ",("function"==typeof this.settings.debug_handler).toString(),"\n"].join(""))},SWFUpload.prototype.addSetting=function(a,c,h){return this.settings[a]=void 0==c?h:c},SWFUpload.prototype.getSetting=function(a){return void 0!=this.settings[a]?this.settings[a]:""},SWFUpload.prototype.callFlash=function(functionName,argumentArray){argumentArray=argumentArray||[];var movieElement=this.getMovieElement(),returnValue,returnString;try{returnString=movieElement.CallFunction('<invoke name="'+functionName+'" returntype="javascript">'+__flash__argumentsToXML(argumentArray,0)+"</invoke>"),returnValue=eval(returnString)}catch(ex){throw"Call to "+functionName+" failed"}return void 0!=returnValue&&"object"==typeof returnValue.post&&(returnValue=this.unescapeFilePostParams(returnValue)),returnValue},SWFUpload.prototype.selectFile=function(){this.callFlash("SelectFile")},SWFUpload.prototype.selectFiles=function(){this.callFlash("SelectFiles")},SWFUpload.prototype.startUpload=function(a){this.callFlash("StartUpload",[a])},SWFUpload.prototype.cancelUpload=function(a,c){c!==!1&&(c=!0),this.callFlash("CancelUpload",[a,c])},SWFUpload.prototype.stopUpload=function(){this.callFlash("StopUpload")},SWFUpload.prototype.getStats=function(){return this.callFlash("GetStats")},SWFUpload.prototype.setStats=function(a){this.callFlash("SetStats",[a])},SWFUpload.prototype.getFile=function(a){return"number"==typeof a?this.callFlash("GetFileByIndex",[a]):this.callFlash("GetFile",[a])},SWFUpload.prototype.addFileParam=function(a,c,h){return this.callFlash("AddFileParam",[a,c,h])},SWFUpload.prototype.removeFileParam=function(a,c){this.callFlash("RemoveFileParam",[a,c])},SWFUpload.prototype.setUploadURL=function(a){this.settings.upload_url=a.toString(),this.callFlash("SetUploadURL",[a])},SWFUpload.prototype.setPostParams=function(a){this.settings.post_params=a,this.callFlash("SetPostParams",[a])},SWFUpload.prototype.addPostParam=function(a,c){this.settings.post_params[a]=c,this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.removePostParam=function(a){delete this.settings.post_params[a],this.callFlash("SetPostParams",[this.settings.post_params])},SWFUpload.prototype.setFileTypes=function(a,c){this.settings.file_types=a,this.settings.file_types_description=c,this.callFlash("SetFileTypes",[a,c])},SWFUpload.prototype.setFileSizeLimit=function(a){this.settings.file_size_limit=a,this.callFlash("SetFileSizeLimit",[a])},SWFUpload.prototype.setFileUploadLimit=function(a){this.settings.file_upload_limit=a,this.callFlash("SetFileUploadLimit",[a])},SWFUpload.prototype.setFileQueueLimit=function(a){this.settings.file_queue_limit=a,this.callFlash("SetFileQueueLimit",[a])},SWFUpload.prototype.setFilePostName=function(a){this.settings.file_post_name=a,this.callFlash("SetFilePostName",[a])},SWFUpload.prototype.setUseQueryString=function(a){this.settings.use_query_string=a,this.callFlash("SetUseQueryString",[a])},SWFUpload.prototype.setRequeueOnError=function(a){this.settings.requeue_on_error=a,this.callFlash("SetRequeueOnError",[a])},SWFUpload.prototype.setHTTPSuccess=function(a){"string"==typeof a&&(a=a.replace(" ","").split(",")),this.settings.http_success=a,this.callFlash("SetHTTPSuccess",[a])},SWFUpload.prototype.setAssumeSuccessTimeout=function(a){this.settings.assume_success_timeout=a,this.callFlash("SetAssumeSuccessTimeout",[a])},SWFUpload.prototype.setDebugEnabled=function(a){this.settings.debug_enabled=a,this.callFlash("SetDebugEnabled",[a])},SWFUpload.prototype.setButtonImageURL=function(a){void 0==a&&(a=""),this.settings.button_image_url=a,this.callFlash("SetButtonImageURL",[a])},SWFUpload.prototype.setButtonDimensions=function(a,c){this.settings.button_width=a,this.settings.button_height=c;var h=this.getMovieElement();void 0!=h&&(h.style.width=a+"px",h.style.height=c+"px"),this.callFlash("SetButtonDimensions",[a,c])},SWFUpload.prototype.setButtonText=function(a){this.settings.button_text=a,this.callFlash("SetButtonText",[a])},SWFUpload.prototype.setButtonTextPadding=function(a,c){this.settings.button_text_top_padding=c,this.settings.button_text_left_padding=a,this.callFlash("SetButtonTextPadding",[a,c])},SWFUpload.prototype.setButtonTextStyle=function(a){this.settings.button_text_style=a,this.callFlash("SetButtonTextStyle",[a])},SWFUpload.prototype.setButtonDisabled=function(a){this.settings.button_disabled=a,this.callFlash("SetButtonDisabled",[a])},SWFUpload.prototype.setButtonAction=function(a){this.settings.button_action=a,this.callFlash("SetButtonAction",[a])},SWFUpload.prototype.setButtonCursor=function(a){this.settings.button_cursor=a,this.callFlash("SetButtonCursor",[a])},SWFUpload.prototype.queueEvent=function(a,c){void 0==c?c=[]:c instanceof Array||(c=[c]);var h=this;if("function"==typeof this.settings[a])this.eventQueue.push(function(){this.settings[a].apply(this,c)}),setTimeout(function(){h.executeNextEvent()},0);else if(null!==this.settings[a])throw"Event handler "+a+" is unknown or is not a function"},SWFUpload.prototype.executeNextEvent=function(){var f=this.eventQueue?this.eventQueue.shift():null;"function"==typeof f&&f.apply(this)},SWFUpload.prototype.unescapeFilePostParams=function(a){var c,h=/[$]([0-9a-f]{4})/i,g={};if(void 0!=a){for(var v in a.post)if(a.post.hasOwnProperty(v)){c=v;for(var _;null!==(_=h.exec(c));)c=c.replace(_[0],String.fromCharCode(parseInt("0x"+_[1],16)));
g[c]=a.post[v]}a.post=g}return a},SWFUpload.prototype.testExternalInterface=function(){try{return this.callFlash("TestExternalInterface")}catch(ex){return!1}},SWFUpload.prototype.flashReady=function(){var a=this.getMovieElement();return a?(this.cleanUp(a),void this.queueEvent("swfupload_loaded_handler")):void this.debug("Flash called back ready but the flash movie can't be found.")},SWFUpload.prototype.cleanUp=function(a){try{if(this.movieElement&&"unknown"==typeof a.CallFunction){this.debug("Removing Flash functions hooks (this should only run in IE and should prevent memory leaks)");for(var c in a)try{"function"==typeof a[c]&&(a[c]=null)}catch(ex){}}}catch(h){}window.__flash__removeCallback=function(a,c){try{a&&(a[c]=null)}catch(h){}}},SWFUpload.prototype.fileDialogStart=function(){this.queueEvent("file_dialog_start_handler")},SWFUpload.prototype.fileQueued=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("file_queued_handler",a)},SWFUpload.prototype.fileQueueError=function(a,c,h){a=this.unescapeFilePostParams(a),this.queueEvent("file_queue_error_handler",[a,c,h])},SWFUpload.prototype.fileDialogComplete=function(a,c,h){this.queueEvent("file_dialog_complete_handler",[a,c,h])},SWFUpload.prototype.uploadStart=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("return_upload_start_handler",a)},SWFUpload.prototype.returnUploadStart=function(a){var c;if("function"==typeof this.settings.upload_start_handler)a=this.unescapeFilePostParams(a),c=this.settings.upload_start_handler.call(this,a);else if(void 0!=this.settings.upload_start_handler)throw"upload_start_handler must be a function";void 0===c&&(c=!0),c=!!c,this.callFlash("ReturnUploadStart",[c])},SWFUpload.prototype.uploadProgress=function(a,c,h){a=this.unescapeFilePostParams(a),this.queueEvent("upload_progress_handler",[a,c,h])},SWFUpload.prototype.uploadError=function(a,c,h){a=this.unescapeFilePostParams(a),this.queueEvent("upload_error_handler",[a,c,h])},SWFUpload.prototype.uploadSuccess=function(a,c,h){a=this.unescapeFilePostParams(a),this.queueEvent("upload_success_handler",[a,c,h])},SWFUpload.prototype.uploadComplete=function(a){a=this.unescapeFilePostParams(a),this.queueEvent("upload_complete_handler",a)},SWFUpload.prototype.debug=function(a){this.queueEvent("debug_handler",a)},SWFUpload.prototype.debugMessage=function(a){if(this.settings.debug){var c,h=[];if("object"==typeof a&&"string"==typeof a.name&&"string"==typeof a.message){for(var g in a)a.hasOwnProperty(g)&&h.push(g+": "+a[g]);c=h.join("\n")||"",h=c.split("\n"),c="EXCEPTION: "+h.join("\nEXCEPTION: "),SWFUpload.Console.writeLine(c)}else SWFUpload.Console.writeLine(a)}},SWFUpload.Console={},SWFUpload.Console.writeLine=function(a){var c,h;try{c=document.getElementById("SWFUpload_Console"),c||(h=document.createElement("form"),document.getElementsByTagName("body")[0].appendChild(h),c=document.createElement("textarea"),c.id="SWFUpload_Console",c.style.fontFamily="monospace",c.setAttribute("wrap","off"),c.wrap="off",c.style.overflow="auto",c.style.width="700px",c.style.height="350px",c.style.margin="5px",h.appendChild(c)),c.value+=a+"\n",c.scrollTop=c.scrollHeight-c.clientHeight}catch(ex){alert("Exception: "+ex.name+" Message: "+ex.message)}}}(),function(){"function"==typeof SWFUpload&&(SWFUpload.queue={},SWFUpload.prototype.initSettings=function(a){return function(){"function"==typeof a&&a.call(this),this.queueSettings={},this.queueSettings.queue_cancelled_flag=!1,this.queueSettings.queue_upload_count=0,this.queueSettings.user_upload_complete_handler=this.settings.upload_complete_handler,this.queueSettings.user_upload_start_handler=this.settings.upload_start_handler,this.settings.upload_complete_handler=SWFUpload.queue.uploadCompleteHandler,this.settings.upload_start_handler=SWFUpload.queue.uploadStartHandler,this.settings.queue_complete_handler=this.settings.queue_complete_handler||null}}(SWFUpload.prototype.initSettings),SWFUpload.prototype.startUpload=function(a){this.queueSettings.queue_cancelled_flag=!1,this.callFlash("StartUpload",[a])},SWFUpload.prototype.cancelQueue=function(){this.queueSettings.queue_cancelled_flag=!0,this.stopUpload();for(var a=this.getStats();a.files_queued>0;)this.cancelUpload(),a=this.getStats()},SWFUpload.queue.uploadStartHandler=function(a){var c;return"function"==typeof this.queueSettings.user_upload_start_handler&&(c=this.queueSettings.user_upload_start_handler.call(this,a)),c=c===!1?!1:!0,this.queueSettings.queue_cancelled_flag=!c,c},SWFUpload.queue.uploadCompleteHandler=function(a){var c,h=this.queueSettings.user_upload_complete_handler;if(a.filestatus===SWFUpload.FILE_STATUS.COMPLETE&&this.queueSettings.queue_upload_count++,c="function"==typeof h?h.call(this,a)===!1?!1:!0:a.filestatus===SWFUpload.FILE_STATUS.QUEUED?!1:!0){var g=this.getStats();g.files_queued>0&&this.queueSettings.queue_cancelled_flag===!1?this.startUpload():this.queueSettings.queue_cancelled_flag===!1?(this.queueEvent("queue_complete_handler",[this.queueSettings.queue_upload_count]),this.queueSettings.queue_upload_count=0):(this.queueSettings.queue_cancelled_flag=!1,this.queueSettings.queue_upload_count=0)}})}(),KindEditor.plugin("pagebreak",function(a){var c=this,h="pagebreak",g=a.undef(c.pagebreakHtml,'<hr style="page-break-after: always;" class="ke-pagebreak" />');c.clickToolbar(h,function(){var h=c.cmd,v=h.range;c.focus();var _="br"==c.newlineTag||a.WEBKIT?"":'<span id="__kindeditor_tail_tag__"></span>';if(c.insertHtml(g+_),""!==_){var p=a("#__kindeditor_tail_tag__",c.edit.doc);v.selectNodeContents(p[0]),p.removeAttr("id"),h.select()}})}),KindEditor.plugin("plainpaste",function(a){var c=this,h="plainpaste";c.clickToolbar(h,function(){var g=c.lang(h+"."),v='<div style="padding:10px 20px;"><div style="margin-bottom:10px;">'+g.comment+'</div><textarea class="ke-textarea" style="width:408px;height:260px;"></textarea></div>',_=c.createDialog({name:h,width:450,title:c.lang(h),body:v,yesBtn:{name:c.lang("yes"),click:function(){var h=b.val();h=a.escape(h),h=h.replace(/ {2}/g," &nbsp;"),h="p"==c.newlineTag?h.replace(/^/,"<p>").replace(/$/,"</p>").replace(/\n/g,"</p><p>"):h.replace(/\n/g,"<br />$&"),c.insertHtml(h).hideDialog().focus()}}}),b=a("textarea",_.div);b[0].focus()})}),KindEditor.plugin("preview",function(a){var c=this,h="preview";c.clickToolbar(h,function(){var g=(c.lang(h+"."),'<div style="padding:10px 20px;"><iframe class="ke-textarea" frameborder="0" style="width:708px;height:400px;"></iframe></div>'),v=c.createDialog({name:h,width:750,title:c.lang(h),body:g}),_=a("iframe",v.div),b=a.iframeDoc(_);b.open(),b.write(c.fullHtml()),b.close(),a(b.body).css("background-color","#FFF"),_[0].contentWindow.focus()})}),KindEditor.plugin("quickformat",function(a){function c(a){for(var c=a.first();c&&c.first();)c=c.first();return c}var h=this,g="quickformat",v=a.toMap("blockquote,center,div,h1,h2,h3,h4,h5,h6,p");h.clickToolbar(g,function(){h.focus();for(var g,_=h.edit.doc,b=h.cmd.range,y=a(_.body).first(),k=[],w=[],S=b.createBookmark(!0);y;){g=y.next();var E=c(y);E&&"img"==E.name||(v[y.name]?(y.html(y.html().replace(/^(\s|&nbsp;|ã€€)+/gi,"")),y.css("text-indent","2em")):w.push(y),(!g||v[g.name]||v[y.name]&&!v[g.name])&&(w.length>0&&k.push(w),w=[])),y=g}a.each(k,function(i,c){var h=a('<p style="text-indent:2em;"></p>',_);c[0].before(h),a.each(c,function(i,a){h.append(a)})}),b.moveToBookmark(S),h.addBookmark()})}),KindEditor.plugin("table",function(a){function c(a,c){c=c.toUpperCase(),a.css("background-color",c),a.css("color","#000000"===c?"#FFFFFF":"#000000"),a.html(c)}function h(h,g){function _(){a.each(k,function(){this.remove()}),k=[],a(document).unbind("click,mousedown",_),h.unbind("click,mousedown",_)}g.bind("click,mousedown",function(e){e.stopPropagation()}),g.click(function(){_();var g=a(this),b=g.pos(),y=a.colorpicker({x:b.x,y:b.y+g.height(),z:811214,selectedColor:a(this).html(),colors:v.colorTable,noColor:v.lang("noColor"),shadowMode:v.shadowMode,click:function(a){c(g,a),_()}});k.push(y),a(document).bind("click,mousedown",_),h.bind("click,mousedown",_)})}function g(a,c,h){for(var g=0,i=0,v=c.cells.length;v>i&&c.cells[i]!=h;i++)g+=c.cells[i].rowSpan-1;return h.cellIndex-g}var v=this,_="table",b=v.lang(_+"."),y="ke-zeroborder",k=[];v.plugin.table={prop:function(g){var k=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keRows" style="width:90px;">'+b.cells+"</label>",b.rows+' <input type="text" id="keRows" class="ke-input-text ke-input-number" name="rows" value="" maxlength="4" /> &nbsp; ',b.cols+' <input type="text" class="ke-input-text ke-input-number" name="cols" value="" maxlength="4" />',"</div>",'<div class="ke-dialog-row">','<label for="keWidth" style="width:90px;">'+b.size+"</label>",b.width+' <input type="text" id="keWidth" class="ke-input-text ke-input-number" name="width" value="" maxlength="4" /> &nbsp; ','<select name="widthType">','<option value="%">'+b.percent+"</option>",'<option value="px">'+b.px+"</option>","</select> &nbsp; ",b.height+' <input type="text" class="ke-input-text ke-input-number" name="height" value="" maxlength="4" /> &nbsp; ','<select name="heightType">','<option value="%">'+b.percent+"</option>",'<option value="px">'+b.px+"</option>","</select>","</div>",'<div class="ke-dialog-row">','<label for="kePadding" style="width:90px;">'+b.space+"</label>",b.padding+' <input type="text" id="kePadding" class="ke-input-text ke-input-number" name="padding" value="" maxlength="4" /> &nbsp; ',b.spacing+' <input type="text" class="ke-input-text ke-input-number" name="spacing" value="" maxlength="4" />',"</div>",'<div class="ke-dialog-row">','<label for="keAlign" style="width:90px;">'+b.align+"</label>",'<select id="keAlign" name="align">','<option value="">'+b.alignDefault+"</option>",'<option value="left">'+b.alignLeft+"</option>",'<option value="center">'+b.alignCenter+"</option>",'<option value="right">'+b.alignRight+"</option>","</select>","</div>",'<div class="ke-dialog-row">','<label for="keBorder" style="width:90px;">'+b.border+"</label>",b.borderWidth+' <input type="text" id="keBorder" class="ke-input-text ke-input-number" name="border" value="" maxlength="4" /> &nbsp; ',b.borderColor+' <span class="ke-inline-block ke-input-color"></span>',"</div>",'<div class="ke-dialog-row">','<label for="keBgColor" style="width:90px;">'+b.backgroundColor+"</label>",'<span class="ke-inline-block ke-input-color"></span>',"</div>","</div>"].join(""),w=v.cmd.range.createBookmark(),S=v.createDialog({name:_,width:500,title:v.lang(_),body:k,beforeRemove:function(){M.unbind()},yesBtn:{name:v.lang("yes"),click:function(){var c=C.val(),h=T.val(),g=K.val(),_=U.val(),b=A.val(),k=N.val(),S=I.val(),E=F.val(),B=D.val(),L=R.val(),O=a(M[0]).html()||"",W=a(M[1]).html()||"";if(0==c||!/^\d+$/.test(c))return alert(v.lang("invalidRows")),void C[0].focus();if(0==h||!/^\d+$/.test(h))return alert(v.lang("invalidRows")),void T[0].focus();if(!/^\d*$/.test(g))return alert(v.lang("invalidWidth")),void K[0].focus();if(!/^\d*$/.test(_))return alert(v.lang("invalidHeight")),void U[0].focus();if(!/^\d*$/.test(S))return alert(v.lang("invalidPadding")),void I[0].focus();if(!/^\d*$/.test(E))return alert(v.lang("invalidSpacing")),void F[0].focus();if(!/^\d*$/.test(L))return alert(v.lang("invalidBorder")),void R[0].focus();if(P)return""!==g?P.width(g+b):P.css("width",""),void 0!==P[0].width&&P.removeAttr("width"),""!==_?P.height(_+k):P.css("height",""),void 0!==P[0].height&&P.removeAttr("height"),P.css("background-color",W),void 0!==P[0].bgColor&&P.removeAttr("bgColor"),""!==S?P[0].cellPadding=S:P.removeAttr("cellPadding"),""!==E?P[0].cellSpacing=E:P.removeAttr("cellSpacing"),""!==B?P[0].align=B:P.removeAttr("align"),""!==L?P.attr("border",L):P.removeAttr("border"),""===L||"0"===L?P.addClass(y):P.removeClass(y),""!==O?P.attr("borderColor",O):P.removeAttr("borderColor"),v.hideDialog().focus(),v.cmd.range.moveToBookmark(w),v.cmd.select(),void v.addBookmark();var H="";""!==g&&(H+="width:"+g+b+";"),""!==_&&(H+="height:"+_+k+";"),""!==W&&(H+="background-color:"+W+";");var z="<table";""!==H&&(z+=' style="'+H+'"'),""!==S&&(z+=' cellpadding="'+S+'"'),""!==E&&(z+=' cellspacing="'+E+'"'),""!==B&&(z+=' align="'+B+'"'),""!==L&&(z+=' border="'+L+'"'),(""===L||"0"===L)&&(z+=' class="'+y+'"'),""!==O&&(z+=' bordercolor="'+O+'"'),z+=">";for(var i=0;c>i;i++){z+="<tr>";for(var j=0;h>j;j++)z+="<td>"+(a.IE?"&nbsp;":"<br />")+"</td>";z+="</tr>"}z+="</table>",a.IE||(z+="<br />"),v.insertHtml(z),v.select().hideDialog().focus(),v.addBookmark()}}}),E=S.div,C=a('[name="rows"]',E).val(3),T=a('[name="cols"]',E).val(2),K=a('[name="width"]',E).val(100),U=a('[name="height"]',E),A=a('[name="widthType"]',E),N=a('[name="heightType"]',E),I=a('[name="padding"]',E).val(2),F=a('[name="spacing"]',E).val(0),D=a('[name="align"]',E),R=a('[name="border"]',E).val(1),M=a(".ke-input-color",E);h(E,M.eq(0)),h(E,M.eq(1)),c(M.eq(0),"#000000"),c(M.eq(1),""),C[0].focus(),C[0].select();var P;if(!g&&(P=v.plugin.getSelectedTable())){C.val(P[0].rows.length),T.val(P[0].rows.length>0?P[0].rows[0].cells.length:0),C.attr("disabled",!0),T.attr("disabled",!0);var B,L=P[0].style.width||P[0].width,O=P[0].style.height||P[0].height;void 0!==L&&(B=/^(\d+)((?:px|%)*)$/.exec(L))?(K.val(B[1]),A.val(B[2])):K.val(""),void 0!==O&&(B=/^(\d+)((?:px|%)*)$/.exec(O))&&(U.val(B[1]),N.val(B[2])),I.val(P[0].cellPadding||""),F.val(P[0].cellSpacing||""),D.val(P[0].align||""),R.val(void 0===P[0].border?"":P[0].border),c(M.eq(0),a.toHex(P.attr("borderColor")||"")),c(M.eq(1),a.toHex(P[0].style.backgroundColor||P[0].bgColor||"")),K[0].focus(),K[0].select()}},cellprop:function(){var g=['<div style="padding:20px;">','<div class="ke-dialog-row">','<label for="keWidth" style="width:90px;">'+b.size+"</label>",b.width+' <input type="text" id="keWidth" class="ke-input-text ke-input-number" name="width" value="" maxlength="4" /> &nbsp; ','<select name="widthType">','<option value="%">'+b.percent+"</option>",'<option value="px">'+b.px+"</option>","</select> &nbsp; ",b.height+' <input type="text" class="ke-input-text ke-input-number" name="height" value="" maxlength="4" /> &nbsp; ','<select name="heightType">','<option value="%">'+b.percent+"</option>",'<option value="px">'+b.px+"</option>","</select>","</div>",'<div class="ke-dialog-row">','<label for="keAlign" style="width:90px;">'+b.align+"</label>",b.textAlign+' <select id="keAlign" name="textAlign">','<option value="">'+b.alignDefault+"</option>",'<option value="left">'+b.alignLeft+"</option>",'<option value="center">'+b.alignCenter+"</option>",'<option value="right">'+b.alignRight+"</option>","</select> ",b.verticalAlign+' <select name="verticalAlign">','<option value="">'+b.alignDefault+"</option>",'<option value="top">'+b.alignTop+"</option>",'<option value="middle">'+b.alignMiddle+"</option>",'<option value="bottom">'+b.alignBottom+"</option>",'<option value="baseline">'+b.alignBaseline+"</option>","</select>","</div>",'<div class="ke-dialog-row">','<label for="keBorder" style="width:90px;">'+b.border+"</label>",b.borderWidth+' <input type="text" id="keBorder" class="ke-input-text ke-input-number" name="border" value="" maxlength="4" /> &nbsp; ',b.borderColor+' <span class="ke-inline-block ke-input-color"></span>',"</div>",'<div class="ke-dialog-row">','<label for="keBgColor" style="width:90px;">'+b.backgroundColor+"</label>",'<span class="ke-inline-block ke-input-color"></span>',"</div>","</div>"].join(""),y=v.cmd.range.createBookmark(),k=v.createDialog({name:_,width:500,title:v.lang("tablecell"),body:g,beforeRemove:function(){F.unbind()},yesBtn:{name:v.lang("yes"),click:function(){var c=S.val(),h=E.val(),g=C.val(),_=T.val(),b=(K.val(),U.val(),A.val()),k=N.val(),w=I.val(),D=a(F[0]).html()||"",M=a(F[1]).html()||"";return/^\d*$/.test(c)?/^\d*$/.test(h)?/^\d*$/.test(w)?(R.css({width:""!==c?c+g:"",height:""!==h?h+_:"","background-color":M,"text-align":b,"vertical-align":k,"border-width":w,"border-style":""!==w?"solid":"","border-color":D}),v.hideDialog().focus(),v.cmd.range.moveToBookmark(y),v.cmd.select(),void v.addBookmark()):(alert(v.lang("invalidBorder")),void I[0].focus()):(alert(v.lang("invalidHeight")),void E[0].focus()):(alert(v.lang("invalidWidth")),void S[0].focus())}}}),w=k.div,S=a('[name="width"]',w).val(100),E=a('[name="height"]',w),C=a('[name="widthType"]',w),T=a('[name="heightType"]',w),K=a('[name="padding"]',w).val(2),U=a('[name="spacing"]',w).val(0),A=a('[name="textAlign"]',w),N=a('[name="verticalAlign"]',w),I=a('[name="border"]',w).val(1),F=a(".ke-input-color",w);h(w,F.eq(0)),h(w,F.eq(1)),c(F.eq(0),"#000000"),c(F.eq(1),""),S[0].focus(),S[0].select();var D,R=v.plugin.getSelectedCell(),M=R[0].style.width||R[0].width||"",P=R[0].style.height||R[0].height||"";(D=/^(\d+)((?:px|%)*)$/.exec(M))?(S.val(D[1]),C.val(D[2])):S.val(""),(D=/^(\d+)((?:px|%)*)$/.exec(P))&&(E.val(D[1]),T.val(D[2])),A.val(R[0].style.textAlign||""),N.val(R[0].style.verticalAlign||"");var B=R[0].style.borderWidth||"";B&&(B=parseInt(B)),I.val(B),c(F.eq(0),a.toHex(R[0].style.borderColor||"")),c(F.eq(1),a.toHex(R[0].style.backgroundColor||"")),S[0].focus(),S[0].select()},insert:function(){this.prop(!0)},"delete":function(){var a=v.plugin.getSelectedTable();v.cmd.range.setStartBefore(a[0]).collapse(!0),v.cmd.select(),a.remove(),v.addBookmark()},colinsert:function(c){var h=v.plugin.getSelectedTable()[0],_=v.plugin.getSelectedRow()[0],b=v.plugin.getSelectedCell()[0],y=b.cellIndex+c;y+=h.rows[0].cells.length-_.cells.length;for(var i=0,k=h.rows.length;k>i;i++){var w=h.rows[i],S=w.insertCell(y);S.innerHTML=a.IE?"":"<br />",y=g(h,w,S)}v.cmd.range.selectNodeContents(b).collapse(!0),v.cmd.select(),v.addBookmark()},colinsertleft:function(){this.colinsert(0)},colinsertright:function(){this.colinsert(1)},rowinsert:function(c){var h=v.plugin.getSelectedTable()[0],g=v.plugin.getSelectedRow()[0],_=v.plugin.getSelectedCell()[0],b=g.rowIndex;1===c&&(b=g.rowIndex+(_.rowSpan-1)+c);for(var y=h.insertRow(b),i=0,k=g.cells.length;k>i;i++){g.cells[i].rowSpan>1&&(k-=g.cells[i].rowSpan-1);var w=y.insertCell(i);1===c&&g.cells[i].colSpan>1&&(w.colSpan=g.cells[i].colSpan),w.innerHTML=a.IE?"":"<br />"}for(var S=b;S>=0;S--){var E=h.rows[S].cells;if(E.length>i){for(var C=_.cellIndex;C>=0;C--)E[C].rowSpan>1&&(E[C].rowSpan+=1);break}}v.cmd.range.selectNodeContents(_).collapse(!0),v.cmd.select(),v.addBookmark()},rowinsertabove:function(){this.rowinsert(0)},rowinsertbelow:function(){this.rowinsert(1)},rowmerge:function(){var a=v.plugin.getSelectedTable()[0],c=v.plugin.getSelectedRow()[0],h=v.plugin.getSelectedCell()[0],g=c.rowIndex,_=g+h.rowSpan,b=a.rows[_];if(!(a.rows.length<=_)){var y=h.cellIndex;if(!(b.cells.length<=y)){var k=b.cells[y];h.colSpan===k.colSpan&&(h.rowSpan+=k.rowSpan,b.deleteCell(y),v.cmd.range.selectNodeContents(h).collapse(!0),v.cmd.select(),v.addBookmark())}}},colmerge:function(){var a=(v.plugin.getSelectedTable()[0],v.plugin.getSelectedRow()[0]),c=v.plugin.getSelectedCell()[0],h=(a.rowIndex,c.cellIndex),g=h+1;if(!(a.cells.length<=g)){var _=a.cells[g];c.rowSpan===_.rowSpan&&(c.colSpan+=_.colSpan,a.deleteCell(g),v.cmd.range.selectNodeContents(c).collapse(!0),v.cmd.select(),v.addBookmark())}},rowsplit:function(){var c=v.plugin.getSelectedTable()[0],h=v.plugin.getSelectedRow()[0],_=v.plugin.getSelectedCell()[0],b=h.rowIndex;if(1!==_.rowSpan){for(var y=g(c,h,_),i=1,k=_.rowSpan;k>i;i++){var w=c.rows[b+i],S=w.insertCell(y);_.colSpan>1&&(S.colSpan=_.colSpan),S.innerHTML=a.IE?"":"<br />",y=g(c,w,S)}a(_).removeAttr("rowSpan"),v.cmd.range.selectNodeContents(_).collapse(!0),v.cmd.select(),v.addBookmark()}},colsplit:function(){var c=(v.plugin.getSelectedTable()[0],v.plugin.getSelectedRow()[0]),h=v.plugin.getSelectedCell()[0],g=h.cellIndex;if(1!==h.colSpan){for(var i=1,_=h.colSpan;_>i;i++){var b=c.insertCell(g+i);h.rowSpan>1&&(b.rowSpan=h.rowSpan),b.innerHTML=a.IE?"":"<br />"}a(h).removeAttr("colSpan"),v.cmd.range.selectNodeContents(h).collapse(!0),v.cmd.select(),v.addBookmark()}},coldelete:function(){for(var c=v.plugin.getSelectedTable()[0],h=v.plugin.getSelectedRow()[0],g=v.plugin.getSelectedCell()[0],_=g.cellIndex,i=0,b=c.rows.length;b>i;i++){var y=c.rows[i],k=y.cells[_];k.colSpan>1?(k.colSpan-=1,1===k.colSpan&&a(k).removeAttr("colSpan")):y.deleteCell(_),k.rowSpan>1&&(i+=k.rowSpan-1)}0===h.cells.length?(v.cmd.range.setStartBefore(c).collapse(!0),v.cmd.select(),a(c).remove()):v.cmd.selection(!0),v.addBookmark()},rowdelete:function(){for(var c=v.plugin.getSelectedTable()[0],h=v.plugin.getSelectedRow()[0],g=v.plugin.getSelectedCell()[0],_=h.rowIndex,i=g.rowSpan-1;i>=0;i--)c.deleteRow(_+i);0===c.rows.length?(v.cmd.range.setStartBefore(c).collapse(!0),v.cmd.select(),a(c).remove()):v.cmd.selection(!0),v.addBookmark()}},v.clickToolbar(_,v.plugin.table.prop)}),KindEditor.plugin("template",function(a){function c(c){return v+c+"?ver="+encodeURIComponent(a.DEBUG?a.TIME:a.VERSION)}var h=this,g="template",v=(h.lang(g+"."),h.pluginsPath+g+"/html/");h.clickToolbar(g,function(){var v=h.lang(g+"."),_=['<div style="padding:10px 20px;">','<div class="ke-header">','<div class="ke-left">',v.selectTemplate+" <select>"];a.each(v.fileList,function(a,c){_.push('<option value="'+a+'">'+c+"</option>")}),html=[_.join(""),"</select></div>",'<div class="ke-right">','<input type="checkbox" id="keReplaceFlag" name="replaceFlag" value="1" /> <label for="keReplaceFlag">'+v.replaceContent+"</label>","</div>",'<div class="ke-clearfix"></div>',"</div>",'<iframe class="ke-textarea" frameborder="0" style="width:458px;height:260px;background-color:#FFF;"></iframe>',"</div>"].join("");var b=h.createDialog({name:g,width:500,title:h.lang(g),body:html,yesBtn:{name:h.lang("yes"),click:function(){var c=a.iframeDoc(w);h[k[0].checked?"html":"insertHtml"](c.body.innerHTML).hideDialog().focus()}}}),y=a("select",b.div),k=a('[name="replaceFlag"]',b.div),w=a("iframe",b.div);k[0].checked=!0,w.attr("src",c(y.val())),y.change(function(){w.attr("src",c(this.value))})})}),KindEditor.plugin("wordpaste",function(a){var c=this,h="wordpaste";c.clickToolbar(h,function(){var g=c.lang(h+"."),v='<div style="padding:10px 20px;"><div style="margin-bottom:10px;">'+g.comment+'</div><iframe class="ke-textarea" frameborder="0" style="width:408px;height:260px;"></iframe></div>',_=c.createDialog({name:h,width:450,title:c.lang(h),body:v,yesBtn:{name:c.lang("yes"),click:function(){var h=k.body.innerHTML;h=a.clearMsWord(h,c.filterMode?c.htmlTags:a.options.htmlTags),c.insertHtml(h).hideDialog().focus()}}}),b=_.div,y=a("iframe",b),k=a.iframeDoc(y);a.IE||(k.designMode="on"),k.open(),k.write("<!doctype html><html><head><title>WordPaste</title></head>"),k.write('<body style="background-color:#FFF;font-size:12px;margin:2px;">'),a.IE||k.write("<br />"),k.write("</body></html>"),k.close(),a.IE&&(k.body.contentEditable="true"),y[0].contentWindow.focus()})});